#!/usr/bin/env python3
"""
–¢–µ—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è FOV –Ω–∞ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π –ø–∞–Ω–æ—Ä–∞–º–µ
"""
import math

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
LON_MIN = -90.0
LON_MAX = +90.0
LAT_MIN = -32.0
LAT_MAX = +22.0
PANORAMA_WIDTH = 5700
PANORAMA_HEIGHT = 1900
ASPECT_RATIO = 16.0 / 9.0

def spherical_to_cartesian(yaw, pitch):
    """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ 3D —Ç–æ—á–∫—É –Ω–∞ –µ–¥–∏–Ω–∏—á–Ω–æ–π —Å—Ñ–µ—Ä–µ"""
    yaw_rad = math.radians(yaw)
    pitch_rad = math.radians(pitch)

    x = math.cos(pitch_rad) * math.sin(yaw_rad)
    y = math.sin(pitch_rad)
    z = math.cos(pitch_rad) * math.cos(yaw_rad)

    return (x, y, z)

def angle_between_vectors(v1, v2):
    """–£–≥–æ–ª –º–µ–∂–¥—É –¥–≤—É–º—è 3D –≤–µ–∫—Ç–æ—Ä–∞–º–∏"""
    dot_product = sum(a * b for a, b in zip(v1, v2))
    mag1 = math.sqrt(sum(a**2 for a in v1))
    mag2 = math.sqrt(sum(a**2 for a in v2))

    cos_angle = dot_product / (mag1 * mag2)
    # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è
    cos_angle = max(-1.0, min(1.0, cos_angle))

    return math.degrees(math.acos(cos_angle))

print("=" * 80)
print("–†–ï–ê–õ–¨–ù–û–ï –ü–û–ö–†–´–¢–ò–ï FOV –ù–ê –°–§–ï–†–ò–ß–ï–°–ö–û–ô –ü–ê–ù–û–†–ê–ú–ï")
print("=" * 80)

print(f"\nüìê –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–Ω–æ—Ä–∞–º—ã:")
print(f"   –í–µ—Ä—Ç–∏–∫–∞–ª—å (LAT): {LAT_MIN}¬∞ –¥–æ {LAT_MAX}¬∞ (–ø–æ–∫—Ä—ã—Ç–∏–µ: {LAT_MAX - LAT_MIN}¬∞)")
print(f"   –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å (LON): {LON_MIN}¬∞ –¥–æ {LON_MAX}¬∞ (–ø–æ–∫—Ä—ã—Ç–∏–µ: {LON_MAX - LON_MIN}¬∞)")

print("\n" + "=" * 80)
print("–¢–ï–°–¢: –ß—Ç–æ –≤–∏–¥–∏—Ç –∫–∞–º–µ—Ä–∞ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö FOV?")
print("=" * 80)

# –¶–µ–Ω—Ç—Ä –ø–∞–Ω–æ—Ä–∞–º—ã
center_yaw = 0.0
center_pitch = (LAT_MIN + LAT_MAX) / 2.0

print(f"\nüéØ –ö–∞–º–µ—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–∞–Ω–æ—Ä–∞–º—ã: yaw={center_yaw}¬∞, pitch={center_pitch}¬∞")

for fov in [40.0, 50.0, 60.0, 68.0]:
    print(f"\n{'=' * 80}")
    print(f"FOV = {fov}¬∞")
    print(f"{'=' * 80}")

    # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –∫–∞–º–µ—Ä—ã
    center = spherical_to_cartesian(center_yaw, center_pitch)

    # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π FOV - –∫—Ä–∞—è –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
    half_fov_v = fov / 2.0

    # –¢–æ—á–∫–∏ –Ω–∞ –∫—Ä–∞—è—Ö FOV (–≤ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∫–∞–º–µ—Ä—ã)
    # –í–µ—Ä—Ö –∫–∞–º–µ—Ä—ã = pitch + half_fov
    # –ù–∏–∑ –∫–∞–º–µ—Ä—ã = pitch - half_fov
    top_pitch = center_pitch + half_fov_v
    bottom_pitch = center_pitch - half_fov_v

    print(f"\nüìä –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–ø—Ä–æ—Å—Ç–æ–π —Ä–∞—Å—á—ë—Ç):")
    print(f"   –í–µ—Ä—Ö –∫–∞–º–µ—Ä—ã: {top_pitch:+6.1f}¬∞")
    print(f"   –ù–∏–∑ –∫–∞–º–µ—Ä—ã: {bottom_pitch:+6.1f}¬∞")
    print(f"   –ü–æ–∫—Ä—ã—Ç–∏–µ: {top_pitch - bottom_pitch:.1f}¬∞ (FOV={fov}¬∞)")

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã—Ö–æ–¥ –∑–∞ –ø–∞–Ω–æ—Ä–∞–º—É
    if top_pitch > LAT_MAX:
        print(f"   ‚ö†Ô∏è –í–´–•–û–î –ó–ê –í–ï–†–•: {top_pitch:.1f}¬∞ > {LAT_MAX}¬∞ (–Ω–∞ {top_pitch - LAT_MAX:.1f}¬∞)")
    else:
        print(f"   ‚úÖ –í–µ—Ä—Ö –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–æ—Ä–∞–º—ã")

    if bottom_pitch < LAT_MIN:
        print(f"   ‚ö†Ô∏è –í–´–•–û–î –ó–ê –ù–ò–ó: {bottom_pitch:.1f}¬∞ < {LAT_MIN}¬∞ (–Ω–∞ {LAT_MIN - bottom_pitch:.1f}¬∞)")
    else:
        print(f"   ‚úÖ –ù–∏–∑ –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–æ—Ä–∞–º—ã")

    # –¢–µ–ø–µ—Ä—å –ü–†–ê–í–ò–õ–¨–ù–´–ô —Ä–∞—Å—á—ë—Ç - —á–µ—Ä–µ–∑ 3D —É–≥–ª—ã
    print(f"\nüåç 3D —É–≥–ª–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–∞ —Å—Ñ–µ—Ä–µ):")

    # –°–æ–∑–¥–∞—ë–º —Ç–æ—á–∫–∏ –Ω–∞ –∫—Ä–∞—è—Ö FOV –∫–∞–º–µ—Ä—ã
    top_point = spherical_to_cartesian(center_yaw, top_pitch)
    bottom_point = spherical_to_cartesian(center_yaw, bottom_pitch)

    # –£–≥–ª—ã –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–æ–º –∫–∞–º–µ—Ä—ã –∏ –∫—Ä–∞—è–º–∏
    angle_to_top = angle_between_vectors(center, top_point)
    angle_to_bottom = angle_between_vectors(center, bottom_point)

    print(f"   –£–≥–æ–ª –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –¥–æ –≤–µ—Ä—Ö–∞: {angle_to_top:.1f}¬∞")
    print(f"   –£–≥–æ–ª –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –¥–æ –Ω–∏–∑–∞: {angle_to_bottom:.1f}¬∞")
    print(f"   –†–µ–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: {angle_to_top + angle_to_bottom:.1f}¬∞")

    # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
    horizontal_fov = fov * ASPECT_RATIO
    half_fov_h = horizontal_fov / 2.0

    left_yaw = center_yaw - half_fov_h
    right_yaw = center_yaw + half_fov_h

    print(f"\nüìä –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:")
    print(f"   Horizontal FOV: {horizontal_fov:.1f}¬∞ (–æ—Ç {fov}¬∞ √ó {ASPECT_RATIO:.2f})")
    print(f"   –õ–µ–≤—ã–π –∫—Ä–∞–π: {left_yaw:+7.1f}¬∞")
    print(f"   –ü—Ä–∞–≤—ã–π –∫—Ä–∞–π: {right_yaw:+7.1f}¬∞")
    print(f"   –ü–æ–∫—Ä—ã—Ç–∏–µ: {right_yaw - left_yaw:.1f}¬∞")

    if left_yaw < LON_MIN:
        print(f"   ‚ö†Ô∏è –í–´–•–û–î –í–õ–ï–í–û: {left_yaw:.1f}¬∞ < {LON_MIN}¬∞ (–Ω–∞ {LON_MIN - left_yaw:.1f}¬∞)")
    else:
        print(f"   ‚úÖ –õ–µ–≤—ã–π –∫—Ä–∞–π –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–æ—Ä–∞–º—ã")

    if right_yaw > LON_MAX:
        print(f"   ‚ö†Ô∏è –í–´–•–û–î –í–ü–†–ê–í–û: {right_yaw:.1f}¬∞ > {LON_MAX}¬∞ (–Ω–∞ {right_yaw - LON_MAX:.1f}¬∞)")
    else:
        print(f"   ‚úÖ –ü—Ä–∞–≤—ã–π –∫—Ä–∞–π –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–æ—Ä–∞–º—ã")

print("\n" + "=" * 80)
print("–û–ë–™–Ø–°–ù–ï–ù–ò–ï")
print("=" * 80)

print("""
üéØ –ü–æ—á–µ–º—É FOV=68¬∞ –º–æ–∂–µ—Ç –ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è –≤ –ø–∞–Ω–æ—Ä–∞–º—É 54¬∞?

–ù–∞ —ç–∫–≤–∞—Ç–æ—Ä–∞–ª—å–Ω–æ–π (equirectangular) –ø—Ä–æ–µ–∫—Ü–∏–∏:

1. **FOV –∫–∞–º–µ—Ä—ã** (68¬∞) - —ç—Ç–æ —É–≥–æ–ª –æ–±–∑–æ—Ä–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∫–∞–º–µ—Ä—ã –≤ 3D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
2. **–ü–æ–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–æ—Ä–∞–º—ã** (54¬∞) - —ç—Ç–æ —É–≥–ª–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –≤ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö

–≠—Ç–æ –†–ê–ó–ù–´–ï —Å–∏—Å—Ç–µ–º—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è!

–ö–æ–≥–¥–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞ —Å FOV=68¬∞ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫—É—é –ø–∞–Ω–æ—Ä–∞–º—É,
–æ–Ω–∞ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç 3D —É–≥–ª—ã –Ω–∞ 2D –ø—Ä–æ–µ–∫—Ü–∏—é.

–ù–∞ —ç–∫–≤–∞—Ç–æ—Ä–µ (—Ü–µ–Ω—Ç—Ä –ø–∞–Ω–æ—Ä–∞–º—ã) —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–Ω–æ 1:1,
–Ω–æ –±–ª–∏–∂–µ –∫ –ø–æ–ª—é—Å–∞–º (–≤–µ—Ä—Ö/–Ω–∏–∑ –ø–∞–Ω–æ—Ä–∞–º—ã) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∂–∞—Ç–∏–µ.

–ü–æ—ç—Ç–æ–º—É:
‚úÖ FOV=68¬∞ –∫–∞–º–µ—Ä–∞ –ú–û–ñ–ï–¢ –≤–∏–¥–µ—Ç—å –ø–∞–Ω–æ—Ä–∞–º—É 54¬∞ –±–µ–∑ —á–µ—Ä–Ω—ã—Ö –ø–æ–ª–æ—Å (–≤ —Ü–µ–Ω—Ç—Ä–µ)
‚ö†Ô∏è –ù–û –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫ –∫—Ä–∞—è–º –∏–ª–∏ –±–æ–ª—å—à–æ–º FOV –ø–æ—è–≤–ª—è—é—Ç—Å—è –∏—Å–∫–∞–∂–µ–Ω–∏—è

–í–´–í–û–î: –ú–æ—è –ø—Ä–µ–¥—ã–¥—É—â–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±—ã–ª–∞ –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø!
       –Ø —Å—á–∏—Ç–∞–ª –ª–∏–Ω–µ–π–Ω—ã–µ —É–≥–ª—ã, –∞ –Ω—É–∂–Ω–æ –±—ã–ª–æ —Å—á–∏—Ç–∞—Ç—å —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ü–∏–∏!
""")

print("=" * 80)
