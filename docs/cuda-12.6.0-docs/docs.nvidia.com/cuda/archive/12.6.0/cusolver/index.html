<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript"
  data-document-language="true" charset="UTF-8" data-domain-script="3e2b62ff-7ae7-4ac5-87c8-d5949ecafff5">
</script>
<script type="text/javascript">
  function OptanonWrapper() {
    var event = new Event('bannerLoaded');
    window.dispatchEvent(event);
  }
</script>
<script src="https://images.nvidia.com/aem-dam/Solutions/ot-js/ot-custom.js" type="text/javascript">
</script>

  <meta charset="utf-8">
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/">
<meta content="The API reference guide for cuSOLVER, a GPU accelerated library for decompositions and linear system solutions for both dense and sparse matrices." name="description">
<meta content="CUDA cuSOLVER, CUDA cuSolver asynchronous execution, CUDA cuSolver type, CUDA cuSolver helper function, CUDA cuSolver high level function" name="keywords">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>cuSOLVER</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css">
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css">
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css">
      <link rel="stylesheet" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css">
      <link rel="stylesheet" href="../_static/omni-style.css" type="text/css">
      <link rel="stylesheet" href="../_static/api-styles.css" type="text/css">
    <link rel="shortcut icon" href="../_static/favicon.ico">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/mermaid-init.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/design-tabs.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../_static/geoip/geoip.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html">
    <link rel="search" title="Search" href="search.html">
    <link rel="prev" title="Contents" href="contents.html">
 
<script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js"></script>
 

<link rel="stylesheet" href="../../../../common-libs/common.css">
<script src="../../../../common-libs/common.js"></script>
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="contents.html">
            <img src="../_static/Logo_and_CUDA.png" class="logo" alt="Logo">
          </a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>
        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current">
<a class="current reference internal" href="index.html#">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#cusolverdn-dense-lapack">1.1. cuSolverDN: Dense LAPACK</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#cusolversp-sparse-lapack">1.2. cuSolverSP: Sparse LAPACK</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#cusolverrf-refactorization">1.3. cuSolverRF: Refactorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#naming-conventions">1.4. Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#asynchronous-execution">1.5. Asynchronous Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#library-property">1.6. Library Property</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#high-precision-package">1.7. High Precision Package</a></li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="index.html#using-the-cusolver-api">2. Using the CUSOLVER API</a><ul>
<li class="toctree-l2">
<a class="reference internal" href="index.html#general-description">2.1. General Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#thread-safety">2.1.1. Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#scalar-parameters">2.1.2. Scalar Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#parallelism-with-streams">2.1.3. Parallelism with Streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#how-to-link-cusolver-library">2.1.4. How to Link cusolver Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#link-third-party-lapack-library">2.1.5. Link Third-party LAPACK Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#convention-of-info">2.1.6. Convention of info</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#usage-of-buffersize">2.1.7. Usage of _bufferSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverdn-logging">2.1.8. cuSOLVERDn Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#deterministic-results">2.1.9. Deterministic Results</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolver-types-reference">2.2. cuSolver Types Reference</a><ul>
<li class="toctree-l3">
<a class="reference internal" href="index.html#cusolverdn-types">2.2.1. cuSolverDN Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnhandle-t">2.2.1.1. cusolverDnHandle_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cublasfillmode-t">2.2.1.2. cublasFillMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cublasoperation-t">2.2.1.3. cublasOperation_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolvereigtype-t">2.2.1.4. cusolverEigType_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolvereigmode-t">2.2.1.5. cusolverEigMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverirsrefinement-t">2.2.1.6. cusolverIRSRefinement_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparams-t">2.2.1.7. cusolverDnIRSParams_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfos-t">2.2.1.8. cusolverDnIRSInfos_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnfunction-t">2.2.1.9. cusolverDnFunction_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolveralgmode-t">2.2.1.10. cusolverAlgMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverstatus-t">2.2.1.11. cusolverStatus_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggercallback-t">2.2.1.12. cusolverDnLoggerCallback_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdeterministicmode-t">2.2.1.13. cusolverDeterministicMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverstorevmode-t">2.2.1.14. cusolverStorevMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdirectmode-t">2.2.1.15. cusolverDirectMode_t</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#cusolversp-types">2.2.2. cuSolverSP Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversphandle-t">2.2.2.1. cusolverSpHandle_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusparsematdescr-t">2.2.2.2. cusparseMatDescr_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id5">2.2.2.3. cusolverStatus_t</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#cusolverrf-types">2.2.3. cuSolverRF Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrfhandle-t">2.2.3.1. cusolverRfHandle_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrfmatrixformat-t">2.2.3.2. cusolverRfMatrixFormat_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrfnumericboostreport-t">2.2.3.3. cusolverRfNumericBoostReport_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrfresetvaluesfastmode-t">2.2.3.4. cusolverRfResetValuesFastMode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrffactorization-t">2.2.3.5. cusolverRfFactorization_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrftriangularsolve-t">2.2.3.6. cusolverRfTriangularSolve_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverrfunitdiagonal-t">2.2.3.7. cusolverRfUnitDiagonal_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id7">2.2.3.8. cusolverStatus_t</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolver-formats-reference">2.3. cuSolver Formats Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#index-base-format">2.3.1. Index Base Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#vector-dense-format">2.3.2. Vector (Dense) Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#matrix-dense-format">2.3.3. Matrix (Dense) Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#matrix-csr-format">2.3.4. Matrix (CSR) Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#matrix-csc-format">2.3.5. Matrix (CSC) Format</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolverdn-dense-lapack-function-reference">2.4. cuSolverDN: dense LAPACK Function Reference</a><ul>
<li class="toctree-l3">
<a class="reference internal" href="index.html#cusolverdn-helper-function-reference">2.4.1. cuSolverDN Helper Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdncreate">2.4.1.1. cusolverDnCreate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdndestroy">2.4.1.2. cusolverDnDestroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnsetstream">2.4.1.3. cusolverDnSetStream()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngetstream">2.4.1.4. cusolverDnGetStream()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggersetcallback">2.4.1.5. cusolverDnLoggerSetCallback()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggersetfile">2.4.1.6. cusolverDnLoggerSetFile()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggeropenfile">2.4.1.7. cusolverDnLoggerOpenFile()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggersetlevel">2.4.1.8. cusolverDnLoggerSetLevel()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggersetmask">2.4.1.9. cusolverDnLoggerSetMask()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnloggerforcedisable">2.4.1.10. cusolverDnLoggerForceDisable()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnsetdeterministicmode">2.4.1.11. cusolverDnSetDeterministicMode()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngetdeterministicmode">2.4.1.12. cusolverDnGetDeterministicMode()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdncreatesyevjinfo">2.4.1.13. cusolverDnCreateSyevjInfo()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdndestroysyevjinfo">2.4.1.14. cusolverDnDestroySyevjInfo()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevjsettolerance">2.4.1.15. cusolverDnXsyevjSetTolerance()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevjsetmaxsweeps">2.4.1.16. cusolverDnXsyevjSetMaxSweeps()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevjsetsorteig">2.4.1.17. cusolverDnXsyevjSetSortEig()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevjgetresidual">2.4.1.18. cusolverDnXsyevjGetResidual()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevjgetsweeps">2.4.1.19. cusolverDnXsyevjGetSweeps()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdncreategesvdjinfo">2.4.1.20. cusolverDnCreateGesvdjInfo()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdndestroygesvdjinfo">2.4.1.21. cusolverDnDestroyGesvdjInfo()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdjsettolerance">2.4.1.22. cusolverDnXgesvdjSetTolerance()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdjsetmaxsweeps">2.4.1.23. cusolverDnXgesvdjSetMaxSweeps()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdjsetsorteig">2.4.1.24. cusolverDnXgesvdjSetSortEig()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdjgetresidual">2.4.1.25. cusolverDnXgesvdjGetResidual()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdjgetsweeps">2.4.1.26. cusolverDnXgesvdjGetSweeps()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamscreate">2.4.1.27. cusolverDnIRSParamsCreate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamsdestroy">2.4.1.28. cusolverDnIRSParamsDestroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetsolverprecisions">2.4.1.29. cusolverDnIRSParamsSetSolverPrecisions()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetsolvermainprecision">2.4.1.30. cusolverDnIRSParamsSetSolverMainPrecision()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetsolverlowestprecision">2.4.1.31. cusolverDnIRSParamsSetSolverLowestPrecision()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetrefinementsolver">2.4.1.32. cusolverDnIRSParamsSetRefinementSolver()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssettol">2.4.1.33. cusolverDnIRSParamsSetTol()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssettolinner">2.4.1.34. cusolverDnIRSParamsSetTolInner()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetmaxiters">2.4.1.35. cusolverDnIRSParamsSetMaxIters()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamssetmaxitersinner">2.4.1.36. cusolverDnIRSParamsSetMaxItersInner()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamsenablefallback">2.4.1.37. cusolverDnIRSParamsEnableFallback()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamsdisablefallback">2.4.1.38. cusolverDnIRSParamsDisableFallback()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsparamsgetmaxiters">2.4.1.39. cusolverDnIRSParamsGetMaxIters()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfoscreate">2.4.1.40. cusolverDnIRSInfosCreate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosdestroy">2.4.1.41. cusolverDnIRSInfosDestroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosgetmaxiters">2.4.1.42. cusolverDnIRSInfosGetMaxIters()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosgetniters">2.4.1.43. cusolverDnIRSInfosGetNiters()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosgetouterniters">2.4.1.44. cusolverDnIRSInfosGetOuterNiters()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosrequestresidual">2.4.1.45. cusolverDnIRSInfosRequestResidual()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsinfosgetresidualhistory">2.4.1.46. cusolverDnIRSInfosGetResidualHistory()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdncreateparams">2.4.1.47. cusolverDnCreateParams()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdndestroyparams">2.4.1.48. cusolverDnDestroyParams()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnsetadvoptions">2.4.1.49. cusolverDnSetAdvOptions()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#dense-linear-solver-reference-legacy">2.4.2. Dense Linear Solver Reference (legacy)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-potrf">2.4.2.1. cusolverDn&lt;t&gt;potrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnpotrf-deprecated">2.4.2.2. cusolverDnPotrf()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-potrs">2.4.2.3. cusolverDn&lt;t&gt;potrs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnpotrs-deprecated">2.4.2.4. cusolverDnPotrs()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-potri">2.4.2.5. cusolverDn&lt;t&gt;potri()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-getrf">2.4.2.6. cusolverDn&lt;t&gt;getrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngetrf-deprecated">2.4.2.7. cusolverDnGetrf()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-getrs">2.4.2.8. cusolverDn&lt;t&gt;getrs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngetrs-deprecated">2.4.2.9. cusolverDnGetrs()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t1-t2-gesv">2.4.2.10. cusolverDn&lt;t1&gt;&lt;t2&gt;gesv()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsxgesv">2.4.2.11. cusolverDnIRSXgesv()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-geqrf">2.4.2.12. cusolverDn&lt;t&gt;geqrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngeqrf-deprecated">2.4.2.13. cusolverDnGeqrf()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t1-t2-gels">2.4.2.14. cusolverDn&lt;t1&gt;&lt;t2&gt;gels()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnirsxgels">2.4.2.15. cusolverDnIRSXgels()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-ormqr">2.4.2.16. cusolverDn&lt;t&gt;ormqr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-orgqr">2.4.2.17. cusolverDn&lt;t&gt;orgqr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-sytrf">2.4.2.18. cusolverDn&lt;t&gt;sytrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-potrfbatched">2.4.2.19. cusolverDn&lt;t&gt;potrfBatched()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-potrsbatched">2.4.2.20. cusolverDn&lt;t&gt;potrsBatched()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#dense-eigenvalue-solver-reference-legacy">2.4.3. Dense Eigenvalue Solver Reference (legacy)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-gebrd">2.4.3.1. cusolverDn&lt;t&gt;gebrd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-orgbr">2.4.3.2. cusolverDn&lt;t&gt;orgbr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-sytrd">2.4.3.3. cusolverDn&lt;t&gt;sytrd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-ormtr">2.4.3.4. cusolverDn&lt;t&gt;ormtr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-orgtr">2.4.3.5. cusolverDn&lt;t&gt;orgtr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-gesvd">2.4.3.6. cusolverDn&lt;t&gt;gesvd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdngesvd-deprecated">2.4.3.7. cusolverDnGesvd()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-gesvdj">2.4.3.8. cusolverDn&lt;t&gt;gesvdj()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-gesvdjbatched">2.4.3.9. cusolverDn&lt;t&gt;gesvdjBatched()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-gesvdastridedbatched">2.4.3.10. cusolverDn&lt;t&gt;gesvdaStridedBatched()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-syevd">2.4.3.11. cusolverDn&lt;t&gt;syevd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnsyevd-deprecated">2.4.3.12. cusolverDnSyevd()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-syevdx">2.4.3.13. cusolverDn&lt;t&gt;syevdx()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnsyevdx-deprecated">2.4.3.14. cusolverDnSyevdx()[DEPRECATED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-sygvd">2.4.3.15. cusolverDn&lt;t&gt;sygvd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-sygvdx">2.4.3.16. cusolverDn&lt;t&gt;sygvdx()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-syevj">2.4.3.17. cusolverDn&lt;t&gt;syevj()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-sygvj">2.4.3.18. cusolverDn&lt;t&gt;sygvj()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdn-t-syevjbatched">2.4.3.19. cusolverDn&lt;t&gt;syevjBatched()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#dense-linear-solver-reference-64-bit-api">2.4.4. Dense Linear Solver Reference (64-bit API)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxpotrf">2.4.4.1. cusolverDnXpotrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxpotrs">2.4.4.2. cusolverDnXpotrs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgetrf">2.4.4.3. cusolverDnXgetrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgetrs">2.4.4.4. cusolverDnXgetrs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgeqrf">2.4.4.5. cusolverDnXgeqrf()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsytrs">2.4.4.6. cusolverDnXsytrs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxtrtri">2.4.4.7. cusolverDnXtrtri()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxlarft">2.4.4.8. cusolverDnXlarft()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#dense-eigenvalue-solver-reference-64-bit-api">2.4.5. Dense Eigenvalue Solver Reference (64-bit API)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvd">2.4.5.1. cusolverDnXgesvd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdp">2.4.5.2. cusolverDnXgesvdp()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxgesvdr">2.4.5.3. cusolverDnXgesvdr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevd">2.4.5.4. cusolverDnXsyevd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverdnxsyevdx">2.4.5.5. cusolverDnXsyevdx()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolversp-sparse-lapack-function-reference">2.5. cuSolverSP: sparse LAPACK Function Reference</a><ul>
<li class="toctree-l3">
<a class="reference internal" href="index.html#helper-function-reference">2.5.1. Helper Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspcreate">2.5.1.1. cusolverSpCreate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspdestroy">2.5.1.2. cusolverSpDestroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspsetstream">2.5.1.3. cusolverSpSetStream()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrissym">2.5.1.4. cusolverSpXcsrissym()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#high-level-function-reference">2.5.2. High Level Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csrlsvlu">2.5.2.1. cusolverSp&lt;t&gt;csrlsvlu()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csrlsvqr">2.5.2.2. cusolverSp&lt;t&gt;csrlsvqr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csrlsvchol">2.5.2.3. cusolverSp&lt;t&gt;csrlsvchol()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csrlsqvqr">2.5.2.4. cusolverSp&lt;t&gt;csrlsqvqr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csreigvsi">2.5.2.5. cusolverSp&lt;t&gt;csreigvsi()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolversp-t-csreigs">2.5.2.6. cusolverSp&lt;t&gt;csreigs()</a></li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="index.html#low-level-function-reference">2.5.3. Low Level Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrsymrcm">2.5.3.1. cusolverSpXcsrsymrcm()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrsymmdq">2.5.3.2. cusolverSpXcsrsymmdq()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrsymamd">2.5.3.3. cusolverSpXcsrsymamd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrmetisnd">2.5.3.4. cusolverSpXcsrmetisnd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrzfd">2.5.3.5. cusolverSpXcsrzfd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrperm">2.5.3.6. cusolverSpXcsrperm()</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#cusolverspxcsrqrbatched">2.5.3.7. cusolverSpXcsrqrBatched()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolverrf-refactorization-reference">2.6. cuSolverRF: Refactorization Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfaccessbundledfactors">2.6.1. cusolverRfAccessBundledFactors()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfanalyze">2.6.2. cusolverRfAnalyze()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetupdevice">2.6.3. cusolverRfSetupDevice()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetuphost">2.6.4. cusolverRfSetupHost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfcreate">2.6.5. cusolverRfCreate()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfextractbundledfactorshost">2.6.6. cusolverRfExtractBundledFactorsHost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfextractsplitfactorshost">2.6.7. cusolverRfExtractSplitFactorsHost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfdestroy">2.6.8. cusolverRfDestroy()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfgetmatrixformat">2.6.9. cusolverRfGetMatrixFormat()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfgetnumericproperties">2.6.10. cusolverRfGetNumericProperties()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfgetnumericboostreport">2.6.11. cusolverRfGetNumericBoostReport()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfgetresetvaluesfastmode">2.6.12. cusolverRfGetResetValuesFastMode()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfget-algs">2.6.13. cusolverRfGet_Algs()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfrefactor">2.6.14. cusolverRfRefactor()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfresetvalues">2.6.15. cusolverRfResetValues()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetmatrixformat">2.6.16. cusolverRfSetMatrixFormat()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetnumericproperties">2.6.17. cusolverRfSetNumericProperties()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetresetvaluesfastmode">2.6.18. cusolverRfSetResetValuesFastMode()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsetalgs">2.6.19. cusolverRfSetAlgs()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfsolve">2.6.20. cusolverRfSolve()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchsetuphost">2.6.21. cusolverRfBatchSetupHost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchanalyze">2.6.22. cusolverRfBatchAnalyze()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchresetvalues">2.6.23. cusolverRfBatchResetValues()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchrefactor">2.6.24. cusolverRfBatchRefactor()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchsolve">2.6.25. cusolverRfBatchSolve()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolverrfbatchzeropivot">2.6.26. cusolverRfBatchZeroPivot()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="index.html#using-the-cusolvermg-api">3. Using the CUSOLVERMG API</a><ul>
<li class="toctree-l2">
<a class="reference internal" href="index.html#id17">3.1. General Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#id18">3.1.1. Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#determinism">3.1.2. Determinism</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#tile-strategy">3.1.3. Tile Strategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#global-matrix-versus-local-matrix">3.1.4. Global Matrix Versus Local Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#id19">3.1.5. Usage of _bufferSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#synchronization">3.1.6. Synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#context-switch">3.1.7. Context Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#nvlink">3.1.8. NVLINK</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#cusolvermg-types-reference">3.2. cuSolverMG Types Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermg-types">3.2.1. cuSolverMG Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermghandle-t">3.2.2. cusolverMgHandle_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermggridmapping-t">3.2.3. cusolverMgGridMapping_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cudalibmggrid-t">3.2.4. cudaLibMgGrid_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cudalibmgmatrixdesc-t">3.2.5. cudaLibMgMatrixDesc_t</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#id20">3.3. Helper Function Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgcreate">3.3.1. cusolverMgCreate()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgdestroy">3.3.2. cusolverMgDestroy()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgdeviceselect">3.3.3. cusolverMgDeviceSelect()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgcreatedevicegrid">3.3.4. cusolverMgCreateDeviceGrid()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgdestroygrid">3.3.5. cusolverMgDestroyGrid()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgcreatematdescr">3.3.6. cusolverMgCreateMatDescr()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgdestroymatrixdesc">3.3.7. cusolverMgDestroyMatrixDesc()</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#dense-linear-solver-reference">3.4. Dense Linear Solver Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgpotrf">3.4.1. cusolverMgPotrf()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgpotrs">3.4.2. cusolverMgPotrs()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgpotri">3.4.3. cusolverMgPotri()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermggetrf">3.4.4. cusolverMgGetrf()</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermggetrs">3.4.5. cusolverMgGetrs()</a></li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="index.html#dense-eigenvalue-solver-reference">3.5. Dense Eigenvalue Solver Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#cusolvermgsyevd">3.5.1. cusolverMgSyevd()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#acknowledgements">4. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#bibliography">5. Bibliography</a></li>
<li class="toctree-l1">
<a class="reference internal" href="index.html#notices">6. Notices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#notice">6.1. Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#opencl">6.2. OpenCL</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#trademarks">6.3. Trademarks</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">cuSOLVER</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">


  

<li>
<a href="../index.html" class="icon icon-home"></a> »</li>
  
<li>
<span class="section-number">1. </span>Introduction</li>

      <li class="wy-breadcrumbs-aside">
      </li>
<li class="wy-breadcrumbs-aside">


  <span>v12.6 |</span>



  <a href="../pdf/CUSOLVER_Library.pdf" class="reference external">PDF</a>



  <span>|</span>



  <a href="https://developer.nvidia.com/cuda-toolkit-archive" class="reference external">Archive</a>


  <span> </span>
</li>

  </ul>
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p class="rubric-h1 rubric">cuSOLVER API Reference</p>
<p>The API reference guide for cuSOLVER, a GPU accelerated library for decompositions and linear system solutions for both dense and sparse matrices.</p>
<section id="introduction">
<h1>
<span class="section-number">1. </span>Introduction<a class="headerlink" href="index.html#introduction" title="Permalink to this headline"></a>
</h1>
<p>The cuSolver library is a high-level package based on the cuBLAS and cuSPARSE libraries. It consists of two modules corresponding to two sets of API:</p>
<ol class="arabic simple">
<li><p>The cuSolver API on a single GPU</p></li>
<li><p>The cuSolverMG API on a single node multiGPU</p></li>
</ol>
<p>Each of these can be used independently or in concert with other toolkit libraries. To simplify the notation, cuSolver denotes single GPU API and cuSolverMg denotes multiGPU API.</p>
<p>The intent of cuSolver is to provide useful LAPACK-like features, such as common matrix factorization and triangular solve routines for dense matrices, a sparse least-squares solver and an eigenvalue solver. In addition cuSolver provides a new refactorization library useful for solving sequences of matrices with a shared sparsity pattern.</p>
<p>cuSolver combines three separate components under a single umbrella. The first part of cuSolver is called cuSolverDN, and deals with dense matrix factorization and solve routines such as LU, QR, SVD and LDLT, as well as useful utilities such as matrix and vector permutations.</p>
<p>Next, cuSolverSP provides a new set of sparse routines based on a sparse QR factorization. Not all matrices have a good sparsity pattern for parallelism in factorization, so the cuSolverSP library also provides a CPU path to handle those sequential-like matrices. For those matrices with abundant parallelism, the GPU path will deliver higher performance. The library is designed to be called from C and C++.</p>
<p>The final part is cuSolverRF, a sparse re-factorization package that can provide very good performance when solving a sequence of matrices where only the coefficients are changed but the sparsity pattern remains the same.</p>
<p>The GPU path of the cuSolver library assumes data is already in the device memory. It is the responsibility of the developer to allocate memory and to copy data between GPU memory and CPU memory using standard CUDA runtime API routines, such as <code class="docutils literal notranslate"><span class="pre">cudaMalloc()</span></code>, <code class="docutils literal notranslate"><span class="pre">cudaFree()</span></code>, <code class="docutils literal notranslate"><span class="pre">cudaMemcpy()</span></code>, and <code class="docutils literal notranslate"><span class="pre">cudaMemcpyAsync()</span></code>.</p>
<p>cuSolverMg is GPU-accelerated ScaLAPACK. By now, cuSolverMg supports 1-D column block cyclic layout and provides symmetric eigenvalue solver.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cuSolver library requires hardware with a CUDA Compute Capability (CC) of 5.0 or higher. Please see the <em>CUDA C++ Programming Guide</em> for a list of the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#compute-capabilities">Compute Capabilities</a> corresponding to all NVIDIA GPUs.</p>
</div>
<section id="cusolverdn-dense-lapack">
<h2>
<span class="section-number">1.1. </span>cuSolverDN: Dense LAPACK<a class="headerlink" href="index.html#cusolverdn-dense-lapack" title="Permalink to this headline"></a>
</h2>
<p>The cuSolverDN library was designed to solve dense linear systems of the form</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(Ax = b\)</span></p></td>
</tr>
</tbody>
</table>
<p>where the coefficient matrix <span class="math notranslate nohighlight">\(A\in R^{nxn}\)</span> , right-hand-side vector <span class="math notranslate nohighlight">\(b\in R^{n}\)</span> and solution vector <span class="math notranslate nohighlight">\(x\in R^{n}\)</span></p>
<p>The cuSolverDN library provides QR factorization and LU with partial pivoting to handle a general matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, which may be non-symmetric. Cholesky factorization is also provided for symmetric/Hermitian matrices. For symmetric indefinite matrices, we provide Bunch-Kaufman (LDL) factorization.</p>
<p>The cuSolverDN library also provides a helpful bidiagonalization routine and singular value decomposition (SVD).</p>
<p>The cuSolverDN library targets computationally-intensive and popular routines in LAPACK, and provides an API compatible with LAPACK. The user can accelerate these time-consuming routines with cuSolverDN and keep others in LAPACK without a major change to existing code.</p>
</section>
<section id="cusolversp-sparse-lapack">
<h2>
<span class="section-number">1.2. </span>cuSolverSP: Sparse LAPACK<a class="headerlink" href="index.html#cusolversp-sparse-lapack" title="Permalink to this headline"></a>
</h2>
<p>The cuSolverSP library was mainly designed to a solve sparse linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(Ax = b\)</span></p></td>
</tr>
</tbody>
</table>
<p>and the least-squares problem</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(x = {argmin}{||}A*z - b{||}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where sparse matrix <span class="math notranslate nohighlight">\(A\in R^{mxn}\)</span> , right-hand-side vector <span class="math notranslate nohighlight">\(b\in R^{m}\)</span> and solution vector <span class="math notranslate nohighlight">\(x\in R^{n}\)</span> . For a linear system, we require <code class="docutils literal notranslate"><span class="pre">m=n</span></code>.</p>
<p>The core algorithm is based on sparse QR factorization. The matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is accepted in CSR format. If matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric/Hermitian, the user has to provide a full matrix, ie fill missing lower or upper part.</p>
<p>If matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric positive definite and the user only needs to solve <span class="math notranslate nohighlight">\(Ax = b\)</span> , Cholesky factorization can work and the user only needs to provide the lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>On top of the linear and least-squares solvers, the <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library provides a simple eigenvalue solver based on shift-inverse power method, and a function to count the number of eigenvalues contained in a box in the complex plane.</p>
</section>
<section id="cusolverrf-refactorization">
<h2>
<span class="section-number">1.3. </span>cuSolverRF: Refactorization<a class="headerlink" href="index.html#cusolverrf-refactorization" title="Permalink to this headline"></a>
</h2>
<p>The cuSolverRF library was designed to accelerate solution of sets of linear systems by fast re-factorization when given new coefficients in the same sparsity pattern</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where a sequence of coefficient matrices <span class="math notranslate nohighlight">\(A_{i}\in R^{nxn}\)</span> , right-hand-sides <span class="math notranslate nohighlight">\(f_{i}\in R^{n}\)</span> and solutions <span class="math notranslate nohighlight">\(x_{i}\in R^{n}\)</span> are given for <code class="docutils literal notranslate"><span class="pre">i=1,...,k</span></code>.</p>
<p>The cuSolverRF library is applicable when the sparsity pattern of the coefficient matrices <span class="math notranslate nohighlight">\(A_{i}\)</span> as well as the reordering to minimize fill-in and the pivoting used during the LU factorization remain the same across these linear systems. In that case, the first linear system (<code class="docutils literal notranslate"><span class="pre">i=1</span></code>) requires a full LU factorization, while the subsequent linear systems (<code class="docutils literal notranslate"><span class="pre">i=2,...,k</span></code>) require only the LU re-factorization. The later can be performed using the cuSolverRF library.</p>
<p>Notice that because the sparsity pattern of the coefficient matrices, the reordering and pivoting remain the same, the sparsity pattern of the resulting triangular factors <span class="math notranslate nohighlight">\(L_{i}\)</span> and <span class="math notranslate nohighlight">\(U_{i}\)</span> also remains the same. Therefore, the real difference between the full LU factorization and LU re-factorization is that the required memory is known ahead of time.</p>
</section>
<section id="naming-conventions">
<h2>
<span class="section-number">1.4. </span>Naming Conventions<a class="headerlink" href="index.html#naming-conventions" title="Permalink to this headline"></a>
</h2>
<p>The cuSolverDN library provides two different APIs; <code class="docutils literal notranslate"><span class="pre">legacy</span></code> and <code class="docutils literal notranslate"><span class="pre">generic</span></code>.</p>
<p>The functions in the legacy API are available for data types <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, and <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code>. The naming convention for the legacy API is as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDn</span></code>&lt;<code class="docutils literal notranslate"><span class="pre">t</span></code>&gt;&lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt;</p></td>
</tr>
</tbody>
</table>
<p>where &lt;<code class="docutils literal notranslate"><span class="pre">t</span></code>&gt; can be <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">Z</span></code>, or <code class="docutils literal notranslate"><span class="pre">X</span></code>, corresponding to the data types <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code>, and the generic type, respectively. &lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt; can be Cholesky factorization (<code class="docutils literal notranslate"><span class="pre">potrf</span></code>), LU with partial pivoting (<code class="docutils literal notranslate"><span class="pre">getrf</span></code>), QR factorization (<code class="docutils literal notranslate"><span class="pre">geqrf</span></code>) and Bunch-Kaufman factorization (<code class="docutils literal notranslate"><span class="pre">sytrf</span></code>).</p>
<p>The functions in the generic API provide a single entry point for each routine and support for 64-bit integers to define matrix and vector dimensions. The naming convention for the generic API is data-agnostic and is as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDn</span></code>&lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt;</p></td>
</tr>
</tbody>
</table>
<p>where &lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt; can be Cholesky factorization (<code class="docutils literal notranslate"><span class="pre">potrf</span></code>), LU with partial pivoting (<code class="docutils literal notranslate"><span class="pre">getrf</span></code>) and QR factorization (<code class="docutils literal notranslate"><span class="pre">geqrf</span></code>).</p>
<p>The cuSolverSP library functions are available for data types <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, and <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code>. The naming convention is as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverSp[Host]</span></code>&lt;<code class="docutils literal notranslate"><span class="pre">t</span></code>&gt;[&lt;<code class="docutils literal notranslate"><span class="pre">matrix</span> <span class="pre">data</span> <span class="pre">format</span></code>&gt;]&lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt;[&lt;<code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">matrix</span> <span class="pre">data</span> <span class="pre">format</span></code>&gt;]&lt;<code class="docutils literal notranslate"><span class="pre">based</span> <span class="pre">on</span></code>&gt;</p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">cuSolverSp</span></code> is the GPU path and <code class="docutils literal notranslate"><span class="pre">cusolverSpHost</span></code> is the corresponding CPU path. &lt;<code class="docutils literal notranslate"><span class="pre">t</span></code>&gt; can be <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">Z</span></code>, or <code class="docutils literal notranslate"><span class="pre">X</span></code>, corresponding to the data types <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code>, and the generic type, respectively.</p>
<p>The &lt;<code class="docutils literal notranslate"><span class="pre">matrix</span> <span class="pre">data</span> <span class="pre">format</span></code>&gt; is <code class="docutils literal notranslate"><span class="pre">csr</span></code>, compressed sparse row format.</p>
<p>The &lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt; can be <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">lsq</span></code>, <code class="docutils literal notranslate"><span class="pre">eig</span></code>, <code class="docutils literal notranslate"><span class="pre">eigs</span></code>, corresponding to linear solver, least-square solver, eigenvalue solver and number of eigenvalues in a box, respectively.</p>
<p>The &lt;<code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">matrix</span> <span class="pre">data</span> <span class="pre">format</span></code>&gt; can be <code class="docutils literal notranslate"><span class="pre">v</span></code> or <code class="docutils literal notranslate"><span class="pre">m</span></code>, corresponding to a vector or a matrix.</p>
<p>&lt;<code class="docutils literal notranslate"><span class="pre">based</span> <span class="pre">on</span></code>&gt; describes which algorithm is used. For example, <code class="docutils literal notranslate"><span class="pre">qr</span></code> (sparse QR factorization) is used in linear solver and least-square solver.</p>
<p>All of the functions have the return type <code class="docutils literal notranslate"><span class="pre">cusolverStatus_t</span></code> and are explained in more detail in the chapters that follow.</p>
<table class="table-no-stripes docutils align-default" id="id21">
<caption>
<span class="caption-text">Table 1. cuSolverSP API</span><a class="headerlink" href="index.html#id21" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 35%">
<col style="width: 14%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Routine</strong></p></th>
<th class="head"><p><strong>Data format</strong></p></th>
<th class="head"><p><strong>Operation</strong></p></th>
<th class="head"><p><strong>Output format</strong></p></th>
<th class="head"><p><strong>Based on</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">solver</span> <span class="pre">(ls)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">(v)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LU</span> <span class="pre">(lu)</span> <span class="pre">with</span> <span class="pre">partial</span> <span class="pre">pivoting</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrlsvqr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">solver</span> <span class="pre">(ls)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">(v)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">QR</span> <span class="pre">factorization</span> <span class="pre">(qr)</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrlsvchol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">solver</span> <span class="pre">(ls)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">(v)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Cholesky</span> <span class="pre">factorization</span> <span class="pre">(chol)</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrlsqvqr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">least-square</span> <span class="pre">solver</span> <span class="pre">(lsq)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">(v)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">QR</span> <span class="pre">factorization</span> <span class="pre">(qr)</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csreigvsi</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eigenvalue</span> <span class="pre">solver</span> <span class="pre">(eig)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">(v)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">shift-inverse</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csreigs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">eigenvalues</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">box</span> <span class="pre">(eigs)</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrsymrcm</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">csr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Symmetric</span> <span class="pre">Reverse</span> <span class="pre">Cuthill-McKee</span> <span class="pre">(symrcm)</span></code></p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The cuSolverRF library routines are available for data type <code class="docutils literal notranslate"><span class="pre">double</span></code>. Most of the routines follow the naming convention:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverRf</span></code>_&lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt;_[<code class="docutils literal notranslate"><span class="pre">[Host]</span></code>](…)</p></td>
</tr>
</tbody>
</table>
<p>where the trailing optional Host qualifier indicates the data is accessed on the host versus on the device, which is the default. The &lt;<code class="docutils literal notranslate"><span class="pre">operation</span></code>&gt; can be <code class="docutils literal notranslate"><span class="pre">Setup</span></code>, <code class="docutils literal notranslate"><span class="pre">Analyze</span></code>, <code class="docutils literal notranslate"><span class="pre">Refactor</span></code>, <code class="docutils literal notranslate"><span class="pre">Solve</span></code>, <code class="docutils literal notranslate"><span class="pre">ResetValues</span></code>, <code class="docutils literal notranslate"><span class="pre">AccessBundledFactors</span></code> and <code class="docutils literal notranslate"><span class="pre">ExtractSplitFactors</span></code>.</p>
<p>Finally, the return type of the cuSolverRF library routines is <code class="docutils literal notranslate"><span class="pre">cusolverStatus_t</span></code>.</p>
</section>
<section id="asynchronous-execution">
<h2>
<span class="section-number">1.5. </span>Asynchronous Execution<a class="headerlink" href="index.html#asynchronous-execution" title="Permalink to this headline"></a>
</h2>
<p>The cuSolver library functions prefer to keep asynchronous execution as much as possible. Developers can always use the <code class="docutils literal notranslate"><span class="pre">cudaDeviceSynchronize()</span></code> function to ensure that the execution of a particular cuSolver library routine has completed.</p>
<p>A developer can also use the <code class="docutils literal notranslate"><span class="pre">cudaMemcpy()</span></code> routine to copy data from the device to the host and vice versa, using the <code class="docutils literal notranslate"><span class="pre">cudaMemcpyDeviceToHost</span></code> and <code class="docutils literal notranslate"><span class="pre">cudaMemcpyHostToDevice</span></code> parameters, respectively. In this case there is no need to add a call to <code class="docutils literal notranslate"><span class="pre">cudaDeviceSynchronize()</span></code> because the call to <code class="docutils literal notranslate"><span class="pre">cudaMemcpy()</span></code> with the above parameters is blocking and completes only when the results are ready on the host.</p>
</section>
<section id="library-property">
<h2>
<span class="section-number">1.6. </span>Library Property<a class="headerlink" href="index.html#library-property" title="Permalink to this headline"></a>
</h2>
<p>The <code class="docutils literal notranslate"><span class="pre">libraryPropertyType</span></code> data type is an enumeration of library property types. (ie. CUDA version X.Y.Z would yield <code class="docutils literal notranslate"><span class="pre">MAJOR_VERSION=X</span></code>, <code class="docutils literal notranslate"><span class="pre">MINOR_VERSION=Y</span></code>, <code class="docutils literal notranslate"><span class="pre">PATCH_LEVEL=Z</span></code>)</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="nc">libraryPropertyType_t</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">MAJOR_VERSION</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">MINOR_VERSION</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">PATCH_LEVEL</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">libraryPropertyType</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following code can show the version of cusolver library.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">major</span><span class="o">=</span><span class="mi">-1</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="mi">-1</span><span class="p">,</span><span class="n">patch</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="n">cusolverGetProperty</span><span class="p">(</span><span class="n">MAJOR_VERSION</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">major</span><span class="p">);</span><span class="w"></span>
<span class="n">cusolverGetProperty</span><span class="p">(</span><span class="n">MINOR_VERSION</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">minor</span><span class="p">);</span><span class="w"></span>
<span class="n">cusolverGetProperty</span><span class="p">(</span><span class="n">PATCH_LEVEL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">patch</span><span class="p">);</span><span class="w"></span>
<span class="n">printf</span><span class="p">(</span><span class="s">"CUSOLVER Version (Major,Minor,PatchLevel): %d.%d.%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">major</span><span class="p">,</span><span class="n">minor</span><span class="p">,</span><span class="n">patch</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="high-precision-package">
<h2>
<span class="section-number">1.7. </span>High Precision Package<a class="headerlink" href="index.html#high-precision-package" title="Permalink to this headline"></a>
</h2>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolver</span></code> library uses high precision for iterative refinement when necessary.</p>
</section>
</section>
<section id="using-the-cusolver-api">
<h1>
<span class="section-number">2. </span>Using the CUSOLVER API<a class="headerlink" href="index.html#using-the-cusolver-api" title="Permalink to this headline"></a>
</h1>
<section id="general-description">
<h2>
<span class="section-number">2.1. </span>General Description<a class="headerlink" href="index.html#general-description" title="Permalink to this headline"></a>
</h2>
<p>This chapter describes how to use the cuSolver library API. It is not a reference for the cuSolver API data types and functions; that is provided in subsequent chapters.</p>
<section id="thread-safety">
<h3>
<span class="section-number">2.1.1. </span>Thread Safety<a class="headerlink" href="index.html#thread-safety" title="Permalink to this headline"></a>
</h3>
<p><em>The library is thread-safe, and its functions can be called from multiple host threads.</em></p>
</section>
<section id="scalar-parameters">
<h3>
<span class="section-number">2.1.2. </span>Scalar Parameters<a class="headerlink" href="index.html#scalar-parameters" title="Permalink to this headline"></a>
</h3>
<p>In the cuSolver API, the scalar parameters can be passed by reference on the host.</p>
</section>
<section id="parallelism-with-streams">
<h3>
<span class="section-number">2.1.3. </span>Parallelism with Streams<a class="headerlink" href="index.html#parallelism-with-streams" title="Permalink to this headline"></a>
</h3>
<p>If the application performs several small independent computations, or if it makes data transfers in parallel with the computation, then CUDA streams can be used to overlap these tasks.</p>
<p>The application can conceptually associate a stream with each task. To achieve the overlap of computation between the tasks, the developer should:</p>
<ol class="arabic simple">
<li><p>Create CUDA streams using the function <code class="docutils literal notranslate"><span class="pre">cudaStreamCreate()</span></code>, and</p></li>
<li><p>Set the stream to be used by each individual cuSolver library routine by calling, for example, <a class="reference internal" href="index.html#cusolverdnsetstream"><span class="std std-ref">cusolverDnSetStream()</span></a>, just prior to calling the actual cuSolverDN routine.</p></li>
</ol>
<p>The computations performed in separate streams would then be overlapped automatically on the GPU, when possible. This approach is especially useful when the computation performed by a single task is relatively small, and is not enough to fill the GPU with work, or when there is a data transfer that can be performed in parallel with the computation.</p>
</section>
<section id="how-to-link-cusolver-library">
<h3>
<span class="section-number">2.1.4. </span>How to Link cusolver Library<a class="headerlink" href="index.html#how-to-link-cusolver-library" title="Permalink to this headline"></a>
</h3>
<p><code class="docutils literal notranslate"><span class="pre">cusolver</span></code> library provides dynamic library <code class="docutils literal notranslate"><span class="pre">libcusolver.so</span></code> and static library <code class="docutils literal notranslate"><span class="pre">libcusolver_static.a</span></code>. If the user links the application with <code class="docutils literal notranslate"><span class="pre">libcusolver.so</span></code>, <code class="docutils literal notranslate"><span class="pre">libcublas.so</span></code>, <code class="docutils literal notranslate"><span class="pre">libcublasLt.so</span></code> and <code class="docutils literal notranslate"><span class="pre">libcusparse.so</span></code> are also required. If the user links the application with <code class="docutils literal notranslate"><span class="pre">libcusolver_static.a</span></code>, the following libraries are also needed, <code class="docutils literal notranslate"><span class="pre">libcudart_static.a</span></code>, <code class="docutils literal notranslate"><span class="pre">libculibos.a</span></code>, <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code>, <code class="docutils literal notranslate"><span class="pre">libcusolver_metis_static.a</span></code>, <code class="docutils literal notranslate"><span class="pre">libcublas_static.a</span></code> and <code class="docutils literal notranslate"><span class="pre">libcusparse_static.a</span></code>.</p>
</section>
<section id="link-third-party-lapack-library">
<h3>
<span class="section-number">2.1.5. </span>Link Third-party LAPACK Library<a class="headerlink" href="index.html#link-third-party-lapack-library" title="Permalink to this headline"></a>
</h3>
<p>Starting with CUDA 10.1 update 2, NVIDIA LAPACK library <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> is a subset of LAPACK and only contains GPU accelerated <code class="docutils literal notranslate"><span class="pre">stedc</span></code> and <code class="docutils literal notranslate"><span class="pre">bdsqr</span></code>. The user has to link <code class="docutils literal notranslate"><span class="pre">libcusolver_static.a</span></code> with <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> in order to build the application successfully. Prior to CUDA 10.1 update 2, the user can replace <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> with a third-party LAPACK library, for example, MKL. In CUDA 10.1 update 2, the third-party LAPACK library no longer affects the behavior of cusolver library, neither functionality nor performance. Furthermore the user cannot use <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> as a standalone LAPACK library because it is only a subset of LAPACK.</p>
<ul class="simple">
<li><p>If you use <code class="docutils literal notranslate"><span class="pre">libcusolver_static.a</span></code>, then you must link with <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> explicitly, otherwise the linker will report missing symbols. There are no symbol conflicts between <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> and other third-party LAPACK libraries, which allows linking the same application to <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> and another third-party LAPACK library.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">libcusolver_lapack_static.a</span></code> is built inside <code class="docutils literal notranslate"><span class="pre">libcusolver.so</span></code>. Hence, if you use <code class="docutils literal notranslate"><span class="pre">libcusolver.so</span></code>, then you don’t need to specify a LAPACK library. The <code class="docutils literal notranslate"><span class="pre">libcusolver.so</span></code> will not pick up any routines from the third-party LAPACK library even if you link the application with it.</p></li>
</ul>
</section>
<section id="convention-of-info">
<h3>
<span class="section-number">2.1.6. </span>Convention of info<a class="headerlink" href="index.html#convention-of-info" title="Permalink to this headline"></a>
</h3>
<p>Each LAPACK routine returns an <code class="docutils literal notranslate"><span class="pre">info</span></code> which indicates the position of invalid parameter. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, then i-th parameter is invalid. To be consistent with base-1 in LAPACK, <code class="docutils literal notranslate"><span class="pre">cusolver</span></code> does not report invalid <code class="docutils literal notranslate"><span class="pre">handle</span></code> into <code class="docutils literal notranslate"><span class="pre">info</span></code>. Instead, <code class="docutils literal notranslate"><span class="pre">cusolver</span></code> returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code> for invalid <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p>
</section>
<section id="usage-of-buffersize">
<h3>
<span class="section-number">2.1.7. </span>Usage of _bufferSize<a class="headerlink" href="index.html#usage-of-buffersize" title="Permalink to this headline"></a>
</h3>
<p>There is no cudaMalloc inside <code class="docutils literal notranslate"><span class="pre">cuSolver</span></code> library, the user must allocate the device workspace explicitly. The routine <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> is to query the size of workspace of the routine <code class="docutils literal notranslate"><span class="pre">xyz</span></code>, for example <code class="docutils literal notranslate"><span class="pre">xyz</span> <span class="pre">=</span> <span class="pre">potrf</span></code>. To make the API simple, <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> follows almost the same signature of <code class="docutils literal notranslate"><span class="pre">xyz</span></code> even it only depends on some parameters, for example, device pointer is not used to decide the size of workspace. In most cases, <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> is called in the beginning before actual device data (pointing by a device pointer) is prepared or before the device pointer is allocated. In such case, the user can pass null pointer to <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> without breaking the functionality.</p>
</section>
<section id="cusolverdn-logging">
<span id="id1"></span><h3>
<span class="section-number">2.1.8. </span>cuSOLVERDn Logging<a class="headerlink" href="index.html#cusolverdn-logging" title="Permalink to this headline"></a>
</h3>
<p>cuSOLVERDn logging mechanism can be enabled by setting the following environment variables before launching the target application:</p>
<ul>
<li>
<p><code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_LOG_LEVEL=&lt;level&gt;</span></code> - where <code class="docutils literal notranslate"><span class="pre">&lt;level&gt;</span></code> is one of the following levels:</p>
<blockquote>
<div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - Off - logging is disabled (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - Error - only errors will be logged</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - Trace - API calls that launch CUDA kernels will log their parameters and important information</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> - Hints - hints that can potentially improve the application’s performance</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> - Info - provides general information about the library execution, may contain details about heuristic status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> - API Trace - API calls will log their parameter and important information</p></li>
</ul>
</div>
</blockquote>
</li>
<li>
<p><code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_LOG_MASK=&lt;mask&gt;</span></code> - where mask is a combination of the following masks:</p>
<blockquote>
<div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - Off</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - Error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - Trace</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> - Hints</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">8</span></code> - Info</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">16</span></code> - API Trace</p></li>
</ul>
</div>
</blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_LOG_FILE=&lt;file_name&gt;</span></code> - where file name is a path to a log file. File name may contain <code class="docutils literal notranslate"><span class="pre">%i</span></code>, that will be replaced with the process id, e.g. <code class="docutils literal notranslate"><span class="pre">&lt;file_name&gt;_%i.log</span></code>. If <code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_LOG_FILE</span></code> is not defined, the log messages are printed to stdout.</p></li>
</ul>
<p>Another option is to use the experimental cusolverDn logging API. See:
<a class="reference internal" href="index.html#cusolverdnloggersetcallback"><span class="std std-ref">cusolverDnLoggerSetCallback()</span></a>, <a class="reference internal" href="index.html#cusolverdnloggersetfile"><span class="std std-ref">cusolverDnLoggerSetFile()</span></a>, <a class="reference internal" href="index.html#cusolverdnloggeropenfile"><span class="std std-ref">cusolverDnLoggerOpenFile()</span></a>, <a class="reference internal" href="index.html#cusolverdnloggersetlevel"><span class="std std-ref">cusolverDnLoggerSetLevel()</span></a>, <a class="reference internal" href="index.html#cusolverdnloggersetmask"><span class="std std-ref">cusolverDnLoggerSetMask()</span></a>, <a class="reference internal" href="index.html#cusolverdnloggerforcedisable"><span class="std std-ref">cusolverDnLoggerForceDisable()</span></a>.</p>
</section>
<section id="deterministic-results">
<h3>
<span class="section-number">2.1.9. </span>Deterministic Results<a class="headerlink" href="index.html#deterministic-results" title="Permalink to this headline"></a>
</h3>
<p>Throughout this documentation, a function is declared as <em>deterministic</em> if it computes the exact same bitwise results for every execution with the same input parameters, hard- and software environment. Conversely, a <em>non-deterministic</em> function might compute bitwise different results due to a varying order of floating point operations, e.g., a sum <code class="docutils literal notranslate"><span class="pre">s</span></code> of four values <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code> can be computed in different orders:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)</span> <span class="pre">+</span> <span class="pre">(c</span> <span class="pre">+</span> <span class="pre">d)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">(b</span> <span class="pre">+</span> <span class="pre">c))</span> <span class="pre">+</span> <span class="pre">d</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">(b</span> <span class="pre">+</span> <span class="pre">(c</span> <span class="pre">+</span> <span class="pre">d))</span></code></p></li>
<li><p>…</p></li>
</ol>
<p>Due to the non-associativity of floating point arithmetic, all results might be bitwise different.</p>
<p>By default, cuSolverDN computes deterministic results. For improved performance of some functions, it is possible to allow non-deterministic results with <code class="docutils literal notranslate"><span class="pre">cusolverDnSetDeterministicMode()</span></code>.</p>
</section>
</section>
<section id="cusolver-types-reference">
<h2>
<span class="section-number">2.2. </span>cuSolver Types Reference<a class="headerlink" href="index.html#cusolver-types-reference" title="Permalink to this headline"></a>
</h2>
<section id="cusolverdn-types">
<h3>
<span class="section-number">2.2.1. </span>cuSolverDN Types<a class="headerlink" href="index.html#cusolverdn-types" title="Permalink to this headline"></a>
</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, and <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code> data types are supported. The first two are standard C data types, while the last two are exported from <code class="docutils literal notranslate"><span class="pre">cuComplex.h</span></code>. In addition, cuSolverDN uses some familiar types from cuBLAS.</p>
<section id="cusolverdnhandle-t">
<h4>
<span class="section-number">2.2.1.1. </span>cusolverDnHandle_t<a class="headerlink" href="index.html#cusolverdnhandle-t" title="Permalink to this headline"></a>
</h4>
<p>This is a pointer type to an opaque cuSolverDN context, which the user must initialize by calling <a class="reference internal" href="index.html#cusolverdncreate"><span class="std std-ref">cusolverDnCreate()</span></a> prior to calling any other library function. An un-initialized Handle object will lead to unexpected behavior, including crashes of cuSolverDN. The handle created and returned by <a class="reference internal" href="index.html#cusolverdncreate"><span class="std std-ref">cusolverDnCreate()</span></a> must be passed to every cuSolverDN function.</p>
</section>
<section id="cublasfillmode-t">
<h4>
<span class="section-number">2.2.1.2. </span>cublasFillMode_t<a class="headerlink" href="index.html#cublasfillmode-t" title="Permalink to this headline"></a>
</h4>
<p>The type indicates which part (lower or upper) of the dense matrix was filled and consequently should be used by the function.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code></p></td>
<td><p>The lower part of the matrix is filled.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code></p></td>
<td><p>The upper part of the matrix is filled.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_FULL</span></code></p></td>
<td><p>The full matrix is filled.</p></td>
</tr>
</tbody>
</table>
<p>Notice that BLAS implementations often use Fortran characters <code class="docutils literal notranslate"><span class="pre">‘L’</span></code> or <code class="docutils literal notranslate"><span class="pre">‘l’</span></code> (lower) and    <code class="docutils literal notranslate"><span class="pre">‘U’</span></code> or <code class="docutils literal notranslate"><span class="pre">‘u’</span></code> (upper) to describe which part of the matrix is filled.</p>
</section>
<section id="cublasoperation-t">
<h4>
<span class="section-number">2.2.1.3. </span>cublasOperation_t<a class="headerlink" href="index.html#cublasoperation-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cublasOperation_t</span></code> type indicates which operation needs to be performed with the dense matrix.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_OP_N</span></code></p></td>
<td><p>The non-transpose operation is selected.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_OP_T</span></code></p></td>
<td><p>The transpose operation is selected.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_OP_C</span></code></p></td>
<td><p>The conjugate transpose operation is selected.</p></td>
</tr>
</tbody>
</table>
<p>Notice that BLAS implementations often use Fortran characters <code class="docutils literal notranslate"><span class="pre">‘N’</span></code> or <code class="docutils literal notranslate"><span class="pre">‘n’</span></code> (non-transpose), <code class="docutils literal notranslate"><span class="pre">‘T’</span></code> or <code class="docutils literal notranslate"><span class="pre">‘t’</span></code>    (transpose) and <code class="docutils literal notranslate"><span class="pre">‘C’</span></code> or <code class="docutils literal notranslate"><span class="pre">‘c’</span></code> (conjugate transpose) to describe which operations needs to be performed     with the dense matrix.</p>
</section>
<section id="cusolvereigtype-t">
<h4>
<span class="section-number">2.2.1.4. </span>cusolverEigType_t<a class="headerlink" href="index.html#cusolvereigtype-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverEigType_t</span></code> type indicates which type of eigenvalue the solver is.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 59%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_1</span></code></p></td>
<td><p>A*x = lambda*B*x</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_2</span></code></p></td>
<td><p>A*B*x = lambda*x</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_3</span></code></p></td>
<td><p>B*A*x = lambda*x</p></td>
</tr>
</tbody>
</table>
<p>Notice that LAPACK implementations often use Fortran integer <code class="docutils literal notranslate"><span class="pre">1</span></code> (A*x = lambda*B*x), <code class="docutils literal notranslate"><span class="pre">2</span></code> (A*B*x = lambda*x), <code class="docutils literal notranslate"><span class="pre">3</span></code> (B*A*x = lambda*x) to indicate which type of eigenvalue the solver is.</p>
</section>
<section id="cusolvereigmode-t">
<h4>
<span class="section-number">2.2.1.5. </span>cusolverEigMode_t<a class="headerlink" href="index.html#cusolvereigmode-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverEigMode_t</span></code> type indicates whether or not eigenvectors are computed.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code></p></td>
<td><p>Only eigenvalues are computed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code></p></td>
<td><p>Both eigenvalues and eigenvectors are computed.</p></td>
</tr>
</tbody>
</table>
<p>Notice that LAPACK implementations often use Fortran character <code class="docutils literal notranslate"><span class="pre">'N'</span></code> (only eigenvalues are computed), <code class="docutils literal notranslate"><span class="pre">'V'</span></code> (both eigenvalues and eigenvectors are computed) to indicate whether or not eigenvectors        are computed.</p>
</section>
<section id="cusolverirsrefinement-t">
<h4>
<span class="section-number">2.2.1.6. </span>cusolverIRSRefinement_t<a class="headerlink" href="index.html#cusolverirsrefinement-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverIRSRefinement_t</span></code> type indicates which solver type would be used for the specific cusolver function. Most of our experimentation shows that CUSOLVER_IRS_REFINE_GMRES is the best option.</p>
<p><em>More details about the refinement process can be found in Azzam Haidar, Stanimire Tomov, Jack Dongarra, and Nicholas J. Higham. 2018. Harnessing GPU tensor cores for fast FP16 arithmetic to speed up mixed-precision iterative refinement solvers. In Proceedings of the International Conference for High Performance Computing, Networking, Storage, and Analysis (SC ‘18). IEEE Press, Piscataway, NJ, USA, Article 47, 11 pages.</em></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_NOT_SET</span></code></p></td>
<td><p>Solver is not set; this value is what is set when creating the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure. IRS solver will return an error.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_NONE</span></code></p></td>
<td><p>No refinement solver, the IRS solver performs a factorization followed by a solve without any refinement. For example if the IRS solver was <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code>, this is equivalent to a Xgesv routine without refinement and where the factorization is carried out in the lowest precision. If for example the main precision was CUSOLVER_R_64F and the lowest was CUSOLVER_R_64F as well, then this is equivalent to a call to <code class="docutils literal notranslate"><span class="pre">cusolverDnDgesv()</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL</span></code></p></td>
<td><p>Classical iterative refinement solver. Similar to the one used in LAPACK routines.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_GMRES</span></code></p></td>
<td><p>GMRES (Generalized Minimal Residual) based iterative refinement solver. In recent study, the GMRES method has drawn the scientific community attention for its ability to be used as refinement solver that outperforms the classical iterative refinement method. Based on our experimentation, we recommend this setting.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL_GMRES</span></code></p></td>
<td><p>Classical iterative refinement solver that uses the GMRES (Generalized Minimal Residual) internally to solve the correction equation at each iteration. We call the <em>classical refinement iteration</em> the outer iteration while the <em>GMRES</em> is called inner iteration. Note that if the tolerance of the inner GMRES is set very low, lets say to machine precision, then the outer <em>classical refinement iteration</em> will performs only one iteration and thus this option will behave like <code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_GMRES</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_GMRES_GMRES</span></code></p></td>
<td><p>Similar to <code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL_GMRES</span></code> which consists of classical refinement process that uses GMRES to solve the inner correction system; here it is a GMRES (Generalized Minimal Residual) based iterative refinement solver that uses another GMRES internally to solve the preconditioned system.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparams-t">
<h4>
<span class="section-number">2.2.1.7. </span>cusolverDnIRSParams_t<a class="headerlink" href="index.html#cusolverdnirsparams-t" title="Permalink to this headline"></a>
</h4>
<p>This is a pointer type to an opaque <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span></code> structure, which holds parameters for the iterative refinement linear solvers such as <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesv()</span></code>. Use corresponding helper functions described below to either Create/Destroy this structure or Set/Get solver parameters.</p>
</section>
<section id="cusolverdnirsinfos-t">
<h4>
<span class="section-number">2.2.1.8. </span>cusolverDnIRSInfos_t<a class="headerlink" href="index.html#cusolverdnirsinfos-t" title="Permalink to this headline"></a>
</h4>
<p>This is a pointer type to an opaque <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span></code> structure, which holds information about the performed call to an iterative refinement linear solver (e.g., <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesv()</span></code>). Use corresponding helper functions described below to either Create/Destroy this structure or retrieve solve information.</p>
</section>
<section id="cusolverdnfunction-t">
<h4>
<span class="section-number">2.2.1.9. </span>cusolverDnFunction_t<a class="headerlink" href="index.html#cusolverdnfunction-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnFunction_t</span></code> type indicates which routine needs to be configured by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions()</span></code>. The value <code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_GETRF</span></code> corresponds to the routine <code class="docutils literal notranslate"><span class="pre">Getrf</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 44%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVERDN_GETRF</span></code></p></td>
<td><p>Corresponds to <code class="docutils literal notranslate"><span class="pre">Getrf</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolveralgmode-t">
<h4>
<span class="section-number">2.2.1.10. </span>cusolverAlgMode_t<a class="headerlink" href="index.html#cusolveralgmode-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverAlgMode_t</span></code> type indicates which algorithm is selected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions()</span></code>. The set of algorithms supported for each routine is described in detail along with the routine’s documentation.</p>
<p>The default algorithm is <code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code>. The user can also provide <code class="docutils literal notranslate"><span class="pre">NULL</span></code> to use the default algorithm.</p>
</section>
<section id="cusolverstatus-t">
<h4>
<span class="section-number">2.2.1.11. </span>cusolverStatus_t<a class="headerlink" href="index.html#cusolverstatus-t" title="Permalink to this headline"></a>
</h4>
<p>This is the same as <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> in the sparse LAPACK section.</p>
</section>
<section id="cusolverdnloggercallback-t">
<span id="id2"></span><h4>
<span class="section-number">2.2.1.12. </span>cusolverDnLoggerCallback_t<a class="headerlink" href="index.html#cusolverdnloggercallback-t" title="Permalink to this headline"></a>
</h4>
<p><cite>cusolverDnLoggerCallback_t</cite> is a callback function pointer type.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">logLevel</span></code></p></td>
<td></td>
<td><p>output</p></td>
<td><p>See <a class="reference internal" href="index.html#cusolverdn-logging"><span class="std std-ref">cuSOLVERDn Logging</span></a></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">functionName</span></code></p></td>
<td></td>
<td><p>output</p></td>
<td><p>The name of the API that logged this message.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p></td>
<td></td>
<td><p>output</p></td>
<td><p>The log message.</p></td>
</tr>
</tbody>
</table>
<p>Use the below function to set the callback function: <a class="reference internal" href="index.html#cusolverdnloggersetcallback"><span class="std std-ref">cusolverDnLoggerSetCallback()</span></a>.</p>
</section>
<section id="cusolverdeterministicmode-t">
<h4>
<span class="section-number">2.2.1.13. </span>cusolverDeterministicMode_t<a class="headerlink" href="index.html#cusolverdeterministicmode-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverDeterministicMode_t</span></code> type indicates whether multiple cuSolver function executions with the same input have the same bitwise equal result (deterministic) or might have bitwise different results (non-deterministic). In comparison to <a class="reference external" href="https://docs.nvidia.com/cuda/cublas/#cublasatomicsmode-t">cublasAtomicsMode_t</a>, which only includes the usage of atomic functions, <code class="docutils literal notranslate"><span class="pre">cusolverDeterministicMode_t</span></code> includes all non-deterministic programming patterns.  The deterministic mode can be set and queried using <code class="docutils literal notranslate"><span class="pre">cusolverDnSetDeterministicMode()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGetDeterministicMode()</span></code> routines, respectively.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 48%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_DETERMINISTIC_RESULTS</span></code></p></td>
<td><p>Compute deterministic results.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALLOW_NON_DETERMINISTIC_RESULTS</span></code></p></td>
<td><p>Allow non-deterministic results.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverstorevmode-t">
<span id="id3"></span><h4>
<span class="section-number">2.2.1.14. </span>cusolverStorevMode_t<a class="headerlink" href="index.html#cusolverstorevmode-t" title="Permalink to this headline"></a>
</h4>
<p>Specifies how the vectors which define the elementary reflectors are stored.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 70%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_STOREV_COLUMNWISE</span></code></p></td>
<td><p>Columnwise.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_STOREV_ROWWISE</span></code></p></td>
<td><p>Rowwise.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdirectmode-t">
<span id="id4"></span><h4>
<span class="section-number">2.2.1.15. </span>cusolverDirectMode_t<a class="headerlink" href="index.html#cusolverdirectmode-t" title="Permalink to this headline"></a>
</h4>
<p>Specifies the order in which the elementary reflectors are multiplied to form the block reflector.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 68%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_DIRECT_FORWARD</span></code></p></td>
<td><p>Forward.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUBLAS_DIRECT_BACKWARD</span></code></p></td>
<td><p>Backward.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cusolversp-types">
<h3>
<span class="section-number">2.2.2. </span>cuSolverSP Types<a class="headerlink" href="index.html#cusolversp-types" title="Permalink to this headline"></a>
</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, and <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code> data types are supported. The first two are standard C data types, while the last two are exported from <code class="docutils literal notranslate"><span class="pre">cuComplex.h</span></code>.</p>
<section id="cusolversphandle-t">
<h4>
<span class="section-number">2.2.2.1. </span>cusolverSpHandle_t<a class="headerlink" href="index.html#cusolversphandle-t" title="Permalink to this headline"></a>
</h4>
<p>This is a pointer type to an opaque cuSolverSP context, which the user must initialize by calling <code class="docutils literal notranslate"><span class="pre">cusolverSpCreate()</span></code> prior to calling any other library function. An un-initialized Handle object will lead to unexpected behavior, including crashes of cuSolverSP. The handle created and returned by <code class="docutils literal notranslate"><span class="pre">cusolverSpCreate()</span></code> must be passed to every cuSolverSP function.</p>
</section>
<section id="cusparsematdescr-t">
<h4>
<span class="section-number">2.2.2.2. </span>cusparseMatDescr_t<a class="headerlink" href="index.html#cusparsematdescr-t" title="Permalink to this headline"></a>
</h4>
<p>We have chosen to keep the same structure as exists in cuSPARSE to describe the shape and properties of a matrix. This enables calls to either cuSPARSE or cuSOLVER using the same matrix description.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">cusparseMatrixType_t</span><span class="w"> </span><span class="n">MatrixType</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cusparseFillMode_t</span><span class="w"> </span><span class="n">FillMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cusparseDiagType_t</span><span class="w"> </span><span class="n">DiagType</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cusparseIndexBase_t</span><span class="w"> </span><span class="n">IndexBase</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Please read documentation of the cuSPARSE Library to understand each field of <code class="docutils literal notranslate"><span class="pre">cusparseMatDescr_t</span></code>.</p>
</section>
<section id="id5">
<span id="id6"></span><h4>
<span class="section-number">2.2.2.3. </span>cusolverStatus_t<a class="headerlink" href="index.html#id5" title="Permalink to this headline"></a>
</h4>
<p>This is a status type returned by the library functions and it can have the following values.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 84%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td>
<p>The cuSolver library was not initialized. This is usually caused by the lack of a prior call, an error in the CUDA Runtime API called by the cuSolver routine, or an error in the hardware setup.</p>
<p><strong>To correct:</strong> call <a class="reference internal" href="index.html#cusolverdncreate"><span class="std std-ref">cusolverDnCreate()</span></a> prior to the function call; and check that the hardware, an appropriate version of the driver, and the cuSolver library are correctly installed.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td>
<p>Resource allocation failed inside the cuSolver library. This is usually caused by a <code class="docutils literal notranslate"><span class="pre">cudaMalloc()</span></code> failure.</p>
<p><strong>To correct:</strong> prior to the function call, deallocate previously allocated memory as much as possible.</p>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td>
<p>An unsupported value or parameter was passed to the function (a negative vector size, for example).</p>
<p><strong>To correct:</strong> ensure that all the parameters being passed have valid values.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td>
<p>The function requires a feature absent from the device architecture; usually caused by the lack of support for atomic operations or double precision.</p>
<p><strong>To correct:</strong> compile and run the application on a device with compute capability 5.0 or above.</p>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td>
<p>The GPU program failed to execute. This is often caused by a launch failure of the kernel on the GPU, which can be caused by multiple reasons.</p>
<p><strong>To correct:</strong> check that the hardware, an appropriate version of the driver, and the cuSolver library are correctly installed.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td>
<p>An internal cuSolver operation failed. This error is usually caused by a <code class="docutils literal notranslate"><span class="pre">cudaMemcpyAsync()</span></code> failure.</p>
<p><strong>To correct:</strong> check that the hardware, an appropriate version of the driver, and the cuSolver library are correctly installed. Also, check that the memory passed as a parameter to the routine is not being deallocated prior to the routine’s completion.</p>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td>
<p>The matrix type is not supported by this function. This is usually caused by passing an invalid matrix descriptor to the function.</p>
<p><strong>To correct:</strong> check that the fields in <code class="docutils literal notranslate"><span class="pre">descrA</span></code> were set correctly.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td>
<p>The parameter combination is not supported, e.g. batched version is not supported or <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">&lt;</span> <span class="pre">N</span></code> is not supported.</p>
<p><strong>To correct:</strong> consult the documentation, and use a supported configuration.</p>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cusolverrf-types">
<h3>
<span class="section-number">2.2.3. </span>cuSolverRF Types<a class="headerlink" href="index.html#cusolverrf-types" title="Permalink to this headline"></a>
</h3>
<p>cuSolverRF only supports <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<section id="cusolverrfhandle-t">
<h4>
<span class="section-number">2.2.3.1. </span>cusolverRfHandle_t<a class="headerlink" href="index.html#cusolverrfhandle-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfHandle_t</span></code> is a pointer to an opaque data structure that contains the cuSolverRF library handle. The user must initialize the handle by calling <code class="docutils literal notranslate"><span class="pre">cusolverRfCreate()</span></code> prior to any other cuSolverRF library calls. The handle is passed to all other cuSolverRF library calls.</p>
</section>
<section id="cusolverrfmatrixformat-t">
<h4>
<span class="section-number">2.2.3.2. </span>cusolverRfMatrixFormat_t<a class="headerlink" href="index.html#cusolverrfmatrixformat-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfMatrixFormat_t</span></code> is an enum that indicates the input/output matrix format assumed by the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupDevice()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupHost()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolveRfExtractBundledFactorsHost()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractSplitFactorsHost()</span></code> routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_MATRIX_FORMAT_CSR</span></code></p></td>
<td><p>Matrix format CSR is assumed. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_MATRIX_FORMAT_CSC</span></code></p></td>
<td><p>Matrix format CSC is assumed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfnumericboostreport-t">
<h4>
<span class="section-number">2.2.3.3. </span>cusolverRfNumericBoostReport_t<a class="headerlink" href="index.html#cusolverrfnumericboostreport-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfNumericBoostReport_t</span></code> is an enum that indicates whether numeric boosting (of the pivot) was used during the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routines. The numeric boosting is disabled by default.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_NUMERIC_BOOST_NOT_USED</span></code></p></td>
<td><p>Numeric boosting not used. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_NUMERIC_BOOST_USED</span></code></p></td>
<td><p>Numeric boosting used.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfresetvaluesfastmode-t">
<h4>
<span class="section-number">2.2.3.4. </span>cusolverRfResetValuesFastMode_t<a class="headerlink" href="index.html#cusolverrfresetvaluesfastmode-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValuesFastMode_t</span></code> is an enum that indicates the mode used for the <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code> routine. The fast mode requires extra memory and is recommended only if very fast calls to <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code> are needed.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 57%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_RESET_VALUES_FAST_MODE_OFF</span></code></p></td>
<td><p>Fast mode disabled. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_RESET_VALUES_FAST_MODE_ON</span></code></p></td>
<td><p>Fast mode enabled.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrffactorization-t">
<h4>
<span class="section-number">2.2.3.5. </span>cusolverRfFactorization_t<a class="headerlink" href="index.html#cusolverrffactorization-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfFactorization_t</span></code> is an enum that indicates which (internal) algorithm is used for refactorization in the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 48%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_FACTORIZATION_ALG0</span></code></p></td>
<td><p>Algorithm 0. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_FACTORIZATION_ALG1</span></code></p></td>
<td><p>Algorithm 1.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_FACTORIZATION_ALG2</span></code></p></td>
<td><p>Algorithm 2. Domino-based scheme.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrftriangularsolve-t">
<h4>
<span class="section-number">2.2.3.6. </span>cusolverRfTriangularSolve_t<a class="headerlink" href="index.html#cusolverrftriangularsolve-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfTriangularSolve_t</span></code> is an enum that indicates which (internal) algorithm is used for triangular solve in the <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 51%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_TRIANGULAR_SOLVE_ALG1</span></code></p></td>
<td><p>Algorithm 1. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_TRIANGULAR_SOLVE_ALG2</span></code></p></td>
<td><p>Algorithm 2. Domino-based scheme.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_TRIANGULAR_SOLVE_ALG3</span></code></p></td>
<td><p>Algorithm 3. Domino-based scheme.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfunitdiagonal-t">
<h4>
<span class="section-number">2.2.3.7. </span>cusolverRfUnitDiagonal_t<a class="headerlink" href="index.html#cusolverrfunitdiagonal-t" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverRfUnitDiagonal_t</span></code> is an enum that indicates whether and where the unit diagonal is stored in the input/output triangular factors in the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupDevice()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupHost()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractSplitFactorsHost()</span></code> routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_UNIT_DIAGONAL_STORED_L</span></code></p></td>
<td><p>Unit diagonal is stored in lower triangular factor. (default)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_UNIT_DIAGONAL_STORED_U</span></code></p></td>
<td><p>Unit diagonal is stored in upper triangular factor.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_UNIT_DIAGONAL_ASSUMED_L</span></code></p></td>
<td><p>Unit diagonal is assumed in lower triangular factor.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_UNIT_DIAGONAL_ASSUMED_U</span></code></p></td>
<td><p>Unit diagonal is assumed in upper triangular factor.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h4>
<span class="section-number">2.2.3.8. </span>cusolverStatus_t<a class="headerlink" href="index.html#id7" title="Permalink to this headline"></a>
</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverStatus_t</span></code> is an enum that indicates success or failure of the cuSolverRF library call. It is returned by all the cuSolver library routines, and it uses the same enumerated values as the sparse and dense Lapack routines.</p>
</section>
</section>
</section>
<section id="cusolver-formats-reference">
<h2>
<span class="section-number">2.3. </span>cuSolver Formats Reference<a class="headerlink" href="index.html#cusolver-formats-reference" title="Permalink to this headline"></a>
</h2>
<section id="index-base-format">
<h3>
<span class="section-number">2.3.1. </span>Index Base Format<a class="headerlink" href="index.html#index-base-format" title="Permalink to this headline"></a>
</h3>
<p>Both one-based and zero-based indexing are supported in cuSolver.</p>
</section>
<section id="vector-dense-format">
<h3>
<span class="section-number">2.3.2. </span>Vector (Dense) Format<a class="headerlink" href="index.html#vector-dense-format" title="Permalink to this headline"></a>
</h3>
<p>The vectors are assumed to be stored linearly in memory. For example, the vector</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(x = \begin{pmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{n} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>is represented as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{pmatrix}
x_{1} &amp; x_{2} &amp; \ldots &amp; x_{n} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="matrix-dense-format">
<h3>
<span class="section-number">2.3.3. </span>Matrix (Dense) Format<a class="headerlink" href="index.html#matrix-dense-format" title="Permalink to this headline"></a>
</h3>
<p>The dense matrices are assumed to be stored in column-major order in memory. The sub-matrix can be accessed using the leading dimension of the original matrix. For example, the <code class="docutils literal notranslate"><span class="pre">m*n</span></code> (sub-)matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{pmatrix}
a_{1,1} &amp; \ldots &amp; a_{1,n} \\
a_{2,1} &amp; \ldots &amp; a_{2,n} \\
\vdots &amp; &amp; \\
a_{m,1} &amp; \ldots &amp; a_{m,n} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>is represented as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{pmatrix}
a_{1,1} &amp; \ldots &amp; a_{1,n} \\
a_{2,1} &amp; \ldots &amp; a_{2,n} \\
\vdots &amp; \ddots &amp; \vdots \\
a_{m,1} &amp; \ldots &amp; a_{m,n} \\
\vdots &amp; \ddots &amp; \vdots \\
a_{{lda},1} &amp; \ldots &amp; a_{{lda},n} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>with its elements arranged linearly in memory as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{pmatrix}
a_{1,1} &amp; a_{2,1} &amp; \ldots &amp; a_{m,1} &amp; \ldots &amp; a_{{lda},1} &amp; \ldots &amp; a_{1,n} &amp; a_{2,n} &amp; \ldots &amp; a_{m,n} &amp; \ldots &amp; a_{{lda},n} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">lda</span></code> ≥ <code class="docutils literal notranslate"><span class="pre">m</span></code> is the leading dimension of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
</section>
<section id="matrix-csr-format">
<h3>
<span class="section-number">2.3.4. </span>Matrix (CSR) Format<a class="headerlink" href="index.html#matrix-csr-format" title="Permalink to this headline"></a>
</h3>
<p>In CSR format the matrix is represented by the following parameters:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Size</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int)</span></code></p></td>
<td></td>
<td><p>The number of rows (and columns) in the matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int)</span></code></p></td>
<td></td>
<td><p>The number of non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int</span> <span class="pre">*)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">n+1</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColInd</span></code> and <code class="docutils literal notranslate"><span class="pre">csrVal</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColInd</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int</span> <span class="pre">*)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. <strong>It is assumed that this array is sorted by row and by column within each row.</strong></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrVal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(S|D|C|Z)*</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. <strong>It is assumed that this array is sorted by row and by column within each row.</strong></p></td>
</tr>
</tbody>
</table>
<p>Note that in our CSR format, sparse matrices are assumed to be stored in row-major order, in other words, the index arrays are first sorted by row indices and then within each row by column indices. Also it is assumed that each pair of row and column indices appears only once.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">4x4</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{1.0} &amp; {3.0} &amp; {0.0} &amp; {0.0} \\
{0.0} &amp; {4.0} &amp; {6.0} &amp; {0.0} \\
{2.0} &amp; {5.0} &amp; {7.0} &amp; {8.0} \\
{0.0} &amp; {0.0} &amp; {0.0} &amp; {9.0} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>is represented as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({csrRowPtr} = \begin{pmatrix}
0 &amp; 2 &amp; 4 &amp; 8 &amp; 9 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({csrColInd} = \begin{pmatrix}
0 &amp; 1 &amp; 1 &amp; 2 &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 3 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({csrVal} = \begin{pmatrix}
1.0 &amp; 3.0 &amp; 4.0 &amp; 6.0 &amp; 2.0 &amp; 5.0 &amp; 7.0 &amp; 8.0 &amp; 9.0 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="matrix-csc-format">
<h3>
<span class="section-number">2.3.5. </span>Matrix (CSC) Format<a class="headerlink" href="index.html#matrix-csc-format" title="Permalink to this headline"></a>
</h3>
<p>In CSC format the matrix is represented by the following parameters:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Size</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int)</span></code></p></td>
<td></td>
<td><p>The number of rows (and columns) in the matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int)</span></code></p></td>
<td></td>
<td><p>The number of non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cscColPtr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int</span> <span class="pre">*)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">n+1</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each column in the arrays <code class="docutils literal notranslate"><span class="pre">cscRowInd</span></code> and <code class="docutils literal notranslate"><span class="pre">cscVal</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cscRowInd</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(int</span> <span class="pre">*)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p>The array of row indices corresponding to the non-zero elements in the matrix. <strong>It is assumed that this array is sorted by column and by row within each column.</strong></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cscVal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(S|D|C|Z)*</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. <strong>It is assumed that this array is sorted by column and by row within each column.</strong></p></td>
</tr>
</tbody>
</table>
<p>Note that in our CSC format, sparse matrices are assumed to be stored in column-major order, in other words, the index arrays are first sorted by column indices and then within each column by row indices. Also it is assumed that each pair of row and column indices appears only once.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">4x4</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{1.0} &amp; {3.0} &amp; {0.0} &amp; {0.0} \\
{0.0} &amp; {4.0} &amp; {6.0} &amp; {0.0} \\
{2.0} &amp; {5.0} &amp; {7.0} &amp; {8.0} \\
{0.0} &amp; {0.0} &amp; {0.0} &amp; {9.0} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>is represented as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({cscColPtr} = \begin{pmatrix}
0 &amp; 2 &amp; 5 &amp; 7 &amp; 9 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({cscRowInd} = \begin{pmatrix}
0 &amp; 2 &amp; 0 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 2 &amp; 3 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({cscVal} = \begin{pmatrix}
1.0 &amp; 2.0 &amp; 3.0 &amp; 4.0 &amp; 5.0 &amp; 6.0 &amp; 7.0 &amp; 8.0 &amp; 9.0 \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cusolverdn-dense-lapack-function-reference">
<h2>
<span class="section-number">2.4. </span>cuSolverDN: dense LAPACK Function Reference<a class="headerlink" href="index.html#cusolverdn-dense-lapack-function-reference" title="Permalink to this headline"></a>
</h2>
<p>This section describes the API of cuSolverDN, which provides a subset of dense LAPACK functions.</p>
<section id="cusolverdn-helper-function-reference">
<h3>
<span class="section-number">2.4.1. </span>cuSolverDN Helper Function Reference<a class="headerlink" href="index.html#cusolverdn-helper-function-reference" title="Permalink to this headline"></a>
</h3>
<p>The cuSolverDN helper functions are described in this section.</p>
<section id="cusolverdncreate">
<span id="id8"></span><h4>
<span class="section-number">2.4.1.1. </span>cusolverDnCreate()<a class="headerlink" href="index.html#cusolverdncreate" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCreate</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function initializes the cuSolverDN library and creates a handle on the cuSolverDN context. It must be called before any other cuSolverDN API function is invoked. It allocates hardware resources necessary for accessing the GPU.
This function allocates 4 MiB or 32 MiB of memory (for GPUs with Compute Capability of 9.0 and higher), which will be used as the cuBLAS workspace for the first user-defined stream on which <a class="reference internal" href="index.html#cusolverdnsetstream"><span class="std std-ref">cusolverDnSetStream()</span></a> is called.
For the default stream and in all the other cases, cuBLAS will manage its own workspace.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the handle to the cuSolverDN context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The initialization succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The CUDA Runtime initialization failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdndestroy">
<h4>
<span class="section-number">2.4.1.2. </span>cusolverDnDestroy()<a class="headerlink" href="index.html#cusolverdndestroy" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDestroy</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function releases CPU-side resources used by the cuSolverDN library.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The shutdown succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnsetstream">
<span id="id9"></span><h4>
<span class="section-number">2.4.1.3. </span>cusolverDnSetStream()<a class="headerlink" href="index.html#cusolverdnsetstream" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnSetStream</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="n">streamId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the stream to be used by the cuSolverDN library to execute its routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">streamId</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The stream to be used by the library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The stream was set successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngetstream">
<h4>
<span class="section-number">2.4.1.4. </span>cusolverDnGetStream()<a class="headerlink" href="index.html#cusolverdngetstream" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGetStream</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="o">*</span><span class="n">streamId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function queries the stream to be used by the cuSolverDN library to execute its routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">streamId</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The stream which is used by <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The stream was set successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnloggersetcallback">
<span id="id10"></span><h4>
<span class="section-number">2.4.1.5. </span>cusolverDnLoggerSetCallback()<a class="headerlink" href="index.html#cusolverdnloggersetcallback" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerSetCallback</span><span class="p">(</span><span class="n">cusolverDnLoggerCallback_t</span><span class="w"> </span><span class="n">callback</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the logging callback function.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">callback</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to a callback function. See <a class="reference internal" href="index.html#cusolverdnloggercallback-t"><span class="std std-ref">cusolverDnLoggerCallback_t</span></a>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If the callback function was successfully set.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnloggersetfile">
<span id="id11"></span><h4>
<span class="section-number">2.4.1.6. </span>cusolverDnLoggerSetFile()<a class="headerlink" href="index.html#cusolverdnloggersetfile" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerSetFile</span><span class="p">(</span><span class="kt">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the logging output file. Note: once registered using this function call, the provided file handle must not be closed unless the function is called again to switch to a different file handle.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">file</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to an open file. File should have write permission.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If logging file was successfully set.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnloggeropenfile">
<span id="id12"></span><h4>
<span class="section-number">2.4.1.7. </span>cusolverDnLoggerOpenFile()<a class="headerlink" href="index.html#cusolverdnloggeropenfile" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerOpenFile</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">logFile</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function opens a logging output file in the given path.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">logFile</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Path of the logging output file.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 44%">
<col style="width: 56%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If the logging file was successfully opened.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnloggersetlevel">
<span id="id13"></span><h4>
<span class="section-number">2.4.1.8. </span>cusolverDnLoggerSetLevel()<a class="headerlink" href="index.html#cusolverdnloggersetlevel" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerSetLevel</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">level</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the value of the logging level.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">level</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of the logging level. See <a class="reference internal" href="index.html#cusolverdn-logging"><span class="std std-ref">cuSOLVERDn Logging</span></a>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>If the value was not a valid logging level. See <a class="reference internal" href="index.html#cusolverdn-logging"><span class="std std-ref">cuSOLVERDn Logging</span></a>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If the logging level was successfully set.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnloggersetmask">
<span id="id14"></span><h4>
<span class="section-number">2.4.1.9. </span>cusolverDnLoggerSetMask()<a class="headerlink" href="index.html#cusolverdnloggersetmask" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerSetMask</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">mask</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the value of the logging mask.</p>
<p><strong>Parameters</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of the logging mask. See <a class="reference internal" href="index.html#cusolverdn-logging"><span class="std std-ref">cuSOLVERDn Logging</span></a>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 46%">
<col style="width: 54%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If the logging mask was successfully set.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnloggerforcedisable">
<span id="id15"></span><h4>
<span class="section-number">2.4.1.10. </span>cusolverDnLoggerForceDisable()<a class="headerlink" href="index.html#cusolverdnloggerforcedisable" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnLoggerForceDisable</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>This function disables logging for the entire run.</p>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>If logging was successfully disabled.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="index.html#id5"><span class="std std-ref">cusolverStatus_t</span></a> for a complete list of valid return codes.</p>
</section>
<section id="cusolverdnsetdeterministicmode">
<h4>
<span class="section-number">2.4.1.11. </span>cusolverDnSetDeterministicMode()<a class="headerlink" href="index.html#cusolverdnsetdeterministicmode" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnSetDeterministicMode</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cusolverDeterministicMode_t</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the deterministic mode of all cuSolverDN functions for <code class="docutils literal notranslate"><span class="pre">handle</span></code>. For improved performance,
non-deterministic results can be allowed. Affected functions are <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t&gt;geqrf()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t&gt;syevd()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t&gt;syevdx()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t&gt;gesvd()</span></code> (if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">n</span></code>), <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t&gt;gesvdj()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd()</span></code> (if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">n</span></code>), <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp()</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The deterministic mode to be used with <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The mode was set successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal error occurred.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngetdeterministicmode">
<h4>
<span class="section-number">2.4.1.12. </span>cusolverDnGetDeterministicMode()<a class="headerlink" href="index.html#cusolverdngetdeterministicmode" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGetDeterministicMode</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cusolverDeterministicMode_t</span><span class="o">*</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function queries the deterministic mode which is set for <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The deterministic mode of <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The mode was set successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code> is a <code class="docutils literal notranslate"><span class="pre">NULL</span></code> pointer.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdncreatesyevjinfo">
<h4>
<span class="section-number">2.4.1.13. </span>cusolverDnCreateSyevjInfo()<a class="headerlink" href="index.html#cusolverdncreatesyevjinfo" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCreateSyevjInfo</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function creates and initializes the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>, <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> and <code class="docutils literal notranslate"><span class="pre">sygvj</span></code> to default values.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The structure was initialized successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdndestroysyevjinfo">
<h4>
<span class="section-number">2.4.1.14. </span>cusolverDnDestroySyevjInfo()<a class="headerlink" href="index.html#cusolverdndestroysyevjinfo" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDestroySyevjInfo</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function destroys and releases any memory required by the structure.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 22%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The resources were released successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevjsettolerance">
<h4>
<span class="section-number">2.4.1.15. </span>cusolverDnXsyevjSetTolerance()<a class="headerlink" href="index.html#cusolverdnxsyevjsettolerance" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevjSetTolerance</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">tolerance</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function configures tolerance of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Accuracy of numerical eigenvalues.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevjsetmaxsweeps">
<h4>
<span class="section-number">2.4.1.16. </span>cusolverDnXsyevjSetMaxSweeps()<a class="headerlink" href="index.html#cusolverdnxsyevjsetmaxsweeps" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevjSetMaxSweeps</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">max_sweeps</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function configures maximum number of sweeps in <code class="docutils literal notranslate"><span class="pre">syevj</span></code>. The default value is 100.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">max_sweeps</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Maximum number of sweeps.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevjsetsorteig">
<h4>
<span class="section-number">2.4.1.17. </span>cusolverDnXsyevjSetSortEig()<a class="headerlink" href="index.html#cusolverdnxsyevjsetsorteig" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevjSetSortEig</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sort_eig</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">sort_eig</span></code> is zero, the eigenvalues are not sorted. This function only works for <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code>. <code class="docutils literal notranslate"><span class="pre">syevj</span></code> and <code class="docutils literal notranslate"><span class="pre">sygvj</span></code> always sort eigenvalues in ascending order. By default, eigenvalues are always sorted in ascending order.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of syevj.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">sort_eig</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">sort_eig</span></code> is zero, the eigenvalues are not sorted.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevjgetresidual">
<h4>
<span class="section-number">2.4.1.18. </span>cusolverDnXsyevjGetResidual()<a class="headerlink" href="index.html#cusolverdnxsyevjgetresidual" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevjGetResidual</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">residual</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function reports residual of <code class="docutils literal notranslate"><span class="pre">syevj</span></code> or <code class="docutils literal notranslate"><span class="pre">sygvj</span></code>. It does not support <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code>. If the user calls this function after <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code>, the error <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code> is returned.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">residual</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Residual of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 47%">
<col style="width: 53%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td><p>Does not support batched version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevjgetsweeps">
<h4>
<span class="section-number">2.4.1.19. </span>cusolverDnXsyevjGetSweeps()<a class="headerlink" href="index.html#cusolverdnxsyevjgetsweeps" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevjGetSweeps</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">executed_sweeps</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function reports number of executed sweeps of <code class="docutils literal notranslate"><span class="pre">syevj</span></code> or <code class="docutils literal notranslate"><span class="pre">sygvj</span></code>. It does not support <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code>. If the user calls this function after <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code>, the error <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code> is returned.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">executed_sweeps</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Number of executed sweeps.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 47%">
<col style="width: 53%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td><p>Does not support batched version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdncreategesvdjinfo">
<h4>
<span class="section-number">2.4.1.20. </span>cusolverDnCreateGesvdjInfo()<a class="headerlink" href="index.html#cusolverdncreategesvdjinfo" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCreateGesvdjInfo</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function creates and initializes the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> and <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> to default values.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The structure was initialized successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdndestroygesvdjinfo">
<h4>
<span class="section-number">2.4.1.21. </span>cusolverDnDestroyGesvdjInfo()<a class="headerlink" href="index.html#cusolverdndestroygesvdjinfo" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDestroyGesvdjInfo</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function destroys and releases any memory required by the structure.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The resources were released successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdjsettolerance">
<h4>
<span class="section-number">2.4.1.22. </span>cusolverDnXgesvdjSetTolerance()<a class="headerlink" href="index.html#cusolverdnxgesvdjsettolerance" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdjSetTolerance</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">tolerance</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function configures tolerance of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Accuracy of numerical singular values.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdjsetmaxsweeps">
<h4>
<span class="section-number">2.4.1.23. </span>cusolverDnXgesvdjSetMaxSweeps()<a class="headerlink" href="index.html#cusolverdnxgesvdjsetmaxsweeps" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdjSetMaxSweeps</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">max_sweeps</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function configures the maximum number of sweeps in <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>. The default value is 100.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">max_sweeps</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Maximum number of sweeps.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdjsetsorteig">
<h4>
<span class="section-number">2.4.1.24. </span>cusolverDnXgesvdjSetSortEig()<a class="headerlink" href="index.html#cusolverdnxgesvdjsetsorteig" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdjSetSortEig</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sort_svd</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">sort_svd</span></code> is zero, the singular values are not sorted. This function only works for <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code>. <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> always sorts singular values in descending order. By default, singular values are always sorted in descending order.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">sort_svd</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">sort_svd</span></code> is zero, the singular values are not sorted.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdjgetresidual">
<h4>
<span class="section-number">2.4.1.25. </span>cusolverDnXgesvdjGetResidual()<a class="headerlink" href="index.html#cusolverdnxgesvdjgetresidual" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdjGetResidual</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">residual</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function reports residual of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>. It does not support <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code>. If the user calls this function after <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code>, the error <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code> is returned.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">residual</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Residual of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 47%">
<col style="width: 53%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td><p>Does not support batched version</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdjgetsweeps">
<h4>
<span class="section-number">2.4.1.26. </span>cusolverDnXgesvdjGetSweeps()<a class="headerlink" href="index.html#cusolverdnxgesvdjgetsweeps" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdjGetSweeps</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">executed_sweeps</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function reports number of executed sweeps of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>. It does not support <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code>. If the user calls this function after <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code>, the error <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code> is returned.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 23%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">executed_sweeps</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Number of executed sweeps.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 47%">
<col style="width: 53%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td><p>Does not support batched version</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamscreate">
<h4>
<span class="section-number">2.4.1.27. </span>cusolverDnIRSParamsCreate()<a class="headerlink" href="index.html#cusolverdnirsparamscreate" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsCreate</span><span class="p">(</span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function creates and initializes the structure of parameters for an IRS solver such as the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> or the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code> functions to default values. The params structure created by this function can be used by one or more call to the same or to a different IRS solver. Note that in CUDA 10.2, the behavior was different and a new <code class="docutils literal notranslate"><span class="pre">params</span></code> structure was needed to be created per each call to an IRS solver. Also note that the user can also change configurations of the params and then call a new IRS instance, but be careful that the previous call was done because any change to the configuration before the previous call was done could affect it.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Pointer to the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The structure was created and initialized successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamsdestroy">
<h4>
<span class="section-number">2.4.1.28. </span>cusolverDnIRSParamsDestroy()<a class="headerlink" href="index.html#cusolverdnirsparamsdestroy" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsDestroy</span><span class="p">(</span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function destroys and releases any memory required by the Params structure.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The resources were released successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_DESTROYED</span></code></p></td>
<td><p>Not all the <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure associated with this <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure have been destroyed yet.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetsolverprecisions">
<h4>
<span class="section-number">2.4.1.29. </span>cusolverDnIRSParamsSetSolverPrecisions()<a class="headerlink" href="index.html#cusolverdnirsparamssetsolverprecisions" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsSetSolverPrecisions</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverPrecType_t</span><span class="w"> </span><span class="n">solver_main_precision</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverPrecType_t</span><span class="w"> </span><span class="n">solver_lowest_precision</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets both the main and the lowest precision for the Iterative Refinement Solver (IRS). By main precision, we mean the precision of the Input and Output datatype. By lowest precision, we mean the solver is allowed to use as lowest computational precision during the LU factorization process. Note that the user has to set both the main and lowest precision before the first call to the IRS solver because they are NOT set by default with the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure creation, as it depends on the Input Output data type and user request. It is a wrapper to both <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverMainPrecision()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverLowestPrecision()</span></code>. All possible combinations of main/lowest precision are described in the table below. Usually the lowest precision defines the speedup that can be achieved. The ratio of the performance of the lowest precision over the main precision (e.g., Inputs/Outputs datatype) define the upper bound of the speedup that could be obtained. More precisely, it depends on many factors, but for large matrices sizes, it is the ratio of the matrix-matrix rank-k product (e.g., GEMM where K is 256 and M=N=size of the matrix) that define the possible speedup. For instance, if the inout precision is real double precision CUSOLVER_R_64F and the lowest precision is CUSOLVER_R_32F, then we can expect a speedup of at most 2X for large problem sizes. If the lowest precision was CUSOLVER_R_16F, then we can expect 3X-4X. A reasonable strategy should take the number of right-hand sides, the size of the matrix as well as the convergence rate into account.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 74%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">solver_main_precision</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Allowed Inputs/Outputs datatype (for example CUSOLVER_R_FP64 for a real double precision data). See the table below for the supported precisions.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">solver_lowest_precision</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Allowed lowest compute type (for example CUSOLVER_R_16F for half precision computation). See the table below for the supported precisions.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default" id="id22">
<caption>
<span class="caption-text">Table 2. <strong>Supported Inputs/Outputs data type and lower precision for the IRS solver</strong></span><a class="headerlink" href="index.html#id22" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Inputs/Outputs Data Type (e.g., main precision)</strong></p></th>
<th class="head"><p><strong>Supported values for the lowest precision</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F,</span> <span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F,</span> <span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetsolvermainprecision">
<h4>
<span class="section-number">2.4.1.30. </span>cusolverDnIRSParamsSetSolverMainPrecision()<a class="headerlink" href="index.html#cusolverdnirsparamssetsolvermainprecision" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsSetSolverMainPrecision</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverPrecType_t</span><span class="w"> </span><span class="n">solver_main_precision</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the main precision for the Iterative Refinement Solver (IRS). By main precision, we mean, the type of the Input and Output data. Note that the user has to set both the main and lowest precision before a first call to the IRS solver because they are NOT set by default with the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure creation, as it depends on the Input Output data type and user request. user can set it by either calling this function or by calling <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverPrecisions()</span></code> which set both the main and the lowest precision together. All possible combinations of main/lowest precision are described in the <a class="reference external" href="index.html#cusolverDnIRSParamsSetSolverPrecisions__table-supported-inout">table</a> in the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverPrecisions()</span></code> section above.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">solver_main_precision</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Allowed Inputs/Outputs datatype (for example CUSOLVER_R_FP64 for a real double precision data). See the table in the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverPrecisions()</span></code> section above for the supported precisions.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetsolverlowestprecision">
<h4>
<span class="section-number">2.4.1.31. </span>cusolverDnIRSParamsSetSolverLowestPrecision()<a class="headerlink" href="index.html#cusolverdnirsparamssetsolverlowestprecision" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsSetSolverLowestPrecision</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverPrecType_t</span><span class="w"> </span><span class="n">lowest_precision_type</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the lowest precision that will be used by Iterative Refinement Solver. By lowest precision, we mean the solver is allowed to use as lowest computational precision during the LU factorization process. Note that the user has to set both the main and lowest precision before a first call to the IRS solver because they are NOT set by default with the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure creation, as it depends on the Input Output data type and user request. Usually the lowest precision defines the speedup that can be achieved. The ratio of the performance of the lowest precision over the main precision (e.g., Inputs/Outputs datatype) define somehow the upper bound of the speedup that could be obtained. More precisely, it depends on many factors, but for large matrices sizes, it is the ratio of the matrix-matrix rank-k product (e.g., GEMM where K is 256 and M=N=size of the matrix) that define the possible speedup. For instance, if the inout precision is real double precision CUSOLVER_R_64F and the lowest precision is CUSOLVER_R_32F, then we can expect a speedup of at most 2X for large problem sizes. If the lowest precision was CUSOLVER_R_16F, then we can expect 3X-4X. A reasonable strategy should take the number of right-hand sides, the size of the matrix as well as the convergence rate into account.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lowest_precision_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Allowed lowest compute type (for example CUSOLVER_R_16F for half precision computation). See the table in the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetSolverPrecisions()</span></code> section above for the supported precisions.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 55%">
<col style="width: 45%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The Params structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetrefinementsolver">
<h4>
<span class="section-number">2.4.1.32. </span>cusolverDnIRSParamsSetRefinementSolver()<a class="headerlink" href="index.html#cusolverdnirsparamssetrefinementsolver" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsSetRefinementSolver</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverIRSRefinement_t</span><span class="w"> </span><span class="n">solver</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the refinement solver to be used in the Iterative Refinement Solver functions such as the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> or the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code> functions. Note that the user has to set the refinement algorithm before a first call to the IRS solver because it is NOT set by default with the creating of params. Details about values that can be set to and theirs meaning are described in the table below.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span></code><code class="docutils literal notranslate"><span class="pre">Params</span></code> structure</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">solver</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Type of the refinement solver to be used by the IRS solver such as <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> or <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 92%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_NOT_SET</span></code></p></td>
<td><p>Solver is not set, this value is what is set when creating the params structure. IRS solver will return an error.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_NONE</span></code></p></td>
<td><p>No refinement solver; the IRS solver performs a factorization followed by a solve without any refinement. For example, if the IRS solver was <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code>, this is equivalent to a Xgesv routine without refinement and where the factorization is carried out in the lowest precision. If for example the main precision was CUSOLVER_R_64F and the lowest was CUSOLVER_R_64F as well, then this is equivalent to a call to <code class="docutils literal notranslate"><span class="pre">cusolverDnDgesv()</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL</span></code></p></td>
<td><p>Classical iterative refinement solver. Similar to the one used in LAPACK routines.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_GMRES</span></code></p></td>
<td><p>GMRES (Generalized Minimal Residual) based iterative refinement solver. In recent study, the GMRES method has drawn the scientific community attention for its ability to be used as refinement solver that outperforms the classical iterative refinement method. Based on our experimentation, we recommend this setting.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL_GMRES</span></code></p></td>
<td><p>Classical iterative refinement solver that uses the GMRES (Generalized Minimal Residual) internally to solve the correction equation at each iteration. We call the <em>classical refinement iteration</em> the outer iteration while the <em>GMRES</em> is called inner iteration. Note that if the tolerance of the inner GMRES is set very low, let say to machine precision, then the outer <em>classical refinement iteration</em> will performs only one iteration and thus this option will behaves like CUSOLVER_IRS_REFINE_GMRES.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_GMRES_GMRES</span></code></p></td>
<td><p>Similar to <code class="docutils literal notranslate"><span class="pre">CUSOLVER_IRS_REFINE_CLASSICAL_GMRES</span></code> which consists of classical refinement process that uses GMRES to solve the inner correction system, here it is a GMRES (Generalized Minimal Residual) based iterative refinement solver that uses another GMRES internally to solve the preconditioned system.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssettol">
<h4>
<span class="section-number">2.4.1.33. </span>cusolverDnIRSParamsSetTol()<a class="headerlink" href="index.html#cusolverdnirsparamssettol" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsSetTol</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the tolerance for the refinement solver. By default it is such that all the RHS satisfy:</p>
<p>    <code class="docutils literal notranslate"><span class="pre">RNRM</span> <span class="pre">&lt;</span> <span class="pre">SQRT(N)*XNRM*ANRM*EPS*BWDMAX</span></code> where</p>
<ul class="simple">
<li><p>RNRM is the infinity-norm of the residual</p></li>
<li><p>XNRM is the infinity-norm of the solution</p></li>
<li><p>ANRM is the infinity-operator-norm of the matrix A</p></li>
<li><p>EPS is the machine epsilon for the Inputs/Outputs datatype that matches LAPACK &lt;X&gt;LAMCH(‘Epsilon’)</p></li>
<li><p>BWDMAX, the value BWDMAX is fixed to 1.0</p></li>
</ul>
<p>The user can use this function to change the tolerance to a lower or higher value. Our goal is to give the user more control such a way he can investigate and control every detail of the IRS solver. Note that the tolerance value is always in <em>real double precision</em> whatever the Inputs/Outputs datatype is.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">val</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Double precision real value to which the refinement tolerance will be set.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssettolinner">
<h4>
<span class="section-number">2.4.1.34. </span>cusolverDnIRSParamsSetTolInner()<a class="headerlink" href="index.html#cusolverdnirsparamssettolinner" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsSetTolInner</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the tolerance for the inner refinement solver when the refinement solver consists of two-levels solver (e.g., CUSOLVER_IRS_REFINE_CLASSICAL_GMRES or CUSOLVER_IRS_REFINE_GMRES_GMRES cases). It is not referenced in case of one level refinement solver such as CUSOLVER_IRS_REFINE_CLASSICAL or CUSOLVER_IRS_REFINE_GMRES. It is set to 1e-4 by default. This function set the tolerance for the inner solver (e.g. the inner GMRES). For example, if the Refinement Solver was set to CUSOLVER_IRS_REFINE_CLASSICAL_GMRES, setting this tolerance mean that the inner GMRES solver will converge to that tolerance at each outer iteration of the classical refinement solver. Our goal is to give the user more control such a way he can investigate and control every detail of the IRS solver. Note the, the tolerance value is always in <em>real double precision</em> whatever the Inputs/Outputs datatype is.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">val</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Double precision real value to which the tolerance of the inner refinement solver will be set.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetmaxiters">
<h4>
<span class="section-number">2.4.1.35. </span>cusolverDnIRSParamsSetMaxIters()<a class="headerlink" href="index.html#cusolverdnirsparamssetmaxiters" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSParamsSetMaxIters</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">max_iters</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the total number of allowed refinement iterations after which the solver will stop. Total means any iteration which means the sum of the outer and the inner iterations (inner is meaningful when two-levels refinement solver is set). Default value is set to 50. Our goal is to give the user more control such a way he can investigate and control every detail of the IRS solver.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">max_iters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Maximum total number of iterations allowed for the refinement solver.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamssetmaxitersinner">
<h4>
<span class="section-number">2.4.1.36. </span>cusolverDnIRSParamsSetMaxItersInner()<a class="headerlink" href="index.html#cusolverdnirsparamssetmaxitersinner" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsSetMaxItersInner</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolver_int_t</span><span class="w"> </span><span class="n">maxiters_inner</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the maximal number of iterations allowed for the inner refinement solver. It is not referenced in case of one level refinement solver such as CUSOLVER_IRS_REFINE_CLASSICAL or CUSOLVER_IRS_REFINE_GMRES. The inner refinement solver will stop after reaching either the inner tolerance or the MaxItersInner value. By default, it is set to 50. Note that this value could not be larger than the MaxIters since MaxIters is the total number of allowed iterations. Note that if the user calls <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetMaxIters</span></code> after calling this function, <code class="docutils literal notranslate"><span class="pre">SetMaxIters</span></code> has priority and will overwrite <code class="docutils literal notranslate"><span class="pre">MaxItersInner</span></code> to the minimum value of <code class="docutils literal notranslate"><span class="pre">(MaxIters,</span> <span class="pre">MaxItersInner)</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">maxiters_inner</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Maximum number of allowed inner iterations for the inner refinement solver. Meaningful when the refinement solver is a two-levels solver such as CUSOLVER_IRS_REFINE_CLASSICAL_GMRES or CUSOLVER_IRS_REFINE_GMRES_GMRES. Value should be less or equal to <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID</span></code></p></td>
<td><p>If the value was larger than <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamsenablefallback">
<h4>
<span class="section-number">2.4.1.37. </span>cusolverDnIRSParamsEnableFallback()<a class="headerlink" href="index.html#cusolverdnirsparamsenablefallback" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsEnableFallback</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function enable the fallback to the main precision in case the Iterative Refinement Solver (IRS) failed to converge. In other term, if the IRS solver failed to converge, the solver will return a no convergence code (e.g., <code class="docutils literal notranslate"><span class="pre">niter</span></code> &lt; 0), but can either return the non-convergent solution as it is (e.g., disable fallback) or can fallback (e.g., enable fallback) to the main precision (which is the precision of the Inputs/Outputs data) and solve the problem from scratch returning the good solution. This is the behavior by default, and it will guarantee that the IRS solver always provide the good solution. This function is provided because we provided <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsDisableFallback</span></code> which allows the user to disable the fallback and thus this function allow the user to re-enable it.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamsdisablefallback">
<h4>
<span class="section-number">2.4.1.38. </span>cusolverDnIRSParamsDisableFallback()<a class="headerlink" href="index.html#cusolverdnirsparamsdisablefallback" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsDisableFallback</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function disables the fallback to the main precision in case the Iterative Refinement Solver (IRS) failed to converge. In other term, if the IRS solver failed to converge, the solver will return a no convergence code (e.g., <code class="docutils literal notranslate"><span class="pre">niter</span></code> &lt; 0), but can either return the non-convergent solution as it is (e.g., disable fallback) or can fallback (e.g., enable fallback) to the main precision (which is the precision of the Inputs/Outputs data) and solve the problem from scratch returning the good solution. This function disables the fallback and the returned solution is whatever the refinement solver was able to reach before it returns. Disabling fallback does not guarantee that the solution is the good one. However, if users want to keep getting the solution of the lower precision in case the IRS did not converge after certain number of iterations, they need to disable the fallback. The user can re-enable it by calling <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsEnableFallback</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsparamsgetmaxiters">
<h4>
<span class="section-number">2.4.1.39. </span>cusolverDnIRSParamsGetMaxIters()<a class="headerlink" href="index.html#cusolverdnirsparamsgetmaxiters" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSParamsGetMaxIters</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolver_int_t</span><span class="w"> </span><span class="o">*</span><span class="n">maxiters</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function returns the current setting in the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure for the maximal allowed number of iterations (e.g., either the default <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code>, or the one set by the user in case he set it using <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsSetMaxIters</span></code>). Note that this function returns the current setting in the <code class="docutils literal notranslate"><span class="pre">params</span></code> configuration and not to be confused with the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetMaxIters</span></code> which return the maximal allowed number of iterations for a particular call to an IRS solver. To be clearer, the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure can be used for many calls to an IRS solver. A user can change the allowed <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code> between calls while the <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure in <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetMaxIters</span></code> contains information about a particular call and cannot be reused for different calls, and thus, <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetMaxIters</span></code> returns the allowed <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code> for that call.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParams_t</span> <span class="pre">Params</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">maxiters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The maximal number of iterations that is currently set.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Params</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfoscreate">
<h4>
<span class="section-number">2.4.1.40. </span>cusolverDnIRSInfosCreate()<a class="headerlink" href="index.html#cusolverdnirsinfoscreate" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnIRSInfosCreate</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSInfos_t</span><span class="o">*</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function creates and initializes the <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure that will hold the refinement information of an Iterative Refinement Solver (IRS) call. Such information includes the total number of iterations that was needed to converge (<code class="docutils literal notranslate"><span class="pre">Niters</span></code>), the outer number of iterations (meaningful when two-levels preconditioner such as CUSOLVER_IRS_REFINE_CLASSICAL_GMRES is used ), the maximal number of iterations that was allowed for that call, and a pointer to the matrix of the convergence history residual norms. The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure needs to be created before a call to an IRS solver. The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure is valid for only one call to an IRS solver, since it holds info about that solve and thus each solve will requires its own <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Pointer to the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The structure was initialized successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosdestroy">
<h4>
<span class="section-number">2.4.1.41. </span>cusolverDnIRSInfosDestroy()<a class="headerlink" href="index.html#cusolverdnirsinfosdestroy" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSInfosDestroy</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function destroys and releases any memory required by the <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure. This function destroys all the information (e.g., Niters performed, OuterNiters performed, residual history etc.) about a solver call; thus, this function should only be called after the user is finished with the information.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The resources were released successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosgetmaxiters">
<h4>
<span class="section-number">2.4.1.42. </span>cusolverDnIRSInfosGetMaxIters()<a class="headerlink" href="index.html#cusolverdnirsinfosgetmaxiters" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSInfosGetMaxIters</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolver_int_t</span><span class="w"> </span><span class="o">*</span><span class="n">maxiters</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function returns the maximal allowed number of iterations that was set for the corresponding call to the IRS solver. Note that this function returns the setting that was set when that call happened and is not to be confused with the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsGetMaxIters</span></code> which returns the current setting in the <code class="docutils literal notranslate"><span class="pre">params</span></code> configuration structure. To be clearer, the <code class="docutils literal notranslate"><span class="pre">params</span></code> structure can be used for many calls to an IRS solver. A user can change the allowed <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code> between calls while the <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure in <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetMaxIters</span></code> contains information about a particular call and cannot be reused for different calls, thus <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetMaxIters</span></code> returns the allowed <code class="docutils literal notranslate"><span class="pre">MaxIters</span></code> for that call.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">maxiters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The maximal number of iterations that is currently set.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosgetniters">
<h4>
<span class="section-number">2.4.1.43. </span>cusolverDnIRSInfosGetNiters()<a class="headerlink" href="index.html#cusolverdnirsinfosgetniters" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnIRSInfosGetNiters</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolver_int_t</span><span class="w"> </span><span class="o">*</span><span class="n">niters</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function returns the total number of iterations performed by the IRS solver. If it was negative, it means that the IRS solver did not converge and if the user did not disable the fallback to full precision, then the fallback to a full precision solution happened and solution is good. Please refer to the description of negative <code class="docutils literal notranslate"><span class="pre">niters</span></code> values in the corresponding IRS linear solver functions such as <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesv()</span></code> or <code class="docutils literal notranslate"><span class="pre">cusolverDnXgels()</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The total number of iterations performed by the IRS solver.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosgetouterniters">
<h4>
<span class="section-number">2.4.1.44. </span>cusolverDnIRSInfosGetOuterNiters()<a class="headerlink" href="index.html#cusolverdnirsinfosgetouterniters" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnIRSInfosGetOuterNiters</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">cusolver_int_t</span><span class="w"> </span><span class="o">*</span><span class="n">outer_niters</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function returns the number of iterations performed by the outer refinement loop of the IRS solver. When the refinement solver consists of a one-level solver such as CUSOLVER_IRS_REFINE_CLASSICAL or CUSOLVER_IRS_REFINE_GMRES, it is the same as <code class="docutils literal notranslate"><span class="pre">Niters</span></code>. When the refinement solver consists of a two-levels solver such as CUSOLVER_IRS_REFINE_CLASSICAL_GMRES or CUSOLVER_IRS_REFINE_GMRES_GMRES, it is the number of iterations of the outer loop. Refer to the description of the <code class="docutils literal notranslate"><span class="pre">cusolverIRSRefinement_t</span></code> for more details.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">outer_niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The number of iterations of the outer refinement loop of the IRS solver.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosrequestresidual">
<h4>
<span class="section-number">2.4.1.45. </span>cusolverDnIRSInfosRequestResidual()<a class="headerlink" href="index.html#cusolverdnirsinfosrequestresidual" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnIRSInfosRequestResidual</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function tells the IRS solver to store the convergence history (residual norms) of the refinement phase in a matrix that can be accessed via a pointer returned by the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosGetResidualHistory()</span></code> function.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 53%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsinfosgetresidualhistory">
<h4>
<span class="section-number">2.4.1.46. </span>cusolverDnIRSInfosGetResidualHistory()<a class="headerlink" href="index.html#cusolverdnirsinfosgetresidualhistory" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSInfosGetResidualHistory</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnIRSInfos_t</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">residual_history</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>If the user called <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosRequestResidual()</span></code> before the call to the IRS function, then the IRS solver will store the convergence history (residual norms) of the refinement phase in a matrix that can be accessed via a pointer returned by this function. The datatype of the residual norms depends on the input and output data type. If the Inputs/Outputs datatype is double precision real or complex (CUSOLVER_R_FP64 or CUSOLVER_C_FP64), this residual will be of type real double precision (FP64) <em>double</em>, otherwise if the Inputs/Outputs datatype is single precision real or complex (CUSOLVER_R_FP32 or CUSOLVER_C_FP32), this residual will be real single precision FP32 <em>float</em>.</p>
<p>The residual history matrix consists of two columns (even for the multiple right-hand side case NRHS) of <code class="docutils literal notranslate"><span class="pre">MaxIters+1</span></code> row, thus a matrix of size (<code class="docutils literal notranslate"><span class="pre">MaxIters+1,2</span></code>). Only the first <code class="docutils literal notranslate"><span class="pre">OuterNiters+1</span></code> rows contains the residual norms the other (e.g., OuterNiters+2:Maxiters+1) are garbage. On the first column, each row <em>“i”</em> specify the total number of iterations happened till this outer iteration <em>“i”</em> and on the second columns the residual norm corresponding to this outer iteration <em>“i”</em>. Thus, the first row (e.g., outer iteration <em>“0”</em>) consists of the initial residual (e.g., the residual before the refinement loop start) then the consecutive rows are the residual obtained at each outer iteration of the refinement loop. Note, it only consists of the history of the outer loop.</p>
<p>If the refinement solver was CUSOLVER_IRS_REFINE_CLASSICAL or CUSOLVER_IRS_REFINE_GMRES, then OuterNiters=Niters (Niters is the total number of iterations performed) and there is Niters+1 rows of norms that correspond to the Niters outer iterations.</p>
<p>If the refinement solver was CUSOLVER_IRS_REFINE_CLASSICAL_GMRES or CUSOLVER_IRS_REFINE_GMRES_GMRES, then OuterNiters &lt;= Niters corresponds to the outer iterations performed by the outer refinement loop. Thus, there is OuterNiters+1 residual norms where row <em>“i”</em> correspond to the outer iteration <em>“i”</em> and the first column specify the total number of iterations (outer and inner) that were performed till this step the second columns correspond to the residual norm at this step.</p>
<p>For example, let’s say the user specifies CUSOLVER_IRS_REFINE_CLASSICAL_GMRES as a refinement solver and say it needed 3 outer iterations to converge and 4,3,3 inner iterations at each outer, respectively. This consists of 10 total iterations. Row 0 corresponds to the first residual before the refinement start, so it has 0 in its first column. On row 1 which corresponds to the outer iteration 1, it will be 4 (4 is the total number of iterations that were performed till now), on row 2 it will be 7, and on row 3 it will be 10.</p>
<p>In summary, let’s define <code class="docutils literal notranslate"><span class="pre">ldh=Maxiters+1</span></code>, the leading dimension of the residual matrix. then <code class="docutils literal notranslate"><span class="pre">residual_history[i]</span></code> shows the total number of iterations performed at the outer iteration <em>“i”</em> and <code class="docutils literal notranslate"><span class="pre">residual_history[i+ldh]</span></code> corresponds to the norm of the residual at this outer iteration.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfos_t</span> <span class="pre">Infos</span></code> structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">residual_history</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Returns a void pointer to the matrix of the convergence history residual norms. See the description above for the relation between the residual norm datatype and the inout datatype.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 33%">
<col style="width: 67%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Infos</span></code> structure was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>This function was called without calling <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosRequestResidual()</span></code> in advance.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdncreateparams">
<h4>
<span class="section-number">2.4.1.47. </span>cusolverDnCreateParams()<a class="headerlink" href="index.html#cusolverdncreateparams" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCreateParams</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function creates and initializes the structure of <code class="docutils literal notranslate"><span class="pre">64-bit</span> <span class="pre">API</span></code> to default values.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">64-bit</span> <span class="pre">API</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The structure was initialized successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdndestroyparams">
<h4>
<span class="section-number">2.4.1.48. </span>cusolverDnDestroyParams()<a class="headerlink" href="index.html#cusolverdndestroyparams" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDestroyParams</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function destroys and releases any memory required by the structure.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The structure of <code class="docutils literal notranslate"><span class="pre">64-bit</span> <span class="pre">API</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The resources were released successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnsetadvoptions">
<h4>
<span class="section-number">2.4.1.49. </span>cusolverDnSetAdvOptions()<a class="headerlink" href="index.html#cusolverdnsetadvoptions" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSetAdvOptions</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnFunction_t</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverAlgMode_t</span><span class="w"> </span><span class="n">algo</span><span class="w">   </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function configures algorithm <code class="docutils literal notranslate"><span class="pre">algo</span></code> of <code class="docutils literal notranslate"><span class="pre">function</span></code>, a <code class="docutils literal notranslate"><span class="pre">64-bit</span> <span class="pre">API</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The pointer to the structure of <code class="docutils literal notranslate"><span class="pre">64-bit</span> <span class="pre">API</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">function</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The routine to be configured.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">algo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The algorithm to be configured.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Wrong combination of <code class="docutils literal notranslate"><span class="pre">function</span></code> and <code class="docutils literal notranslate"><span class="pre">algo</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-linear-solver-reference-legacy">
<h3>
<span class="section-number">2.4.2. </span>Dense Linear Solver Reference (legacy)<a class="headerlink" href="index.html#dense-linear-solver-reference-legacy" title="Permalink to this headline"></a>
</h3>
<p>This section describes linear solver API of cuSolverDN, including Cholesky factorization, LU with partial pivoting, QR factorization and Bunch-Kaufman (LDLT) factorization.</p>
<section id="cusolverdn-t-potrf">
<h4>
<span class="section-number">2.4.2.1. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-potrf">cusolverDn&lt;t&gt;potrf()</a><a class="headerlink" href="index.html#cusolverdn-t-potrf" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the necessary size of work buffers.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the Cholesky factorization of a Hermitian positive-definite matrix.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only the lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other parts untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only the lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by the lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">Lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">potrf_bufferSize()</span></code>.</p>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, or equivalently some diagonal elements of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> is not a real number. The output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> would indicate smallest leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> which is not positive definite.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of potrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored; the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Workspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">Lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">potrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code>, the leading minor of order i is not positive definite.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnpotrf-deprecated">
<h4>
<span class="section-number">2.4.2.2. </span>cusolverDnPotrf()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdnpotrf-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnPotrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnPotrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>Computes the Cholesky factorization of a Hermitian positive-definite matrix using the generic API interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf_bufferSize()</span></code>.</p>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, or equivalently some diagonal elements of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> is not a real number. The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> would indicate smallest leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> which is not positive definite.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnPotrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf</span></code>:</p>
<p><strong>API of potrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the leading minor of order i is not positive definite.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ComputeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-potrs">
<h4>
<span class="section-number">2.4.2.3. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-potrs">cusolverDn&lt;t&gt;potrs()</a><a class="headerlink" href="index.html#cusolverdn-t-potrs" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a system of linear equations</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>The user has to call <code class="docutils literal notranslate"><span class="pre">potrf</span></code> first to factorize matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> corresponding to <span class="math notranslate nohighlight">\(A = L*L^{H}\)</span> . If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> corresponding to <span class="math notranslate nohighlight">\(A = U^{H}*U\)</span> .</p>
<p>The operation is in-place, i.e. matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> overwrites matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> with the same leading dimension <code class="docutils literal notranslate"><span class="pre">ldb</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of potrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">A</span></code> is either lower Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> or upper Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. As an input, <code class="docutils literal notranslate"><span class="pre">B</span></code> is right hand side matrix. As an output, <code class="docutils literal notranslate"><span class="pre">B</span></code> is the solution matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">nrhs&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnpotrs-deprecated">
<h4>
<span class="section-number">2.4.2.4. </span>cusolverDnPotrs()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdnpotrs-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrs()</span></code> instead. The routine will be removed in the next major release.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnPotrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a system of linear equations</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful using the generic API interface. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>The user has to call <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrf</span></code> first to factorize matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> corresponding to <span class="math notranslate nohighlight">\(A = L*L^{H}\)</span> . If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> corresponding to <span class="math notranslate nohighlight">\(A = U^{H}*U\)</span> .</p>
<p>The operation is in-place, i.e. matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> overwrites matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> with the same leading dimension <code class="docutils literal notranslate"><span class="pre">ldb</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrs</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnPotrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrs</span></code>:</p>
<p><strong>API of potrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">A</span></code> is either lower Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> or upper Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. As an input, <code class="docutils literal notranslate"><span class="pre">B</span></code> is right hand side matrix. As an output, <code class="docutils literal notranslate"><span class="pre">B</span></code> is the solution matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>                                                 <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverDnPotrs</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 36%">
<col style="width: 28%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">nrhs&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-potri">
<h4>
<span class="section-number">2.4.2.5. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-potri">cusolverDn&lt;t&gt;potri()</a><a class="headerlink" href="index.html#cusolverdn-t-potri" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the necessary size of work buffers.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotri_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotri_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotri_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotri_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotri</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotri</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotri</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotri</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the inverse of a positive-definite matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the Cholesky factorization</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H} = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>computed by <code class="docutils literal notranslate"><span class="pre">potrf()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix containing the triangular factor <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> computed by the Cholesky factorization. Only lower or upper part is meaningful and the input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave the other part untouched.</p>
<p>If the input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced the by lower triangular part of the inverse of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>If the input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by the upper triangular part of the inverse of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide the working space which is pointed to by input parameter <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">Lwork</span></code> is the size of the working space, returned by <code class="docutils literal notranslate"><span class="pre">potri_bufferSize()</span></code>.</p>
<p>If the computation of the inverse fails, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code>, is null, the output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> would indicate the smallest leading minor of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> which is not positive definite.</p>
<p>If the output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting the handle).</p>
<p><strong>API of potri</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> where <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Workspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">Lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">potri_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the computation of the inverse is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code>, the leading minor of order <code class="docutils literal notranslate"><span class="pre">i</span></code> is zero.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-getrf">
<h4>
<span class="section-number">2.4.2.6. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-getrf">cusolverDn&lt;t&gt;getrf()</a><a class="headerlink" href="index.html#cusolverdn-t-getrf" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/getrf">cuSOLVER Library Samples - getrf</a> for a code example.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgetrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgetrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgetrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgetrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgetrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgetrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgetrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgetrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the LU factorization of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">P</span></code> is a permutation matrix, <code class="docutils literal notranslate"><span class="pre">L</span></code> is a lower triangular matrix with unit diagonal, and <code class="docutils literal notranslate"><span class="pre">U</span></code> is an upper triangular matrix.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">Lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">getrf_bufferSize()</span></code>.</p>
<p>If LU factorization failed, i.e. matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> (<code class="docutils literal notranslate"><span class="pre">U</span></code>) is singular, The output parameter <code class="docutils literal notranslate"><span class="pre">devInfo=i</span></code> indicates <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span>                                     <span class="pre">0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">devIpiv</span></code> is null, no pivoting is performed. The factorization is <code class="docutils literal notranslate"><span class="pre">A=L*U</span></code>, which is not numerically stable.</p>
<p>No matter LU factorization failed or not, the output parameter <code class="docutils literal notranslate"><span class="pre">devIpiv</span></code> contains pivoting sequence, row <code class="docutils literal notranslate"><span class="pre">i</span></code> is interchanged with row <code class="docutils literal notranslate"><span class="pre">devIpiv(i)</span></code>.</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">getrf</span></code> and <code class="docutils literal notranslate"><span class="pre">getrs</span></code> to complete a linear solver.</p>
<p>Remark: <code class="docutils literal notranslate"><span class="pre">getrf</span></code> uses fastest implementation with large workspace of size <code class="docutils literal notranslate"><span class="pre">m*n</span></code>. The user can choose the legacy implementation with minimal workspace by <code class="docutils literal notranslate"><span class="pre">Getrf</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions(params,</span> <span class="pre">CUSOLVERDN_GETRF,</span>                                     <span class="pre">CUSOLVER_ALG_1)</span></code>.</p>
<p><strong>API of getrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 87%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Workspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">Lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devIpiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span>                                                 <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">devInfo</span>                                                 <span class="pre">=</span> <span class="pre">i</span></code>, the <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngetrf-deprecated">
<h4>
<span class="section-number">2.4.2.7. </span>cusolverDnGetrf()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdngetrf-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper function below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGetrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following function:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGetrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the LU factorization of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">P</span></code> is a permutation matrix, <code class="docutils literal notranslate"><span class="pre">L</span></code> is a lower triangular matrix with unit diagonal, and <code class="docutils literal notranslate"><span class="pre">U</span></code> is an upper triangular matrix using the generic API interface.</p>
<p>If LU factorization failed, i.e. matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> (<code class="docutils literal notranslate"><span class="pre">U</span></code>) is singular, The output parameter <code class="docutils literal notranslate"><span class="pre">info=i</span></code> indicates <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> is null, no pivoting is performed. The factorization is <code class="docutils literal notranslate"><span class="pre">A=L*U</span></code>, which is not numerically stable.</p>
<p>No matter LU factorization failed or not, the output parameter <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> contains pivoting sequence, row <code class="docutils literal notranslate"><span class="pre">i</span></code> is interchanged with row <code class="docutils literal notranslate"><span class="pre">ipiv(i)</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf_bufferSize()</span></code>.</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code> to complete a linear solver.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code> supports two algorithms. To select legacy implementation, the user has to call <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p>
<p><strong>Table of algorithms supported by cusolverDnGetrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm. The fastest, requires a large workspace of <code class="docutils literal notranslate"><span class="pre">m*n</span></code> elements.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_1</span></code></p></td>
<td><p>Legacy implementation</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code>:</p>
<p><strong>API of cusolverDnGetrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code> only supports the following four combinations.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ComputeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-getrs">
<h4>
<span class="section-number">2.4.2.8. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-getrs">cusolverDn&lt;t&gt;getrs()</a><a class="headerlink" href="index.html#cusolverdn-t-getrs" title="Permalink to this headline"></a>
</h4>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/getrf">cuSOLVER Library Samples - getrf</a> for a code example.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgetrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgetrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgetrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgetrs</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devIpiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a linear system of multiple right-hand sides</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({op(A)}*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix, and was LU-factored by <code class="docutils literal notranslate"><span class="pre">getrf</span></code>, that is, lower triangular part of A is <code class="docutils literal notranslate"><span class="pre">L</span></code>, and upper triangular part (including diagonal elements) of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">U</span></code>. <code class="docutils literal notranslate"><span class="pre">B</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×nrhs</span></code> right-hand side matrix.</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">trans</span></code> is defined by</p>
<p><span class="math notranslate nohighlight">\(\text{op}(A) = \left\{ \begin{matrix}
A &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_N}} \\
A^{T} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_T}} \\
A^{H} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">devIpiv</span></code> is an output of <code class="docutils literal notranslate"><span class="pre">getrf</span></code>. It contains pivot indices, which are used to permutate right-hand sides.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">getrf</span></code> and <code class="docutils literal notranslate"><span class="pre">getrs</span></code> to complete a linear solver.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">trans</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(A)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right-hand sides.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devIpiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">n</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code> with <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span>                                                 <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 31%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngetrs-deprecated">
<h4>
<span class="section-number">2.4.2.9. </span>cusolverDnGetrs()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdngetrs-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrs()</span></code> instead. The routine will be removed in the next major release.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGetrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a linear system of multiple right-hand sides</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({op(A)}*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix, and was LU-factored by <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code>, that is, lower triangular part of A is <code class="docutils literal notranslate"><span class="pre">L</span></code>, and upper triangular part (including diagonal elements) of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">U</span></code>. <code class="docutils literal notranslate"><span class="pre">B</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×nrhs</span></code> right-hand side matrix using the generic API interface.</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">trans</span></code> is defined by</p>
<p><span class="math notranslate nohighlight">\(\text{op}(A) = \left\{ \begin{matrix}
A &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_N}} \\
A^{T} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_T}} \\
A^{H} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> is an output of <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code>. It contains pivot indices, which are used to permutate right-hand sides.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrf</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code> to complete a linear solver.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnGetrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code>:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">trans</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(A)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right-hand sides.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">n</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code> with <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 36%">
<col style="width: 28%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 31%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t1-t2-gesv">
<h4>
<span class="section-number">2.4.2.10. </span><a class="reference external" href="index.html#cusolverDN-lt-t-gt-gesv">cusolverDn&lt;t1&gt;&lt;t2&gt;gesv()</a><a class="headerlink" href="index.html#cusolverdn-t1-t2-gesv" title="Permalink to this headline"></a>
</h4>
<p>These functions are modelled after functions DSGESV and ZCGESV from LAPACK. They compute the solution of a system of linear equations with one or multiple right hand sides using mixed precision iterative refinement techniques based on the LU factorization <code class="docutils literal notranslate"><span class="pre">Xgesv</span></code>. These functions are similar in term of functionalities to the full precision LU solver (<code class="docutils literal notranslate"><span class="pre">Xgesv</span></code>, where X denotes Z,C,D,S) but it uses lower precision internally in order to provide faster time to solution, from here comes the name mixed precision. Mixed precision iterative refinement techniques means that the solver compute an LU factorization in lower precision and then iteratively refine the solution to achieve the accuracy of the Inputs/Outputs datatype precision. The &lt;t1&gt; corresponds to the Inputs/Outputs datatype precision while &lt;t2&gt; represent the internal lower precision at which the factorization will be carried on.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A \times X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>Where <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">n-by-n</span></code> matrix and <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code> matrices.</p>
<p>Functions API are designed to be as close as possible to LAPACK API to be considered as a quick and easy drop-in replacement. Parameters and behavior are mostly the same as LAPACK counterparts. Description of these functions and differences from LAPACK is given below. <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;&lt;t2&gt;gesv()</span></code> functions are designated by two floating point precisions The &lt;t1&gt; corresponds to the main precision (e.g., Inputs/Outputs datatype precision) and the &lt;t2&gt; represent the internal lower precision at which the factorization will be carried on. <code class="docutils literal notranslate"><span class="pre">cusolver&lt;t1&gt;&lt;t2&gt;gesv()</span></code> first attempts to factorize the matrix in lower precision and use this factorization within an iterative refinement procedure to obtain a solution with same normwise backward error as the main precision &lt;t1&gt;. If the approach fails to converge, then the method fallback to the main precision factorization and solve (Xgesv) such a way that there is always a good solution at the output of these functions. If &lt;t2&gt; is equal to &lt;t1&gt;, then it is not a mixed precision process but rather a full one precision factorization, solve and refinement within the same main precision.</p>
<p>The iterative refinement process is stopped if
    <code class="docutils literal notranslate"><span class="pre">ITER</span> <span class="pre">&gt;</span> <span class="pre">ITERMAX</span></code>
or for all the RHS we have:
    <code class="docutils literal notranslate"><span class="pre">RNRM</span> <span class="pre">&lt;</span>                                     <span class="pre">SQRT(N)*XNRM*ANRM*EPS*BWDMAX</span></code>
where</p>
<ul class="simple">
<li><p>ITER is the number of the current iteration in the iterative refinement process</p></li>
<li><p>RNRM is the infinity-norm of the residual</p></li>
<li><p>XNRM is the infinity-norm of the solution</p></li>
<li><p>ANRM is the infinity-operator-norm of the matrix A</p></li>
<li><p>EPS is the machine epsilon that matches LAPACK &lt;t1&gt;LAMCH(‘Epsilon’)</p></li>
</ul>
<p>The value ITERMAX and BWDMAX are fixed to 50 and 1.0 respectively.</p>
<p>The function returns value describes the results of the solving process. A CUSOLVER_STATUS_SUCCESS indicates that the function finished with success otherwise, it indicates if one of the API arguments is incorrect, or if the function did not finish with success. More details about the error will be in the <code class="docutils literal notranslate"><span class="pre">niters</span></code> and the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> API parameters. See their description below for more details. User should provide the required workspace allocated on device memory. The amount of bytes required can be queried by calling the respective function <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;&lt;t2&gt;gesv_bufferSize()</span></code>.</p>
<p>Note that in addition to the two mixed precision functions available in LAPACK (e.g., <code class="docutils literal notranslate"><span class="pre">dsgesv</span></code> and <code class="docutils literal notranslate"><span class="pre">zcgesv</span></code>), we provide a large set of mixed precision functions that include half, bfloat and tensorfloat as a lower precision as well as same precision functions (e.g., main and lowest precision are equal &lt;t2&gt; is equal to &lt;t1&gt;). The following table specifies which precisions will be used for which interface function.</p>
<p>Tensor Float (TF32), introduced with NVIDIA Ampere Architecture GPUs, is the most robust tensor core accelerated compute mode for the iterative refinement solver. It is able to solve the widest range of problems in HPC arising from different applications and provides up to 4X and 5X speedup for real and complex systems, respectively. On Volta and Turing architecture GPUs, half precision tensor core acceleration is recommended. In cases where the iterative refinement solver fails to converge to the desired accuracy (main precision, INOUT data precision), it is recommended to use main precision as internal lowest precision (i.e., <code class="docutils literal notranslate"><span class="pre">cusolverDn[DD,ZZ]gesv</span></code> for the FP64 case).</p>
<table class="table-no-stripes docutils align-default" id="id23">
<caption>
<span class="caption-text">Table 3. <strong>Supported combinations of floating point precisions for cusolver &lt;t1&gt;&lt;t2&gt;gesv() functions</strong></span><a class="headerlink" href="index.html#id23" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 36%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Interface function</strong></p></th>
<th class="head"><p><strong>Main precision (matrix, rhs and solution datatype)</strong></p></th>
<th class="head"><p><strong>Lowest precision allowed to be used internally</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZZgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZCgesv</span> <span class="pre">*has</span> <span class="pre">LAPACK</span> <span class="pre">counterparts</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZKgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZEgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZYgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCCgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCKgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCEgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCYgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDDgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDSgesv</span> <span class="pre">*has</span> <span class="pre">LAPACK</span> <span class="pre">counterparts</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDHgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDBgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDXgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSSgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSHgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSBgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSXgesv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span></code></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t1&gt;&lt;t2&gt;gesv_bufferSize()</span></code> functions will return workspace buffer size in bytes required for the corresponding <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t1&gt;&lt;t2&gt;gesv()</span></code> function.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZZgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZCgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZKgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZEgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZYgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCCgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCKgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCEgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCYgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDDgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDSgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDHgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDBgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDXgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSSgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSHgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSBgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSXgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                         </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Parameters of cusolverDn&lt;T1&gt;&lt;T2&gt;gesv_bufferSize() functions</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of square matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">n-by-n</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Pivoting sequence. Not used and can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">ldx</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">none</span></code></p></td>
<td><p>Pointer to device workspace. Not used and can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Pointer to a variable where required size of temporary workspace in bytes will be stored. Can’t be NULL.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZZgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZCgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZKgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZEgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZYgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCCgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCKgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCEgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCYgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDDgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDSgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDHgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDBgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDXgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSSgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSHgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSBgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSXgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Parameters of cusolverDn&lt;T1&gt;&lt;T2&gt;gesv() functions</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 87%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of square matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">n-by-n</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. On return - unchanged if the iterative refinement process converged. If not - will contains the factorization of the matrix A in the main precision &lt;T1&gt; (<code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">P</span> <span class="pre">*</span> <span class="pre">L</span> <span class="pre">*</span> <span class="pre">U</span></code>, where P - permutation matrix defined by vector ipiv, L and U - lower and upper triangular matrices).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Vector that defines permutation for the factorization - row <code class="docutils literal notranslate"><span class="pre">i</span></code> was interchanged with row <code class="docutils literal notranslate"><span class="pre">ipiv[i]</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">ldx</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dWorkspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to an allocated workspace in device memory of size <code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of the allocated device workspace. Should be at least what was returned by <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;T1&gt;&lt;T2&gt;gesv_bufferSize()</span></code> function.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">iter</span></code> is</p>
<ul class="simple">
<li><p>&lt;0 : iterative refinement has failed, main precision (Inputs/Outputs precision) factorization has been performed</p></li>
<li><p>-1 : taking into account machine parameters, n, nrhs, it is a priori not worth working in lower precision</p></li>
<li><p>-2 : overflow of an entry when moving from main to lower precision</p></li>
<li><p>-3 : failure during the factorization</p></li>
<li><p>-5 : overflow occurred during computation</p></li>
<li><p>-50: solver stopped the iterative refinement after reaching maximum allowed iterations</p></li>
<li><p>&gt;0 : iter is a number of iterations solver performed to reach convergence criteria</p></li>
</ul>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dinfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Status of the IRS solver on the return. If 0 - solve was successful. If <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> = -<code class="docutils literal notranslate"><span class="pre">i</span></code> then <code class="docutils literal notranslate"><span class="pre">i</span></code>-th argument is not valid. If <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> = <code class="docutils literal notranslate"><span class="pre">i</span></code>, then <code class="docutils literal notranslate"><span class="pre">U(i,i)</span></code> computed in main precision is exactly zero. The factorization has been completed, but the factor U is exactly singular, so the solution could not be computed.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 83%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td>
<p>Invalid parameters were passed, for example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldx&lt;max(1,n)</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The IRS solver supports compute capability 7.0 and above. The lowest precision options CUSOLVER_[CR]_16BF and CUSOLVER_[CR]_TF32 are only available on compute capability 8.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_WORKSPACE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code> is smaller than the required workspace.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_OUT_OF_RANGE</span></code></p></td>
<td><p>Numerical error related to niters &lt;0, see <code class="docutils literal notranslate"><span class="pre">niters</span></code> description for more details.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal error occurred, check the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> and the <code class="docutils literal notranslate"><span class="pre">niters</span></code> arguments for more details.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsxgesv">
<h4>
<span class="section-number">2.4.2.11. </span>cusolverDnIRSXgesv()<a class="headerlink" href="index.html#cusolverdnirsxgesv" title="Permalink to this headline"></a>
</h4>
<p>This function is designed to perform same functionality as <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;T1&gt;&lt;T2&gt;gesv()</span></code> functions, but wrapped in a more generic and expert interface that gives user more control to parametrize the function as well as it provides more information on output. <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> allows additional control of the solver parameters such as setting:</p>
<ul class="simple">
<li><p>the main precision (Inputs/Outputs precision) of the solver</p></li>
<li><p>the lowest precision to be used internally by the solver</p></li>
<li><p>the refinement solver type</p></li>
<li><p>the maximum allowed number of iterations in the refinement phase</p></li>
<li><p>the tolerance of the refinement solver</p></li>
<li><p>the fallback to main precision</p></li>
<li><p>and more</p></li>
</ul>
<p>through the configuration parameters structure <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> and its helper functions. For more details about what configuration can be set and its meaning please refer to all the functions in the cuSolverDN Helper Function Section that start with <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsxxxx()</span></code>. Moreover, <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> provides additional information on the output such as the convergence history (e.g., the residual norms) at each iteration and the number of iterations needed to converge. For more details about what information can be retrieved and its meaning please refer to all the functions in the cuSolverDN Helper Function Section that start with <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosxxxx()</span></code></p>
<p>The function returns value describes the results of the solving process. A CUSOLVER_STATUS_SUCCESS indicates that the function finished with success otherwise, it indicates if one of the API arguments is incorrect, or if the configurations of params/infos structure is incorrect or if the function did not finish with success. More details about the error can be found by checking the <code class="docutils literal notranslate"><span class="pre">niters</span></code> and the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> API parameters. See their description below for further details. User should provide the required workspace allocated on device for the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv()</span></code> function. The amount of bytes required for the function can be queried by calling the respective function <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize()</span></code>. Note that, if the user would like a particular configuration to be set via the params structure, it should be set before the call to <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize()</span></code> to get the size of the required workspace.</p>
<p>Tensor Float (TF32), introduced with NVIDIA Ampere Architecture GPUs, is the most robust tensor core accelerated compute mode for the iterative refinement solver. It is able to solve the widest range of problems in HPC arising from different applications and provides up to 4X and 5X speedup for real and complex systems, respectively. On Volta and Turing architecture GPUs, half precision tensor core acceleration is recommended. In cases where the iterative refinement solver fails to converge to the desired accuracy (main precision, INOUT data precision), it is recommended to use main precision as internal lowest precision.</p>
<p>The following table provides all possible combinations values for the lowest precision corresponding to the Inputs/Outputs data type. Note that if the lowest precision matches the Inputs/Outputs datatype, then the main precision factorization will be used.</p>
<table class="table-no-stripes docutils align-default" id="id24">
<caption>
<span class="caption-text">Table 4. <strong>Supported Inputs/Outputs data type and lower precision for the IRS solver</strong></span><a class="headerlink" href="index.html#id24" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Inputs/Outputs Data Type (e.g., main precision)</strong></p></th>
<th class="head"><p><strong>Supported values for the lowest precision</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F,</span> <span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F,</span> <span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize()</span></code> function returns the required workspace buffer size in bytes for the corresponding <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesv()</span></code> call with the given <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> configuration.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSXgesv_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">          </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSParams_t</span><span class="w">       </span><span class="n">gesv_irs_params</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolver_int_t</span><span class="w">              </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolver_int_t</span><span class="w">              </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="table-no-stripes docutils align-default" id="id25">
<caption>
<span class="caption-text">Table 5. <strong>Parameters of cusolverDnIRSXgesv_bufferSize() functions</strong></span><a class="headerlink" href="index.html#id25" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDn library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Xgesv</span></code> configuration parameters</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of the square matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative. Note that <code class="docutils literal notranslate"><span class="pre">nrhs</span></code> is limited to 1 if the selected IRS refinement solver is CUSOLVER_IRS_REFINE_GMRES, CUSOLVER_IRS_REFINE_GMRES_GMRES, CUSOLVER_IRS_REFINE_CLASSICAL_GMRES.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">out</span></code></p></td>
<td><p>Pointer to a variable, where the required size in bytes, of the workspace will be stored after a call to <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize</span></code>. Can’t be NULL.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnIRSXgesv</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">          </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSParams_t</span><span class="w">       </span><span class="n">gesv_irs_params</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSInfos_t</span><span class="w">        </span><span class="n">gesv_irs_infos</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                      </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="table-no-stripes docutils align-default" id="id26">
<caption>
<span class="caption-text">Table 6. <strong>Parameters of cusolverDnIRSXgesv() functions</strong></span><a class="headerlink" href="index.html#id26" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDn library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Configuration parameters structure, can serve one or more calls to any IRS solver</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">gesv_irs_infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Info structure, where information about a particular solve will be stored. The <code class="docutils literal notranslate"><span class="pre">gesv_irs_infos</span></code> structure correspond to a particular call. Thus different calls requires different <code class="docutils literal notranslate"><span class="pre">gesv_irs_infos</span></code> structure otherwise, it will be overwritten.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of square matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative. Note that, <code class="docutils literal notranslate"><span class="pre">nrhs</span></code> is limited to 1 if the selected IRS refinement solver is CUSOLVER_IRS_REFINE_GMRES, CUSOLVER_IRS_REFINE_GMRES_GMRES, CUSOLVER_IRS_REFINE_CLASSICAL_GMRES.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">n-by-n</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. On return - will contain the factorization of the matrix A in the main precision (<code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">P</span> <span class="pre">*</span> <span class="pre">L</span> <span class="pre">*</span> <span class="pre">U</span></code>, where P - permutation matrix defined by vector ipiv, L and U - lower and upper triangular matrices) if the iterative refinement solver was set to CUSOLVER_IRS_REFINE_NONE and the lowest precision is equal to the main precision (Inputs/Outputs datatype), or if the iterative refinement solver did not converge and the fallback to main precision was enabled (fallback enabled is the default setting); unchanged otherwise.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">ldx</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dWorkspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to an allocated workspace in device memory of size lwork_bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of the allocated device workspace. Should be at least what was returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize()</span></code> function</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If iter is</p>
<ul class="simple">
<li><p>&lt;0 : iterative refinement has failed, main precision (Inputs/Outputs precision) factorization has been performed if fallback is enabled.</p></li>
<li><p>-1 : taking into account machine parameters, n, nrhs, it is a priori not worth working in lower precision</p></li>
<li><p>-2 : overflow of an entry when moving from main to lower precision</p></li>
<li><p>-3 : failure during the factorization</p></li>
<li><p>-5 : overflow occurred during computation</p></li>
<li><p>-maxiter: solver stopped the iterative refinement after reaching maximum allowed iterations.</p></li>
<li><p>&gt;0 : iter is a number of iterations solver performed to reach convergence criteria</p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dinfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Status of the IRS solver on the return. If 0 - solve was successful. If dinfo = -<code class="docutils literal notranslate"><span class="pre">i</span></code> then <code class="docutils literal notranslate"><span class="pre">i</span></code>-th argument is not valid. If dinfo = <code class="docutils literal notranslate"><span class="pre">i</span></code>, then <code class="docutils literal notranslate"><span class="pre">U(i,i)</span></code> computed in main precision is exactly zero. The factorization has been completed, but the factor U is exactly singular, so the solution could not be computed.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 82%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td>
<p>Invalid parameters were passed, for example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldx&lt;max(1,n)</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The IRS solver supports compute capability 7.0 and above. The lowest precision options CUSOLVER_[CR]_16BF and CUSOLVER_[CR]_TF32 are only available on compute capability 8.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_WORKSPACE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code> is smaller than the required workspace. Could happen if the users called <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgesv_bufferSize()</span></code> function, then changed some of the configurations setting such as the lowest precision.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_OUT_OF_RANGE</span></code></p></td>
<td><p>Numerical error related to niters &lt;0, see niters description for more details.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal error occurred, check the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> and the <code class="docutils literal notranslate"><span class="pre">niters</span></code> arguments for more details.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The configuration parameter <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID</span></code></p></td>
<td><p>One of the configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure is not valid.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_PREC</span></code></p></td>
<td><p>The main and/or the lowest precision configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure is not valid, check the table above for the supported combinations.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_MAXITER</span></code></p></td>
<td><p>The maxiter configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure is not valid.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_REFINE</span></code></p></td>
<td><p>The refinement solver configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure is not valid.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_NOT_SUPPORTED</span></code></p></td>
<td><p>One of the configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gesv_irs_params</span></code> structure is not supported. For example if nrhs &gt;1, and refinement solver was set to CUSOLVER_IRS_REFINE_GMRES.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The information structure <code class="docutils literal notranslate"><span class="pre">gesv_irs_infos</span></code> was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>CPU memory allocation failed, most likely during the allocation of the residual array that store the residual norms.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-geqrf">
<h4>
<span class="section-number">2.4.2.12. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-geqrf">cusolverDn&lt;t&gt;geqrf()</a><a class="headerlink" href="index.html#cusolverdn-t-geqrf" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgeqrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgeqrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgeqrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgeqrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgeqrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">TAU</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgeqrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">TAU</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgeqrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAU</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgeqrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAU</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Workspace</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the QR factorization of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = Q*R\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">Q</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, and <code class="docutils literal notranslate"><span class="pre">R</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> upper triangular matrix.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">Lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">geqrf_bufferSize()</span></code>.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> is overwritten in upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>, including diagonal elements.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> is not formed explicitly, instead, a sequence of householder vectors are stored in lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>. The leading nonzero element of householder vector is assumed to be 1 such that output parameter <code class="docutils literal notranslate"><span class="pre">TAU</span></code> contains the scaling factor <code class="docutils literal notranslate"><span class="pre">τ</span></code>. If <code class="docutils literal notranslate"><span class="pre">v</span></code> is original householder vector, <code class="docutils literal notranslate"><span class="pre">q</span></code> is the new householder vector corresponding to <code class="docutils literal notranslate"><span class="pre">τ</span></code>, satisfying the following relation</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(I - 2*v*v^{H} = I - \tau*q*q^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of geqrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">TAU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Workspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">Lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngeqrf-deprecated">
<h4>
<span class="section-number">2.4.2.13. </span>cusolverDnGeqrf()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdngeqrf-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGeqrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnGeqrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the QR factorization of an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = Q*R\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">Q</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, and <code class="docutils literal notranslate"><span class="pre">R</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> upper triangular matrix using the generic API interface.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnGeqrf_bufferSize()</span></code>.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> is overwritten in upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>, including diagonal elements.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> is not formed explicitly, instead, a sequence of householder vectors are stored in lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>. The leading nonzero element of householder vector is assumed to be 1 such that output parameter <code class="docutils literal notranslate"><span class="pre">TAU</span></code> contains the scaling factor <code class="docutils literal notranslate"><span class="pre">τ</span></code>. If <code class="docutils literal notranslate"><span class="pre">v</span></code> is original householder vector, <code class="docutils literal notranslate"><span class="pre">q</span></code> is the new householder vector corresponding to <code class="docutils literal notranslate"><span class="pre">τ</span></code>, satisfying the following relation</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(I - 2*v*v^{H} = I - \tau*q*q^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnGeqrf</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnGeqrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnGeqrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGeqrf</span></code>:</p>
<p><strong>API of geqrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">TAU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of working array <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and array <code class="docutils literal notranslate"><span class="pre">tau</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnGeqrf</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><strong>DataTypeA</strong></p></td>
<td><p><strong>ComputeType</strong></p></td>
<td><p><strong>Meaning</strong></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGEQRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGEQRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGEQRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGEQRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t1-t2-gels">
<h4>
<span class="section-number">2.4.2.14. </span><a class="reference external" href="index.html#cusolverDN-lt-t-gt-gels">cusolverDn&lt;t1&gt;&lt;t2&gt;gels()</a><a class="headerlink" href="index.html#cusolverdn-t1-t2-gels" title="Permalink to this headline"></a>
</h4>
<p>These functions compute the solution of a system of linear equations with one or multiple right hand sides using mixed precision iterative refinement techniques based on the QR factorization Xgels. These functions are similar in term of functionalities to the full precision LAPACK QR (least squares) solver (Xgels, where X denotes Z,C,D,S) but it uses lower precision internally in order to provide faster time to solution, from here comes the name mixed precision. Mixed precision iterative refinement techniques means that the solver compute an QR factorization in lower precision and then iteratively refine the solution to achieve the accuracy of the Inputs/Outputs datatype precision. The &lt;t1&gt; corresponds to the Inputs/Outputs datatype precision while &lt;t2&gt; represent the internal lower precision at which the factorization will be carried on.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A \times X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>Where <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">m-by-n</span></code> matrix and <code class="docutils literal notranslate"><span class="pre">X</span></code> is <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> is <code class="docutils literal notranslate"><span class="pre">m-by-nrhs</span></code> matrices.</p>
<p>Functions API are designed to be as close as possible to LAPACK API to be considered as a quick and easy drop-in replacement. Description of these functions is given below. <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;&lt;t2&gt;gels()</span></code> functions are designated by two floating point precisions The <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;</span></code> corresponds to the main precision (e.g., Inputs/Outputs datatype precision) and the <code class="docutils literal notranslate"><span class="pre">&lt;t2&gt;</span></code> represent the internal lower precision at which the factorization will be carried on. <code class="docutils literal notranslate"><span class="pre">cusolver&lt;t1&gt;&lt;t2&gt;gels()</span></code> first attempts to factorize the matrix in lower precision and use this factorization within an iterative refinement procedure to obtain a solution with same normwise backward error as the main precision <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;</span></code>. If the approach fails to converge, then the method fallback to the main precision factorization and solve (Xgels) such a way that there is always a good solution at the output of these functions. If <code class="docutils literal notranslate"><span class="pre">&lt;t2&gt;</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;</span></code>, then it is not a mixed precision process but rather a full one precision factorization, solve and refinement within the same main precision.</p>
<p>The iterative refinement process is stopped if:
    <code class="docutils literal notranslate"><span class="pre">ITER</span> <span class="pre">&gt;</span> <span class="pre">ITERMAX</span></code>
or for all the RHS we have:
    <code class="docutils literal notranslate"><span class="pre">RNRM</span> <span class="pre">&lt;</span>                                     <span class="pre">SQRT(N)*XNRM*ANRM*EPS*BWDMAX</span></code>
where</p>
<ul class="simple">
<li><p>ITER is the number of the current iteration in the iterative refinement process</p></li>
<li><p>RNRM is the infinity-norm of the residual</p></li>
<li><p>XNRM is the infinity-norm of the solution</p></li>
<li><p>ANRM is the infinity-operator-norm of the matrix A</p></li>
<li><p>EPS is the machine epsilon that matches <code class="docutils literal notranslate"><span class="pre">LAPACK</span>                                           <span class="pre">&lt;t1&gt;LAMCH('Epsilon')</span></code></p></li>
</ul>
<p>The values ITERMAX and BWDMAX are fixed to 50 and 1.0 respectively.</p>
<p>The function returns value describes the results of the solving process. A CUSOLVER_STATUS_SUCCESS indicates that the function finished with success otherwise, it indicates if one of the API arguments is incorrect, or if the function did not finish with success. More details about the error will be in the <code class="docutils literal notranslate"><span class="pre">niters</span></code> and the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> API parameters. See their description below for more details. User should provide the required workspace allocated on device memory. The amount of bytes required can be queried by calling the respective function <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;&lt;t2&gt;gels_bufferSize()</span></code>.</p>
<p>We provide a large set of mixed precision functions that include half, bfloat and tensorfloat as a lower precision as well as same precision functions (e.g., main and lowest precision are equal <code class="docutils literal notranslate"><span class="pre">&lt;t2&gt;</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">&lt;t1&gt;</span></code>). The following table specifies which precisions will be used for which interface function:</p>
<p>Tensor Float (TF32), introduced with NVIDIA Ampere Architecture GPUs, is the most robust tensor core accelerated compute mode for the iterative refinement solver. It is able to solve the widest range of problems in HPC arising from different applications and provides up to 4X and 5X speedup for real and complex systems, respectively. On Volta and Turing architecture GPUs, half precision tensor core acceleration is recommended. In cases where the iterative refinement solver fails to converge to the desired accuracy (main precision, INOUT data precision), it is recommended to use main precision as internal lowest precision (i.e., <code class="docutils literal notranslate"><span class="pre">cusolverDn[DD,ZZ]gels</span></code> for the FP64 case).</p>
<table class="table-no-stripes docutils align-default" id="id27">
<caption>
<span class="caption-text">Table 7. <strong>Supported combinations of floating point precisions for cusolver &lt;t1&gt;&lt;t2&gt;gels() functions</strong></span><a class="headerlink" href="index.html#id27" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 42%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Interface function</strong></p></th>
<th class="head"><p><strong>Main precision (matrix, rhs and solution datatype)</strong></p></th>
<th class="head"><p><strong>Lowest precision allowed to be used internally</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZZgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZCgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZKgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZEgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnZYgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCCgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCKgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCEgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnCYgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuComplex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span> <span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDDgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDSgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDHgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDBgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnDXgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSSgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">single</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSHgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">half</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSBgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bfloat</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">cusolverDnSXgels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensorfloat</span></code></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t1&gt;&lt;t2&gt;gels_bufferSize()</span></code> functions will return workspace buffer size in bytes required for the corresponding <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;t1&gt;&lt;t2&gt;gels()</span></code> function.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZZgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZCgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZKgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZEgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZYgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w">             </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCCgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCKgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCEgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCYgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w">                   </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDDgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDSgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDHgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDBgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDXgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSSgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSHgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSBgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSXgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverHandle_t</span><span class="w">                </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">                       </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">                             </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                        </span><span class="o">*</span><span class="w">   </span><span class="n">dwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">                      </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="table-no-stripes docutils align-default" id="id28">
<caption>
<span class="caption-text">Table 8. <strong>Parameters of cusolverDn&lt;T1&gt;&lt;T2&gt;gels_bufferSize() functions</strong></span><a class="headerlink" href="index.html#id28" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">m-by-n</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">ldda</span> <span class="pre">&gt;=</span> <span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">m-by-nrhs</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">lddb</span> <span class="pre">&gt;=</span>                                                 <span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">lddx</span> <span class="pre">&gt;=</span>                                                 <span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">none</span></code></p></td>
<td><p>Pointer to device workspace. Not used and can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Pointer to a variable where required size of temporary workspace in bytes will be stored. Can’t be NULL.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZZgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZCgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZKgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZEgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnZYgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuDoubleComplex</span><span class="w">     </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCCgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCKgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCEgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnCYgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cuComplex</span><span class="w">           </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDDgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDSgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDHgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDBgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnDXgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">              </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSSgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSHgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSBgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnSXgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">      </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w">               </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">niter</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                 </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="table-no-stripes docutils align-default" id="id29">
<caption>
<span class="caption-text">Table 9. <strong>Parameters of cusolverDn&lt;T1&gt;&lt;T2&gt;gels() functions</strong></span><a class="headerlink" href="index.html#id29" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">m-by-n</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. On return - unchanged if the lowest precision is not equal to the main precision and the iterative refinement solver converged, - garbage otherwise.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">ldda</span> <span class="pre">&gt;=</span> <span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">m-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">lddb</span> <span class="pre">&gt;=</span>                                                 <span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">lddx</span> <span class="pre">&gt;=</span>                                                 <span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dWorkspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to an allocated workspace in device memory of size lwork_bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of the allocated device workspace. Should be at least what was returned by <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;T1&gt;&lt;T2&gt;gels_bufferSize()</span></code> function</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If iter is</p>
<ul class="simple">
<li><p>&lt;0 : iterative refinement has failed, main precision (Inputs/Outputs precision) factorization has been performed.</p></li>
<li><p>-1 : taking into account machine parameters, n, nrhs, it is a priori not worth working in lower precision</p></li>
<li><p>-2 : overflow of an entry when moving from main to lower precision</p></li>
<li><p>-3 : failure during the factorization</p></li>
<li><p>-5 : overflow occurred during computation</p></li>
<li><p>-50: solver stopped the iterative refinement after reaching maximum allowed iterations.</p></li>
<li><p>&gt;0 : iter is a number of iterations solver performed to reach convergence criteria</p></li>
</ul>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dinfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Status of the IRS solver on the return. If 0 - solve was successful. If dinfo = -<code class="docutils literal notranslate"><span class="pre">i</span></code> then <code class="docutils literal notranslate"><span class="pre">i</span></code>-th argument is not valid.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 83%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td>
<p>Invalid parameters were passed, for example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldda&lt;max(1,m)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lddb&lt;max(1,m)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lddx&lt;max(1,n)</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The IRS solver supports compute capability 7.0 and above. The lowest precision options CUSOLVER_[CR]_16BF and CUSOLVER_[CR]_TF32 are only available on compute capability 8.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_WORKSPACE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code> is smaller than the required workspace.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_OUT_OF_RANGE</span></code></p></td>
<td><p>Numerical error related to niters &lt;0, see niters description for more details.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal error occurred; check the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> and the <code class="docutils literal notranslate"><span class="pre">niters</span></code> arguments for more details.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnirsxgels">
<h4>
<span class="section-number">2.4.2.15. </span>cusolverDnIRSXgels()<a class="headerlink" href="index.html#cusolverdnirsxgels" title="Permalink to this headline"></a>
</h4>
<p>This function is designed to perform same functionality as <code class="docutils literal notranslate"><span class="pre">cusolverDn&lt;T1&gt;&lt;T2&gt;gels()</span></code> functions, but wrapped in a more generic and expert interface that gives user more control to parametrize the function as well as it provides more information on output. <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code> allows additional control of the solver parameters such as setting:</p>
<ul class="simple">
<li><p>the main precision (Inputs/Outputs precision) of the solver,</p></li>
<li><p>the lowest precision to be used internally by the solver,</p></li>
<li><p>the refinement solver type</p></li>
<li><p>the maximum allowed number of iterations in the refinement phase</p></li>
<li><p>the tolerance of the refinement solver</p></li>
<li><p>the fallback to main precision</p></li>
<li><p>and others</p></li>
</ul>
<p>through the configuration parameters structure <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> and its helper functions. For more details about what configuration can be set and its meaning please refer to all the functions in the cuSolverDN Helper Function Section that start with <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSParamsxxxx()</span></code>. Moreover, <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code> provides additional information on the output such as the convergence history (e.g., the residual norms) at each iteration and the number of iterations needed to converge. For more details about what information can be retrieved and its meaning please refer to all the functions in the cuSolverDN Helper Function Section that start with <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSInfosxxxx()</span></code>.</p>
<p>The function returns value describes the results of the solving process. A CUSOLVER_STATUS_SUCCESS indicates that the function finished with success otherwise, it indicates if one of the API arguments is incorrect, or if the configurations of params/infos structure is incorrect or if the function did not finish with success. More details about the error can be found by checking the <code class="docutils literal notranslate"><span class="pre">niters</span></code> and the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> API parameters. See their description below for further details. Users should provide the required workspace allocated on device for the <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels()</span></code> function. The amount of bytes required for the function can be queried by calling the respective function <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels_bufferSize()</span></code>. Note that, if the user would like a particular configuration to be set via the params structure, it should be set before the call to <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels_bufferSize()</span></code> to get the size of the required workspace.</p>
<p>The following table provides all possible combinations values for the lowest precision corresponding to the Inputs/Outputs data type. Note that if the lowest precision matches the Inputs/Outputs datatype, then main precision factorization will be used</p>
<p>Tensor Float (TF32), introduced with NVIDIA Ampere Architecture GPUs, is the most robust tensor core accelerated compute mode for the iterative refinement solver. It is able to solve the widest range of problems in HPC arising from different applications and provides up to 4X and 5X speedup for real and complex systems, respectively. On Volta and Turing architecture GPUs, half precision tensor core acceleration is recommended. In cases where the iterative refinement solver fails to converge to the desired accuracy (main precision, INOUT data precision), it is recommended to use main precision as internal lowest precision.</p>
<table class="docutils align-default" id="id30">
<caption>
<span class="caption-text">Table 10. <strong>Supported Inputs/Outputs data type and lower precision for the IRS solver</strong>
 :class: table-no-stripes</span><a class="headerlink" href="index.html#id30" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Inputs/Outputs Data Type (e.g., main precision)</strong></p></th>
<th class="head"><p><strong>Supported values for the lowest precision</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_64F,</span> <span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_C_32F,</span> <span class="pre">CUSOLVER_C_16F,</span> <span class="pre">CUSOLVER_C_16BF,</span> <span class="pre">CUSOLVER_C_TF32</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_64F,</span> <span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_R_32F,</span> <span class="pre">CUSOLVER_R_16F,</span> <span class="pre">CUSOLVER_R_16BF,</span> <span class="pre">CUSOLVER_R_TF32</span></code></p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels_bufferSize()</span></code> function return the required workspace buffer size in bytes for the corresponding <code class="docutils literal notranslate"><span class="pre">cusolverDnXgels()</span></code> call with given <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> configuration.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnIRSXgels_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">          </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSParams_t</span><span class="w">       </span><span class="n">gels_irs_params</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolver_int_t</span><span class="w">              </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolver_int_t</span><span class="w">              </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolver_int_t</span><span class="w">              </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                  </span><span class="o">*</span><span class="w">   </span><span class="n">lwork_bytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Parameters of cusolverDnIRSXgels_bufferSize() functions</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDn library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Xgels configuration parameters</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative. Note that, <code class="docutils literal notranslate"><span class="pre">nrhs</span></code> is limited to 1 if the selected IRS refinement solver is CUSOLVER_IRS_REFINE_GMRES, CUSOLVER_IRS_REFINE_GMRES_GMRES, CUSOLVER_IRS_REFINE_CLASSICAL_GMRES.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">out</span></code></p></td>
<td><p>Pointer to a variable, where the required size in bytes, of the workspace will be stored after a call to cusolverDnIRSXgels_bufferSize. Can’t be NULL.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnIRSXgels</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnHandle_t</span><span class="w">          </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSParams_t</span><span class="w">       </span><span class="n">gels_irs_params</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">cusolverDnIRSInfos_t</span><span class="w">        </span><span class="n">gels_irs_infos</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dA</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">ldda</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dB</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">lddb</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dX</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                         </span><span class="n">lddx</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w">                    </span><span class="o">*</span><span class="w">   </span><span class="n">dWorkspace</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w">                      </span><span class="n">lwork_bytes</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">                     </span><span class="o">*</span><span class="w">   </span><span class="n">dinfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="table-no-stripes docutils align-default" id="id31">
<caption>
<span class="caption-text">Table 11. <strong>Parameters of cusolverDnIRSXgels() functions</strong></span><a class="headerlink" href="index.html#id31" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cusolverDn library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Configuration parameters structure, can serve one or more calls to any IRS solver</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">gels_irs_infos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Info structure, where information about a particular solve will be stored. The <code class="docutils literal notranslate"><span class="pre">gels_irs_infos</span></code> structure correspond to a particular call. Thus different calls requires different <code class="docutils literal notranslate"><span class="pre">gels_irs_infos</span></code> structure otherwise, it will be overwritten.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Should be non-negative and n&lt;=m.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right hand sides to solve. Should be non-negative. Note that, <code class="docutils literal notranslate"><span class="pre">nrhs</span></code> is limited to 1 if the selected IRS refinement solver is CUSOLVER_IRS_REFINE_GMRES, CUSOLVER_IRS_REFINE_GMRES_GMRES, CUSOLVER_IRS_REFINE_CLASSICAL_GMRES.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with size <code class="docutils literal notranslate"><span class="pre">m-by-n</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. On return - unchanged if the lowest precision is not equal to the main precision and the iterative refinement solver converged, - garbage otherwise.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">ldda</span> <span class="pre">&gt;=</span> <span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Set of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code> of size <code class="docutils literal notranslate"><span class="pre">m-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of right hand sides <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">lddb</span> <span class="pre">&gt;=</span> <span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Set of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code> of size <code class="docutils literal notranslate"><span class="pre">n-by-nrhs</span></code>. Can’t be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lddx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix of solution vectors <code class="docutils literal notranslate"><span class="pre">X</span></code>. <code class="docutils literal notranslate"><span class="pre">lddx</span> <span class="pre">&gt;=</span> <span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dWorkspace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Pointer to an allocated workspace in device memory of size lwork_bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of the allocated device workspace. Should be at least what was returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels_bufferSize()</span></code> function.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">iter</span></code> is</p>
<ul class="simple">
<li><p>&lt;0 : iterative refinement has failed, main precision (Inputs/Outputs precision) factorization has been performed if fallback is enabled</p></li>
<li><p>-1 : taking into account machine parameters, n, nrhs, it is a priori not worth working in lower precision</p></li>
<li><p>-2 : overflow of an entry when moving from main to lower precision</p></li>
<li><p>-3 : failure during the factorization</p></li>
<li><p>-5 : overflow occurred during computation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-maxiter</span></code>: solver stopped the iterative refinement after reaching maximum allowed iterations</p></li>
<li><p>&gt;0 : iter is a number of iterations solver performed to reach convergence criteria</p></li>
</ul>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dinfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Status of the IRS solver on the return. If 0 - solve was successful. If dinfo = -<code class="docutils literal notranslate"><span class="pre">i</span></code> then <code class="docutils literal notranslate"><span class="pre">i</span></code>-th argument is not valid.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 82%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td>
<p>Invalid parameters were passed, for example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ldda&lt;max(1,m)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lddb&lt;max(1,m)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lddx&lt;max(1,n)</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The IRS solver supports compute capability 7.0 and above. The lowest precision options CUSOLVER_[CR]_16BF and CUSOLVER_[CR]_TF32 are only available on compute capability 8.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_WORKSPACE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lwork_bytes</span></code> is smaller than the required workspace. Could happen if the users called <code class="docutils literal notranslate"><span class="pre">cusolverDnIRSXgels_bufferSize()</span></code> function, then changed some of the configurations setting such as the lowest precision.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_OUT_OF_RANGE</span></code></p></td>
<td><p>Numerical error related to <code class="docutils literal notranslate"><span class="pre">niters</span></code> &lt;0; see <code class="docutils literal notranslate"><span class="pre">niters</span></code> description for more details.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal error occurred, check the <code class="docutils literal notranslate"><span class="pre">dinfo</span></code> and the <code class="docutils literal notranslate"><span class="pre">niters</span></code> arguments for more details.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_NOT_INITIALIZED</span></code></p></td>
<td><p>The configuration parameter <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> structure was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID</span></code></p></td>
<td><p>One of the configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> structure is not valid.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_PREC</span></code></p></td>
<td><p>The main and/or the lowest precision configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> structure is not valid, check the table above for the supported combinations.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_MAXITER</span></code></p></td>
<td><p>The maxiter configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> structure is not valid.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_PARAMS_INVALID_REFINE</span></code></p></td>
<td><p>The refinement solver configuration parameter in the gels_irs_params structure is not valid.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_NOT_SUPPORTED</span></code></p></td>
<td><p>One of the configuration parameter in the <code class="docutils literal notranslate"><span class="pre">gels_irs_params</span></code> structure is not supported. For example if nrhs &gt;1, and refinement solver was set to CUSOLVER_IRS_REFINE_GMRES.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_IRS_INFOS_NOT_INITIALIZED</span></code></p></td>
<td><p>The information structure <code class="docutils literal notranslate"><span class="pre">gels_irs_infos</span></code> was not created.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>CPU memory allocation failed, most likely during the allocation of the residual array that store the residual norms.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-ormqr">
<h4>
<span class="section-number">2.4.2.16. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-ormqr">cusolverDn&lt;t&gt;ormqr()</a><a class="headerlink" href="index.html#cusolverdn-t-ormqr" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed. Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/ormqr">cuSOLVER Library Samples - ormqr</a> for a code example.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSormqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDormqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCunmqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZunmqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSormqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDormqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCunmqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZunmqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function overwrites <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">C</span></code> by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(C = \left\{ \begin{matrix}
{\text{op}(Q)*C} &amp; {\text{if~}\textsf{side\ ==\ CUBLAS\_SIDE\_LEFT}} \\
{C*\text{op}(Q)} &amp; {\text{if~}\textsf{side\ ==\ CUBLAS\_SIDE\_RIGHT}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>The operation of <code class="docutils literal notranslate"><span class="pre">Q</span></code> is defined by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\text{op}(Q) = \left\{ \begin{matrix}
Q &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_N}} \\
Q^{T} &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_T}} \\
Q^{H} &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Q</span></code> is a unitary matrix formed by a sequence of elementary reflection vectors from QR factorization (<code class="docutils literal notranslate"><span class="pre">geqrf</span></code>) of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Q</span></code>=<code class="docutils literal notranslate"><span class="pre">H(1)</span></code><code class="docutils literal notranslate"><span class="pre">H(2)</span></code> … <code class="docutils literal notranslate"><span class="pre">H(k)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Q</span></code> is of order <code class="docutils literal notranslate"><span class="pre">m</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code> and of order <code class="docutils literal notranslate"><span class="pre">n</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">geqrf_bufferSize()</span></code> or <code class="docutils literal notranslate"><span class="pre">ormqr_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">geqrf</span></code>, <code class="docutils literal notranslate"><span class="pre">ormqr</span></code> and <code class="docutils literal notranslate"><span class="pre">trsm</span></code> to complete a linear solver or a least-square solver.</p>
<p><strong>API of ormqr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDn library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">side</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> is on the left or right of <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">trans</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(Q)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of elementary reflections whose product defines the matrix Q.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">k</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is from <code class="docutils literal notranslate"><span class="pre">geqrf</span></code>, so i-th column contains elementary reflection vector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, lda &gt;= max(1,m); if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, lda &gt;= max(1,n).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The vector <code class="docutils literal notranslate"><span class="pre">tau</span></code> is from <code class="docutils literal notranslate"><span class="pre">geqrf</span></code>, so <code class="docutils literal notranslate"><span class="pre">tau(i)</span></code> is the scalar of i-th elementary reflection vector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">ldc</span> <span class="pre">*</span> <span class="pre">n</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">C</span></code> is overwritten by <code class="docutils literal notranslate"><span class="pre">op(Q)*C</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>. ldc &gt;= max(1,m).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the ormqr is successful. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 34%">
<col style="width: 66%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or wrong <code class="docutils literal notranslate"><span class="pre">lda</span></code> or <code class="docutils literal notranslate"><span class="pre">ldc</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-orgqr">
<h4>
<span class="section-number">2.4.2.17. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-orgqr">cusolverDn&lt;t&gt;orgqr()</a><a class="headerlink" href="index.html#cusolverdn-t-orgqr" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed. Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/orgqr">cuSOLVER Library Samples - orgqr</a> for a code example.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungqr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungqr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function overwrites <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(Q = {H(1)}*{H(2)}*{...}*{H(k)}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Q</span></code> is a unitary matrix formed by a sequence of elementary reflection vectors stored in <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">orgqr_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">geqrf</span></code>, <code class="docutils literal notranslate"><span class="pre">orgqr</span></code> to complete orthogonalization.</p>
<p><strong>API of orgqr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>. m &gt;= 0;</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>. m &gt;= n &gt;= 0;</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of elementary reflections whose product defines the matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>. n &gt;= k &gt;= 0;</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. i-th column of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains elementary reflection vector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. lda &gt;= max(1,m).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">tau(i)</span></code> is the scalar of i-th elementary reflection vector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the orgqr is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n,k&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">n&gt;m</span></code>, <code class="docutils literal notranslate"><span class="pre">k&gt;n</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;m</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-sytrf">
<h4>
<span class="section-number">2.4.2.18. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-sytrf">cusolverDn&lt;t&gt;sytrf()</a><a class="headerlink" href="index.html#cusolverdn-t-sytrf" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of the needed buffers.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsytrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsytrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCsytrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZsytrf_bufferSize</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsytrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsytrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCsytrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZsytrf</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the Bunch-Kaufman factorization of a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> symmetric indefinite matrix</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> symmetric matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> which part of the matrix is used. The function would leave other part untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular factor <code class="docutils literal notranslate"><span class="pre">L</span></code> and block diagonal matrix <code class="docutils literal notranslate"><span class="pre">D</span></code>. Each block of <code class="docutils literal notranslate"><span class="pre">D</span></code> is either 1x1 or 2x2 block, depending on pivoting.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A*P^{T} = L*D*L^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular factor <code class="docutils literal notranslate"><span class="pre">U</span></code> and block diagonal matrix <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A*P^{T} = U*D*U^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">sytrf_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If Bunch-Kaufman factorization failed, i.e. <code class="docutils literal notranslate"><span class="pre">A</span></code> is singular. The output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code> would indicate <code class="docutils literal notranslate"><span class="pre">D(i,i)=0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">devIpiv</span></code> contains pivoting sequence. If <code class="docutils literal notranslate"><span class="pre">devIpiv(i)</span> <span class="pre">=</span>                                     <span class="pre">k</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">D(i,i)</span></code> is 1x1 block, and <code class="docutils literal notranslate"><span class="pre">i-th</span></code> row/column of <code class="docutils literal notranslate"><span class="pre">A</span></code> is interchanged with <code class="docutils literal notranslate"><span class="pre">k-th</span></code> row/column of <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code> and <code class="docutils literal notranslate"><span class="pre">devIpiv(i-1)</span> <span class="pre">=</span> <span class="pre">devIpiv(i)</span> <span class="pre">=</span> <span class="pre">-m</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">D(i-1:i,i-1:i)</span></code> is a 2x2 block, and <code class="docutils literal notranslate"><span class="pre">(i-1)-th</span></code> row/column is interchanged with <code class="docutils literal notranslate"><span class="pre">m-th</span></code> row/column. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> and <code class="docutils literal notranslate"><span class="pre">devIpiv(i+1)</span> <span class="pre">=</span>                                     <span class="pre">devIpiv(i)</span> <span class="pre">=</span> <span class="pre">-m</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">D(i:i+1,i:i+1)</span></code> is a 2x2 block, and <code class="docutils literal notranslate"><span class="pre">(i+1)-th</span></code> row/column is interchanged with <code class="docutils literal notranslate"><span class="pre">m-th</span></code> row/column.</p>
<p><strong>API of sytrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">n</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working space <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the <code class="docutils literal notranslate"><span class="pre">D(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-potrfbatched">
<h4>
<span class="section-number">2.4.2.19. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-batchpotrf">cusolverDn&lt;t&gt;potrfBatched()</a><a class="headerlink" href="index.html#cusolverdn-t-potrfbatched" title="Permalink to this headline"></a>
</h4>
<p>The S and D data types are real valued single and double precision, respectively. Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/potrfBatched">cuSOLVER Library Samples - potrfBatched</a> for a code example.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotrfBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">infoArray</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotrfBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">infoArray</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotrfBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">infoArray</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotrfBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">infoArray</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the Cholesky factorization of a sequence of Hermitian positive-definite matrices.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span> <span class="pre">for</span> <span class="pre">i=0,1,...,</span> <span class="pre">batchSize-1</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, or equivalently some diagonal elements of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> is not a real number. The output parameter <code class="docutils literal notranslate"><span class="pre">infoArray</span></code> would indicate smallest leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> which is not positive definite.</p>
<p><code class="docutils literal notranslate"><span class="pre">infoArray</span></code> is an integer array of size <code class="docutils literal notranslate"><span class="pre">batchsize</span></code>. If <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>, <code class="docutils literal notranslate"><span class="pre">infoArray[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), meaning that the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code> but <code class="docutils literal notranslate"><span class="pre">infoArray[i]</span> <span class="pre">=</span> <span class="pre">k</span></code> is positive, then <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix is not positive definite and the Cholesky factorization failed at row <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<p>Remark: the other part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is used as a workspace. For example, if <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> and lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is destroyed after <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code>.</p>
<table class="table-no-stripes docutils align-default" id="id32">
<caption>
<span class="caption-text">Table 12. API of potrfBatched</span><a class="headerlink" href="index.html#id32" title="Permalink to this table"></a>
</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if lower or upper part is stored; the other part is used as a workspace.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Aarray</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of pointers to &lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store each matrix <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">infoArray</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">infoArray[i]</span></code> contains information of factorization of <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span></code>. if <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>, <code class="docutils literal notranslate"><span class="pre">infoArray[0]</span>                                                 <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) means the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code>, <code class="docutils literal notranslate"><span class="pre">infoArray[i]</span> <span class="pre">=</span>                                                 <span class="pre">0</span></code> means the Cholesky factorization of <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix is successful, and <code class="docutils literal notranslate"><span class="pre">infoArray[i]</span> <span class="pre">=</span> <span class="pre">k</span></code> means the leading submatrix of order k of <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix is not positive definite.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of pointers in <code class="docutils literal notranslate"><span class="pre">Aarray</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 31%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">batchSize&lt;1</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-potrsbatched">
<h4>
<span class="section-number">2.4.2.20. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-batchpotrs">cusolverDn&lt;t&gt;potrsBatched()</a><a class="headerlink" href="index.html#cusolverdn-t-potrsbatched" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSpotrsBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Barray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDpotrsBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Barray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCpotrsBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Barray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZpotrsBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Aarray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Barray</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a sequence of linear systems</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A\lbrack i\rbrack}*{X\lbrack i\rbrack} = {B\lbrack i\rbrack}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where each <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span> <span class="pre">for</span> <span class="pre">i=0,1,...,</span> <span class="pre">batchSize-1</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used.</p>
<p>The user has to call <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> first to factorize matrix <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span></code>. If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> corresponding to <span class="math notranslate nohighlight">\(A = L*L^{H}\)</span> . If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> corresponding to <span class="math notranslate nohighlight">\(A = U^{H}*U\)</span> .</p>
<p>The operation is in-place, i.e. matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> overwrites matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> with the same leading dimension <code class="docutils literal notranslate"><span class="pre">ldb</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> is a scalar. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Remark 1: only <code class="docutils literal notranslate"><span class="pre">nrhs=1</span></code> is supported.</p>
<p>Remark 2: <code class="docutils literal notranslate"><span class="pre">infoArray</span></code> from <code class="docutils literal notranslate"><span class="pre">potrfBatched</span></code> indicates if the matrix is positive definite. <code class="docutils literal notranslate"><span class="pre">info</span></code> from <code class="docutils literal notranslate"><span class="pre">potrsBatched</span></code> only shows which input parameter is wrong (not counting handle).</p>
<p>Remark 3: the other part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is used as a workspace. For example, if <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> and lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is destroyed after <code class="docutils literal notranslate"><span class="pre">potrsBatched</span></code>.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/potrfBatched">cuSOLVER Library Samples - potrfBatched</a> for a code example.</p>
<p><strong>API of potrsBatched</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Aarray</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of pointers to &lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span></code> is either lower Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> or upper Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store each matrix <code class="docutils literal notranslate"><span class="pre">Aarray[i]</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Barray</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of pointers to &lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. As an input, <code class="docutils literal notranslate"><span class="pre">Barray[i]</span></code> is right hand side matrix. As an output, <code class="docutils literal notranslate"><span class="pre">Barray[i]</span></code> is the solution matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store each matrix <code class="docutils literal notranslate"><span class="pre">Barray[i]</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, all parameters are correct. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of pointers in <code class="docutils literal notranslate"><span class="pre">Aarray</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">nrhs&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">batchSize&lt;0</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-eigenvalue-solver-reference-legacy">
<h3>
<span class="section-number">2.4.3. </span>Dense Eigenvalue Solver Reference (legacy)<a class="headerlink" href="index.html#dense-eigenvalue-solver-reference-legacy" title="Permalink to this headline"></a>
</h3>
<p>This chapter describes eigenvalue solver API of cuSolverDN, including bidiagonalization and SVD.</p>
<section id="cusolverdn-t-gebrd">
<h4>
<span class="section-number">2.4.3.1. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-gebrd">cusolverDn&lt;t&gt;gebrd()</a><a class="headerlink" href="index.html#cusolverdn-t-gebrd" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgebrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgebrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgebrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgebrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgebrd</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">D</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">E</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">TAUQ</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">TAUP</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">Work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgebrd</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">D</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">E</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">TAUQ</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">TAUP</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgebrd</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">D</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">E</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAUQ</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAUP</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgebrd</span><span class="p">(</span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">D</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">E</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAUQ</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">TAUP</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">Work</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">Lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function reduces a general <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to a real upper or lower bidiagonal form <code class="docutils literal notranslate"><span class="pre">B</span></code> by an orthogonal transformation: <span class="math notranslate nohighlight">\(Q^{H}*A*P = B\)</span></p>
<p>If <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is upper bidiagonal; if <code class="docutils literal notranslate"><span class="pre">m&lt;n</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is lower bidiagonal.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">P</span></code> are overwritten into matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> in the following sense:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>, the diagonal and the first superdiagonal are overwritten with the upper bidiagonal matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>; the elements below the diagonal, with the array <code class="docutils literal notranslate"><span class="pre">TAUQ</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> as a product of elementary reflectors, and the elements above the first superdiagonal, with the array <code class="docutils literal notranslate"><span class="pre">TAUP</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> as a product of elementary reflectors.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">m&lt;n</span></code>, the diagonal and the first subdiagonal are overwritten with the lower bidiagonal matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>; the elements below the first subdiagonal, with the array <code class="docutils literal notranslate"><span class="pre">TAUQ</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> as a product of elementary reflectors, and the elements above the diagonal, with the array <code class="docutils literal notranslate"><span class="pre">TAUP</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> as a product of elementary reflectors.</p></li>
</ul>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">Work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">Lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">gebrd_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Remark: <code class="docutils literal notranslate"><span class="pre">gebrd</span></code> only supports <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>.</p>
<p><strong>API of gebrd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The diagonal elements of the bidiagonal matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>: <code class="docutils literal notranslate"><span class="pre">D(i)</span>                                                 <span class="pre">=</span> <span class="pre">A(i,i)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The off-diagonal elements of the bidiagonal matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>: if <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>, <code class="docutils literal notranslate"><span class="pre">E(i)</span> <span class="pre">=</span>                                                 <span class="pre">A(i,i+1)</span></code> for <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span>                                                 <span class="pre">1,2,...,n-1</span></code>; if <code class="docutils literal notranslate"><span class="pre">m&lt;n</span></code>, <code class="docutils literal notranslate"><span class="pre">E(i)</span> <span class="pre">=</span>                                                 <span class="pre">A(i+1,i)</span></code> for <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span>                                                 <span class="pre">1,2,...,m-1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">TAUQ</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The scalar factors of the elementary reflectors which represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">TAUP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The scalar factors of the elementary reflectors which represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">Lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">Work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">gebrd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span>                                                 <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-orgbr">
<h4>
<span class="section-number">2.4.3.2. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-orgbr">cusolverDn&lt;t&gt;orgbr()</a><a class="headerlink" href="index.html#cusolverdn-t-orgbr" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgbr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgbr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungbr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungbr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgbr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgbr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungbr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungbr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function generates one of the unitary matrices <code class="docutils literal notranslate"><span class="pre">Q</span></code> or <code class="docutils literal notranslate"><span class="pre">P**H</span></code> determined by <code class="docutils literal notranslate"><span class="pre">gebrd</span></code> when reducing a matrix A to bidiagonal form: <span class="math notranslate nohighlight">\(Q^{H}*A*P = B\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">P**H</span></code> are defined as products of elementary reflectors H(i) or G(i) respectively.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">orgbr_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of orgbr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">side</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, generate Q. if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, generate P**T.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> or <code class="docutils literal notranslate"><span class="pre">P**T</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, m&gt;= n&gt;= min(m,k). if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, n&gt;= m&gt;= min(n,k).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, the number of columns in the original m-by-k matrix reduced by <code class="docutils literal notranslate"><span class="pre">gebrd</span></code>. if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, the number of rows in the original k-by-n matrix reduced by <code class="docutils literal notranslate"><span class="pre">gebrd</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> On entry, the vectors which define the elementary reflectors, as returned by <code class="docutils literal notranslate"><span class="pre">gebrd</span></code>. On exit, the m-by-n matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> or <code class="docutils literal notranslate"><span class="pre">P**T</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. lda &gt;= max(1,m);</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,k)</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>; of dimension <code class="docutils literal notranslate"><span class="pre">min(n,k)</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>; tau(i) must contain the scalar factor of the elementary reflector H(i) or G(i), which determines Q or P**T, as returned by <code class="docutils literal notranslate"><span class="pre">gebrd</span></code> in its array argument <code class="docutils literal notranslate"><span class="pre">TAUQ</span></code> or <code class="docutils literal notranslate"><span class="pre">TAUP</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the ormqr is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or wrong <code class="docutils literal notranslate"><span class="pre">lda</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-sytrd">
<h4>
<span class="section-number">2.4.3.3. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-sytrd">cusolverDn&lt;t&gt;sytrd()</a><a class="headerlink" href="index.html#cusolverdn-t-sytrd" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsytrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsytrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChetrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhetrd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsytrd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsytrd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChetrd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">CUDENSEAPI</span><span class="w"> </span><span class="n">cusolverDnZhetrd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">e</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function reduces a general symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to real symmetric tridiagonal form <code class="docutils literal notranslate"><span class="pre">T</span></code> by an orthogonal transformation: <span class="math notranslate nohighlight">\(Q^{H}*A*Q = T\)</span></p>
<p>As an output, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains <code class="docutils literal notranslate"><span class="pre">T</span></code> and householder reflection vectors. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the diagonal and first superdiagonal of <code class="docutils literal notranslate"><span class="pre">A</span></code> are overwritten by the corresponding elements of the tridiagonal matrix <code class="docutils literal notranslate"><span class="pre">T</span></code>, and the elements above the first superdiagonal, with the array <code class="docutils literal notranslate"><span class="pre">tau</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> as a product of elementary reflectors; If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the diagonal and first subdiagonal of <code class="docutils literal notranslate"><span class="pre">A</span></code> are overwritten by the corresponding elements of the tridiagonal matrix <code class="docutils literal notranslate"><span class="pre">T</span></code>, and the elements below the first subdiagonal, with the array <code class="docutils literal notranslate"><span class="pre">tau</span></code>, represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> as a product of elementary reflectors.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">sytrd_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of sytrd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, and the strictly lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not referenced. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, and the strictly upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not referenced. On exit, <code class="docutils literal notranslate"><span class="pre">A</span></code> is overwritten by <code class="docutils literal notranslate"><span class="pre">T</span></code> and householder reflection vectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">&gt;=</span> <span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The diagonal elements of the tridiagonal matrix <code class="docutils literal notranslate"><span class="pre">T</span></code>: <code class="docutils literal notranslate"><span class="pre">D(i)</span> <span class="pre">=</span>                                                 <span class="pre">A(i,i)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">(n-1)</span></code>. The off-diagonal elements of the tridiagonal matrix <code class="docutils literal notranslate"><span class="pre">T</span></code>: if <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, <code class="docutils literal notranslate"><span class="pre">E(i)</span> <span class="pre">=</span> <span class="pre">A(i,i+1)</span></code>. if <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code><code class="docutils literal notranslate"><span class="pre">E(i)</span> <span class="pre">=</span> <span class="pre">A(i+1,i)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">(n-1)</span></code>. The scalar factors of the elementary reflectors which represent the orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">sytrd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 79%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-ormtr">
<h4>
<span class="section-number">2.4.3.4. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-ormtr">cusolverDn&lt;t&gt;ormtr()</a><a class="headerlink" href="index.html#cusolverdn-t-ormtr" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSormtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDormtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCunmtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZunmtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSormtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDormtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCunmtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZunmtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasSideMode_t</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function overwrites <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">C</span></code> by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(C = \left\{ \begin{matrix}
{\text{op}(Q)*C} &amp; {\text{if~}\textsf{side\ ==\ CUBLAS\_SIDE\_LEFT}} \\
{C*\text{op}(Q)} &amp; {\text{if~}\textsf{side\ ==\ CUBLAS\_SIDE\_RIGHT}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Q</span></code> is a unitary matrix formed by a sequence of elementary reflection vectors from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>.</p>
<p>The operation on <code class="docutils literal notranslate"><span class="pre">Q</span></code> is defined by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\text{op}(Q) = \left\{ \begin{matrix}
Q &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_N}} \\
Q^{T} &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_T}} \\
Q^{H} &amp; {\text{if~}\textsf{transa\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">ormtr_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of ormtr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">side</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, apply Q or Q**T from the Left; <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, apply Q or Q**T from the Right.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains elementary reflectors from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains elementary reflectors from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">trans</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(Q)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">m</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>; <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code> contains the elementary reflectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>, lda &gt;= max(1,m); if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>, lda &gt;= max(1,n).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">(m-1)</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_LEFT</span></code>; of dimension <code class="docutils literal notranslate"><span class="pre">(n-1)</span></code> if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_SIDE_RIGHT</span></code>; The vector <code class="docutils literal notranslate"><span class="pre">tau</span></code> is from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>, so <code class="docutils literal notranslate"><span class="pre">tau(i)</span></code> is the scalar of i-th elementary reflection vector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">ldc</span> <span class="pre">*</span> <span class="pre">n</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">C</span></code> is overwritten by <code class="docutils literal notranslate"><span class="pre">op(Q)*C</span></code> or <code class="docutils literal notranslate"><span class="pre">C*op(Q)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array of matrix <code class="docutils literal notranslate"><span class="pre">C</span></code>. ldc &gt;= max(1,m).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the ormqr is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 34%">
<col style="width: 66%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or wrong <code class="docutils literal notranslate"><span class="pre">lda</span></code> or <code class="docutils literal notranslate"><span class="pre">ldc</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-orgtr">
<h4>
<span class="section-number">2.4.3.5. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-orgtr">cusolverDn&lt;t&gt;orgtr()</a><a class="headerlink" href="index.html#cusolverdn-t-orgtr" title="Permalink to this headline"></a>
</h4>
<p>These helper functions calculate the size of work buffers needed.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungtr_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSorgtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDorgtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCungtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZungtr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function generates a unitary matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> which is defined as the product of n-1 elementary reflectors of order n, as returned by <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>:</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">orgtr_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p><strong>API of orgtr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains elementary reflectors from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains elementary reflectors from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (columns) of matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> On entry, matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> from <code class="docutils literal notranslate"><span class="pre">sytrd</span></code> contains the elementary reflectors. On exit, matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the n-by-n orthogonal matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. lda &gt;= max(1,n).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">(n-1)</span></code><code class="docutils literal notranslate"><span class="pre">tau(i)</span></code> is the scalar of i-th elementary reflection vector.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of working array <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the orgtr is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or wrong <code class="docutils literal notranslate"><span class="pre">lda</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-gesvd">
<h4>
<span class="section-number">2.4.3.6. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-gesvd">cusolverDn&lt;t&gt;gesvd()</a><a class="headerlink" href="index.html#cusolverdn-t-gesvd" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvd</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">rwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvd</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvd</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">rwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvd</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the singular value decomposition (SVD) of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and/or right singular vectors. The SVD is written</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">gesvd_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">bdsqr</span></code> did not converge, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> specifies how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rwork</span></code> is real array of dimension (min(m,n)-1). If <code class="docutils literal notranslate"><span class="pre">devInfo</span></code>&gt;0 and <code class="docutils literal notranslate"><span class="pre">rwork</span></code> is not NULL, <code class="docutils literal notranslate"><span class="pre">rwork</span></code> contains the unconverged superdiagonal elements of an upper bidiagonal matrix. This is slightly different from LAPACK which puts unconverged superdiagonal elements in <code class="docutils literal notranslate"><span class="pre">work</span></code> if type is <code class="docutils literal notranslate"><span class="pre">real</span></code>; in <code class="docutils literal notranslate"><span class="pre">rwork</span></code> if type is <code class="docutils literal notranslate"><span class="pre">complex</span></code>. <code class="docutils literal notranslate"><span class="pre">rwork</span></code> can be a NULL pointer if the user does not want the information from superdiagonal.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/gesvd">cuSOLVER Library Samples - gesvd</a> for a code example.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvd</span></code> only supports <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>.</p>
<p>Remark 2: the routine returns <span class="math notranslate nohighlight">\(V^{H}\)</span> , not <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p><strong>API of gesvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>: = ‘A’: all m columns of U are returned in array U: = ‘S’: the first min(m,n) columns of U (the left singular vectors) are returned in the array U; = ‘O’: the first min(m,n) columns of U (the left singular vectors) are overwritten on the array A; = ‘N’: no columns of U (no left singular vectors) are computed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix V**T: = ‘A’: all N rows of V**T are returned in the array VT; = ‘S’: the first min(m,n) rows of V**T (the right singular vectors) are returned in the array VT; = ‘O’: the first min(m,n) rows of V**T (the right singular vectors) are overwritten on the array A; = ‘N’: no rows of V**T (no right singular vectors) are computed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> with <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">VT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldvt</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">ldvt</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">VT</span></code> contains the <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix V**T.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Vt</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">gesvd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">rwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Real array of dimension min(m,n)-1. It contains the unconverged superdiagonal elements of an upper bidiagonal matrix if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> indicates how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 74%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldvt&lt;max(1,n)</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdngesvd-deprecated">
<h4>
<span class="section-number">2.4.3.7. </span>cusolverDnGesvd()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdngesvd-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnGesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnGesvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the singular value decomposition (SVD) of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and/or right singular vectors. The SVD is written</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">bdsqr</span></code> did not converge, <code class="docutils literal notranslate"><span class="pre">info</span></code> specifies how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnGesvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>Appendix G.5 provides a simple example of <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd</span></code>.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvd</span></code> only supports <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>.</p>
<p>Remark 2: the routine returns <span class="math notranslate nohighlight">\(V^{H}\)</span> , not <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd</span></code>:</p>
<p><strong>API of cusolverDnGesvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>: = ‘A’: all m columns of U are returned in array U: = ‘S’: the first min(m,n) columns of U (the left singular vectors) are returned in the array U; = ‘O’: the first min(m,n) columns of U (the left singular vectors) are overwritten on the array A; = ‘N’: no columns of U (no left singular vectors) are computed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix V**T: = ‘A’: all N rows of V**T are returned in the array VT; = ‘S’: the first min(m,n) rows of V**T (the right singular vectors) are returned in the array VT; = ‘O’: the first min(m,n) rows of V**T (the right singular vectors) are overwritten on the array A; = ‘N’: no rows of V**T (no right singular vectors) are computed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> with <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeVT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">VT</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">VT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldvt</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">ldvt</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">VT</span></code> contains the <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix V**T.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Vt</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code> is data type of the vector <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeVT</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">VT</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnGesvd</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeS</strong></p></th>
<th class="head"><p><strong>DataTypeU</strong></p></th>
<th class="head"><p><strong>DataTypeVT</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGESVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGESVD</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGESVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGESVD</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 74%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldvt&lt;max(1,n)</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-gesvdj">
<h4>
<span class="section-number">2.4.3.8. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-gesvdj">cusolverDn&lt;t&gt;gesvdj()</a><a class="headerlink" href="index.html#cusolverdn-t-gesvdj" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the singular value decomposition (SVD) of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and/or right singular vectors. The SVD is written:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> has the same functionality as <code class="docutils literal notranslate"><span class="pre">gesvd</span></code>. The difference is that <code class="docutils literal notranslate"><span class="pre">gesvd</span></code> uses QR algorithm and <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> uses Jacobi method. The parallelism of Jacobi method gives GPU better performance on small and medium size matrices. Moreover the user can configure <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> to perform approximation up to certain accuracy.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> iteratively generates a sequence of unitary matrices to transform matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to the following form</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(U^{H}*A*V = S + E\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">S</span></code> is diagonal and diagonal of <code class="docutils literal notranslate"><span class="pre">E</span></code> is zero.</p>
<p>During the iterations, the Frobenius norm of <code class="docutils literal notranslate"><span class="pre">E</span></code> decreases monotonically. As <code class="docutils literal notranslate"><span class="pre">E</span></code> goes down to zero, <code class="docutils literal notranslate"><span class="pre">S</span></code> is the set of singular values. In practice, Jacobi method stops if</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({||E||}_{F}\leq\operatorname{eps}*{||A||}_{F}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">eps</span></code> is given tolerance.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> has two parameters to control the accuracy. First parameter is tolerance (<code class="docutils literal notranslate"><span class="pre">eps</span></code>). The default value is machine accuracy but The user can use function <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdjSetTolerance</span></code> to set a priori tolerance. The second parameter is maximum number of sweeps which controls number of iterations of Jacobi method. The default value is 100 but the user can use function <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdjSetMaxSweeps</span></code> to set a proper bound. The experiments show 15 sweeps are good enough to converge to machine accuracy. <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> stops either tolerance is met or maximum number of sweeps is met.</p>
<p>Jacobi method has quadratic convergence, so the accuracy is not proportional to number of sweeps. To guarantee certain accuracy, the user should configure tolerance only.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">gesvdj_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> does not converge under given tolerance and maximum sweeps.</p>
<p>If the user sets an improper tolerance, <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> may not converge. For example, tolerance should not be smaller than machine accuracy.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/gesvdj">cuSOLVER Library Samples - gesvdj</a> for a code example.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> supports any combination of <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>Remark 2: the routine returns <code class="docutils literal notranslate"><span class="pre">V</span></code>, not <span class="math notranslate nohighlight">\(V^{H}\)</span> . This is different from <code class="docutils literal notranslate"><span class="pre">gesvd</span></code>.</p>
<p><strong>API of gesvdj</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute singular value only or singular vectors as well: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute singular values only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute singular values and singular vectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">econ</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">econ</span></code> = 1 for economy size for <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> if <code class="docutils literal notranslate"><span class="pre">econ</span></code> is zero. If <code class="docutils literal notranslate"><span class="pre">econ</span></code> is nonzero, the dimension is <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">min(m,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the left singular vectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">*</span> <span class="pre">n</span></code> if <code class="docutils literal notranslate"><span class="pre">econ</span></code> is zero. If <code class="docutils literal notranslate"><span class="pre">econ</span></code> is nonzero, the dimension is <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">*</span> <span class="pre">min(m,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">V</span></code> contains the right singular vectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">V</span></code>. <code class="docutils literal notranslate"><span class="pre">ldv</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>, working space.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">gesvdj_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> dose not converge under given tolerance and maximum sweeps.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure filled with parameters of Jacobi algorithm and results of <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code>. <code class="docutils literal notranslate"><span class="pre">params</span></code> can be destroyed after the host thread exits the routine.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 84%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldv&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-gesvdjbatched">
<h4>
<span class="section-number">2.4.3.9. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-gesvdjbatch">cusolverDn&lt;t&gt;gesvdjBatched()</a><a class="headerlink" href="index.html#cusolverdn-t-gesvdjbatched" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">gesvdjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes singular values and singular vectors of a sequence of general <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrices</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j} = U_{j}*\Sigma_{j}*V_{j}^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(\Sigma_{j}\)</span> is a real <code class="docutils literal notranslate"><span class="pre">m×n</span></code> diagonal matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements. <span class="math notranslate nohighlight">\(U_{j}\)</span> (left singular vectors) is a <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix and <span class="math notranslate nohighlight">\(V_{j}\)</span> (right singular vectors) is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <span class="math notranslate nohighlight">\(\Sigma_{j}\)</span> are the singular values of <span class="math notranslate nohighlight">\(A_{j}\)</span> in either descending order or non-sorting order.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> performs <code class="docutils literal notranslate"><span class="pre">gesvdj</span></code> on each matrix. It requires that all matrices are of the same size <code class="docutils literal notranslate"><span class="pre">m,n</span></code> no greater than 32 and are packed in contiguous way,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{A0} &amp; {A1} &amp; \cdots \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Each matrix is column-major with leading dimension <code class="docutils literal notranslate"><span class="pre">lda</span></code>, so the formula for random access is <span class="math notranslate nohighlight">\(A_{k}\operatorname{(i,j)} = {A\lbrack\ i\ +\ lda*j\ +\ lda*n*k\rbrack}\)</span> .</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">S</span></code> also contains singular values of each matrix in contiguous way,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(S = \begin{pmatrix}
{S0} &amp; {S1} &amp; \cdots \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The formula for random access of <code class="docutils literal notranslate"><span class="pre">S</span></code> is <span class="math notranslate nohighlight">\(S_{k}\operatorname{(j)} = {S\lbrack\ j\ +\ min(m,n)*k\rbrack}\)</span> .</p>
<p>Except for tolerance and maximum sweeps, <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> can either sort the singular values in descending order (default) or chose as-is (without sorting) by the function <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdjSetSortEig</span></code>. If the user packs several tiny matrices into diagonal blocks of one matrix, non-sorting option can separate singular values of those tiny matrices.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> cannot report residual and executed sweeps by function <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdjGetResidual</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdjGetSweeps</span></code>. Any call of the above two returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code>. The user needs to compute residual explicitly.</p>
<p>The user has to provide working space pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">gesvdjBatched_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> is an integer array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If the function returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>, the first element <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> does not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix under given tolerance and maximum sweeps.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/gesvdjBatched">cuSOLVER Library Samples - gesvdjBatched</a> for a code example.</p>
<p><strong>API of gesvdjBatched</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute singular value only or singular vectors as well: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute singular values only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute singular values and singular vectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. <code class="docutils literal notranslate"><span class="pre">m</span></code> is no greater than 32.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. <code class="docutils literal notranslate"><span class="pre">n</span></code> is no greater than 32.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">batchSize</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. on Exit: the contents of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Lading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Areal array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)*batchSize</span></code>. It stores the singular values of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> in descending order or non-sorting order.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span> <span class="pre">*</span> <span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">Uj</span></code> contains the left singular vectors of <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Uj</span></code>. <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">*</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">Vj</span></code> contains the right singular vectors of <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Vj</span></code>. <code class="docutils literal notranslate"><span class="pre">ldv</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>, working space.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">gesvdjBatched_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>An integer array of dimension <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code> is returned, <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdjBatched</span></code> dose not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix under given tolerance and maximum sweeps.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure filled with parameters of Jacobi algorithm. <code class="docutils literal notranslate"><span class="pre">params</span></code> can be destroyed after the host thread exits the routine.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of matrices.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 85%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldv&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> , or <code class="docutils literal notranslate"><span class="pre">batchSize&lt;0</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-gesvdastridedbatched">
<h4>
<span class="section-number">2.4.3.10. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-gesvda">cusolverDn&lt;t&gt;gesvdaStridedBatched()</a><a class="headerlink" href="index.html#cusolverdn-t-gesvdastridedbatched" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdaStridedBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdaStridedBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdaStridedBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdaStridedBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSgesvdaStridedBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_R_nrmF</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDgesvdaStridedBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_R_nrmF</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCgesvdaStridedBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_R_nrmF</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZgesvdaStridedBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">strideV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_R_nrmF</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function <code class="docutils literal notranslate"><span class="pre">gesvda</span></code> (<code class="docutils literal notranslate"><span class="pre">a</span></code> stands for approximate) approximates the singular value decomposition of a tall skinny <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and right singular vectors. The economy form of SVD is written by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix. <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvda</span></code> computes eigenvalues of <code class="docutils literal notranslate"><span class="pre">A**T*A</span></code>, or <code class="docutils literal notranslate"><span class="pre">A**H*A</span></code> (if <code class="docutils literal notranslate"><span class="pre">A</span></code> is complex), to approximate singular values and singular vectors. It generates matrices <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> and transforms the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to the following form</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(U^{H}*A*V = S + E\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">S</span></code> is diagonal and <code class="docutils literal notranslate"><span class="pre">E</span></code> depends on rounding errors. To certain conditions, <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">V</span></code> and <code class="docutils literal notranslate"><span class="pre">S</span></code> approximate singular values and singular vectors up to machine zero of single precision. In general, <code class="docutils literal notranslate"><span class="pre">V</span></code> is unitary, <code class="docutils literal notranslate"><span class="pre">S</span></code> is more accurate than <code class="docutils literal notranslate"><span class="pre">U</span></code>. If singular value is far from zero, then left singular vector <code class="docutils literal notranslate"><span class="pre">U</span></code> is accurate. In other words, the accuracy of singular values and left singular vectors depend on the distance between singular value and zero.</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">rank</span></code> decides the number of singular values and singular vectors are computed in parameter <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">h_RnrmF</span></code> computes Frobenius norm of residual.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A - U*S*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>if the parameter <code class="docutils literal notranslate"><span class="pre">rank</span></code> is equal <code class="docutils literal notranslate"><span class="pre">n</span></code>. Otherwise, <code class="docutils literal notranslate"><span class="pre">h_RnrmF</span></code> reports</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({||}U*S*V^{H}{||} - {||S||}\)</span></p></td>
</tr>
</tbody>
</table>
<p>in Frobenius norm sense, that is, how far <code class="docutils literal notranslate"><span class="pre">U</span></code> is from unitary.</p>
<p><code class="docutils literal notranslate"><span class="pre">gesvdaStridedBatched</span></code> performs <code class="docutils literal notranslate"><span class="pre">gesvda</span></code> on each matrix. It requires that all matrices are of the same size <code class="docutils literal notranslate"><span class="pre">m,n</span></code> and are packed in a contiguous way,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{A0} &amp; {A1} &amp; \cdots \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Each matrix is column-major with leading dimension <code class="docutils literal notranslate"><span class="pre">lda</span></code>, so the formula for random access is <span class="math notranslate nohighlight">\(A_{k}\operatorname{(i,j)} = {A\lbrack\ i\ +\ lda*j\ +\ strideA*k\rbrack}\)</span> . Similarly, the formula for random access of <code class="docutils literal notranslate"><span class="pre">S</span></code> is <span class="math notranslate nohighlight">\(S_{k}\operatorname{(j)} = {S\lbrack\ j\ +\ StrideS*k\rbrack}\)</span> , the formula for random access of <code class="docutils literal notranslate"><span class="pre">U</span></code> is <span class="math notranslate nohighlight">\(U_{k}\operatorname{(i,j)} = {U\lbrack\ i\ +\ ldu*j\ +\ strideU*k\rbrack}\)</span> and the formula for random access of <code class="docutils literal notranslate"><span class="pre">V</span></code> is <span class="math notranslate nohighlight">\(V_{k}\operatorname{(i,j)} = {V\lbrack\ i\ +\ ldv*j\ +\ strideV*k\rbrack}\)</span> .</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">gesvdaStridedBatched_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> is an integer array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If the function returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>, the first element <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdaStridedBatched</span></code> does not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix under given tolerance.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/gesvdaStridedBatched">cuSOLVER Library Samples - gesvdaStridedBatched</a> for a code example.</p>
<p>Remark 1: the routine returns <code class="docutils literal notranslate"><span class="pre">V</span></code>, not <span class="math notranslate nohighlight">\(V^{H}\)</span> . This is different from <code class="docutils literal notranslate"><span class="pre">gesvd</span></code>.</p>
<p>Remark 2: if the user is confident on the accuracy of singular values and singular vectors, for example, certain conditions hold (required singular value is far from zero), then the performance can be improved by passing a null pointer to <code class="docutils literal notranslate"><span class="pre">h_RnrmF</span></code>, i.e. no computation of residual norm.</p>
<p><strong>API of gesvda</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute singular value only or singular vectors as well: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute singular values only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute singular values and singular vectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">rank</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of singular values (from largest to smallest).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">strideA</span> <span class="pre">*</span> <span class="pre">batchSize</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">Aj</span></code> is of dimension <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">strideA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of type long long int that gives the address offset between <code class="docutils literal notranslate"><span class="pre">A[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">A[i+1]</span></code>. <code class="docutils literal notranslate"><span class="pre">strideA</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">lda*n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">strideS*batchSize</span></code>. It stores the singular values of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> in descending order. <code class="docutils literal notranslate"><span class="pre">Sj</span></code> is of dimension <code class="docutils literal notranslate"><span class="pre">rank</span> <span class="pre">*</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">strideS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of type long long int that gives the address offset between <code class="docutils literal notranslate"><span class="pre">S[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">S[i+1]</span></code>. <code class="docutils literal notranslate"><span class="pre">strideS</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">rank</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">strideU</span> <span class="pre">*</span> <span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">Uj</span></code> contains the left singular vectors of <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. <code class="docutils literal notranslate"><span class="pre">Uj</span></code> is of dimension <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">rank</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Uj</span></code>. <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">strideU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of type long long int that gives the address offset between <code class="docutils literal notranslate"><span class="pre">U[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">U[i+1]</span></code>. <code class="docutils literal notranslate"><span class="pre">strideU</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">ldu*rank</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">strideV</span> <span class="pre">*</span> <span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">Vj</span></code> contains the right singular vectors of <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. <code class="docutils literal notranslate"><span class="pre">Vj</span></code> is of dimension <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">rank</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Vj</span></code>. <code class="docutils literal notranslate"><span class="pre">ldv</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">strideV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Value of type long long int that gives the address offset between <code class="docutils literal notranslate"><span class="pre">V[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">V[i+1]</span></code>. <code class="docutils literal notranslate"><span class="pre">strideV</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">ldv*rank</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>, working space.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">gesvdaStridedBatched_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>An integer array of dimension <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code> is returned, <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">min(m,n)+1</span></code>, <code class="docutils literal notranslate"><span class="pre">gesvdaStridedBatched</span></code> dose not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_RnrmF</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;double&gt; array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. <code class="docutils literal notranslate"><span class="pre">h_RnrmF[i]</span></code> is norm of residual of <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of matrices. <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> is not less than 1.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 89%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldv&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">strideA&lt;lda*n</span></code> or <code class="docutils literal notranslate"><span class="pre">strideS&lt;rank</span></code> or <code class="docutils literal notranslate"><span class="pre">strideU&lt;ldu*rank</span></code> or <code class="docutils literal notranslate"><span class="pre">strideV&lt;ldv*rank</span></code> or <code class="docutils literal notranslate"><span class="pre">batchSize&lt;1</span></code> or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-syevd">
<h4>
<span class="section-number">2.4.3.11. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-syevd">cusolverDn&lt;t&gt;syevd()</a><a class="headerlink" href="index.html#cusolverdn-t-syevd" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">syevd_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/syevd">cuSOLVER Library Samples - syevd</a> for a code example.</p>
<p><strong>API of syevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">syevd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero;</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnsyevd-deprecated">
<h4>
<span class="section-number">2.4.3.12. </span>cusolverDnSyevd()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdnsyevd-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnSyevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnSyevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the generic API interface. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnSyevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd</span></code>:</p>
<p><strong>API of cusolverDnSyevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 93%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Memory</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">In/out</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">W</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span>  <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero;</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevd</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ComputeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYEVD</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHEEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZHEEVD</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-syevdx">
<h4>
<span class="section-number">2.4.3.13. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-syevdx">cusolverDn&lt;t&gt;syevdx()</a><a class="headerlink" href="index.html#cusolverdn-t-syevdx" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The standard symmetric eigenvalue problem is:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> unitary matrix. <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is the number of eigenvalues/eigenvectors computed by the routine, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">n</span></code> when the whole spectrum (e.g., <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>) is requested. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">syevdx_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/syevdx">cuSOLVER Library Samples - syevdx</a> for a code example.</p>
<p><strong>API of syevdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed: <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> : all eigenvalues/eigenvectors in the half-open interval (vl,vu] will be found; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code> : the il-th through iu-th eigenvalues/eigenvectors will be found;</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.<code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than<code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">vl,vu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Real values float or double for (C, S) or (Z, D) precision respectively. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>, the lower and upper bounds of the interval to be searched for eigenvalues. vl &gt; vu. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>. Note that, if eigenvalues are very close to each other, it is well known that two different eigenvalues routines might find slightly different number of eigenvalues inside the same interval. This is due to the fact that different eigenvalue algorithms, or even same algorithm but different run might find eigenvalues within some rounding error close to the machine precision. Thus, if the user wants to be sure not to miss any eigenvalue within the interval bound, we suggest that the user subtract/add epsilon (machine precision) to the interval bound such as <code class="docutils literal notranslate"><span class="pre">(vl=vl-eps,</span> <span class="pre">vu=vu+eps]</span></code>. This suggestion is valid for any selective routine from cuSolver or LAPACK.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">il,iu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Integer. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, the indices (in ascending order) of the smallest and largest eigenvalues to be returned. 1 &lt;= il &lt;= <code class="docutils literal notranslate"><span class="pre">iu</span></code> &lt;= n, if <code class="docutils literal notranslate"><span class="pre">n</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">il</span></code> = 1 and <code class="docutils literal notranslate"><span class="pre">iu</span></code> = 0 if <code class="docutils literal notranslate"><span class="pre">n</span></code> = 0. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_meig</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Integer. The total number of eigenvalues found. 0 &lt;= <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> &lt;= n. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> = n, and if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> = <code class="docutils literal notranslate"><span class="pre">iu-il</span></code>+1.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">syevdx_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">range</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnsyevdx-deprecated">
<h4>
<span class="section-number">2.4.3.14. </span>cusolverDnSyevdx()[DEPRECATED]<a class="headerlink" href="index.html#cusolverdnsyevdx-deprecated" title="Permalink to this headline"></a>
</h4>
<p>[[DEPRECATED]] use <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx()</span></code> instead. The routine will be removed in the next major release.</p>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnSyevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">cusolverDnSyevdx</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>computes all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the generic API interface. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> unitary matrix. <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is the number of eigenvalues/eigenvectors computed by the routine, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">n</span></code> when the whole spectrum (e.g., <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>) is requested. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is size in bytes of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnSyevdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx</span></code>:</p>
<p><strong>API of cusolverDnSyevdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 95%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Memory</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">In/out</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed: <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> : all eigenvalues/eigenvectors in the half-open interval (vl,vu] will be found; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code> : the il-th through iu-th eigenvalues/eigenvectors will be found;</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.<code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than<code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">vl,vu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>, the lower and upper bounds of the interval to be searched for eigenvalues. vl &gt; vu. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>. Note that, if eigenvalues are very close to each other, it is well known that two different eigenvalues routines might find slightly different number of eigenvalues inside the same interval. This is due to the fact that different eigenvalue algorithms, or even same algorithm but different run might find eigenvalues within some rounding error close to the machine precision. Thus, if the user want to be sure not to miss any eigenvalue within the interval bound, we suggest that, the user subtract/add epsilon (machine precision) to the interval bound such as (vl=vl-eps, vu=vu+eps]. this suggestion is valid for any selective routine from cuSolver or LAPACK.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">il,iu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Integer. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, the indices (in ascending order) of the smallest and largest eigenvalues to be returned. 1 &lt;= il &lt;= iu &lt;= n, if n &gt; 0; il = 1 and iu = 0 if n = 0. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_meig</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Integer. The total number of eigenvalues found. 0 &lt;= h_meig &lt;= n. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>, h_meig = n, and if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, h_meig = iu-il+1.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">W</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span>  <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero;</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnSyevdx</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ComputeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYEVDX</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYEVDX</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHEEVDX</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZHEEVDX</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">range</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-sygvd">
<h4>
<span class="section-number">2.4.3.15. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-sygvd">cusolverDn&lt;t&gt;sygvd()</a><a class="headerlink" href="index.html#cusolverdn-t-sygvd" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix-pair (<code class="docutils literal notranslate"><span class="pre">A</span></code>,<code class="docutils literal notranslate"><span class="pre">B</span></code>). The generalized symmetric-definite eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({eig(A,B)} = \left\{ \begin{matrix}
{A*V = B*V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_1}} \\
{A*B*V = V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_2}} \\
{B*A*V = V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_3}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>where the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> is positive definite. <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>) in ascending order. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> orthogonal matrix. The eigenvectors are normalized as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\left\{ \begin{matrix}
{V^{H}*B*V = I} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_1,\ CUSOLVER\_EIG\_TYPE\_2}} \\
{V^{H}*{inv(B)}*V = I} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_3}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">sygvd_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code> (i &gt; 0 and i&lt;=n) and <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_NOVECTOR, <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">N</span> <span class="pre">+</span> <span class="pre">i</span></code> (i &gt; 0), then the leading minor of order <code class="docutils literal notranslate"><span class="pre">i</span></code> of <code class="docutils literal notranslate"><span class="pre">B</span></code> is not positive definite. The factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code> could not be completed and no eigenvalues or eigenvectors were computed.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthogonal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by divide and conquer algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/sygvd">cuSOLVER Library Samples - sygvd</a> for a code example.</p>
<p><strong>API of sygvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">itype</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td>
<p>Specifies the problem type to be solved:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x.</p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> is less than <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is overwritten by triangular factor <code class="docutils literal notranslate"><span class="pre">U</span></code> or <code class="docutils literal notranslate"><span class="pre">L</span></code> from the Cholesky factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&gt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">sygvd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> indicates either <code class="docutils literal notranslate"><span class="pre">potrf</span></code> or <code class="docutils literal notranslate"><span class="pre">syevd</span></code> is wrong.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">itype</span></code> is not 1, 2 or 3, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not ‘N’ or ‘V’, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-sygvdx">
<h4>
<span class="section-number">2.4.3.16. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-sygvdx">cusolverDn&lt;t&gt;sygvdx()</a><a class="headerlink" href="index.html#cusolverdn-t-sygvdx" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix-pair (<code class="docutils literal notranslate"><span class="pre">A</span></code>,<code class="docutils literal notranslate"><span class="pre">B</span></code>). The generalized symmetric-definite eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({eig(A,B)} = \left\{ \begin{matrix}
{A*V = B*V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_1}} \\
{A*B*V = V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_2}} \\
{B*A*V = V*\Lambda} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_3}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>where the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> is positive definite. <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> diagonal matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>) in ascending order. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> orthogonal matrix. <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is the number of eigenvalues/eigenvectors computed by the routine, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">n</span></code> when the whole spectrum (e.g., <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>) is requested. The eigenvectors are normalized as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\left\{ \begin{matrix}
{V^{H}*B*V = I} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_1,\ CUSOLVER\_EIG\_TYPE\_2}} \\
{V^{H}*{inv(B)}*V = I} &amp; {\text{if~}\textsf{itype\ =\ CUSOLVER\_EIG\_TYPE\_3}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">sygvdx_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span></code> (i &gt; 0 and i&lt;=n) and <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_NOVECTOR, <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">n</span>                                     <span class="pre">+</span> <span class="pre">i</span></code> (i &gt; 0), then the leading minor of order <code class="docutils literal notranslate"><span class="pre">i</span></code> of <code class="docutils literal notranslate"><span class="pre">B</span></code> is not positive definite. The factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code> could not be completed and no eigenvalues or eigenvectors were computed.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthogonal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by divide and conquer algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/sygvdx">cuSOLVER Library Samples - sygvdx</a> for a code example.</p>
<p><strong>API of sygvdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 95%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">itype</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td>
<p>Specifies the problem type to be solved:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x</p></li>
</ul>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed: <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> : all eigenvalues/eigenvectors in the half-open interval <code class="docutils literal notranslate"><span class="pre">(vl,vu]</span></code> will be found; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code> : the il-th through iu-th eigenvalues/eigenvectors will be found;</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> is less than <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is overwritten by triangular factor <code class="docutils literal notranslate"><span class="pre">U</span></code> or <code class="docutils literal notranslate"><span class="pre">L</span></code> from the Cholesky factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">vl,vu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Real values float or double for (C, S) or (Z, D) precision respectively. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>, the lower and upper bounds of the interval to be searched for eigenvalues. vl &gt; vu. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>. Note that, if eigenvalues are very close to each other, it is well known that two different eigenvalues routines might find slightly different number of eigenvalues inside the same interval. This is due to the fact that different eigenvalue algorithms, or even same algorithm but different run might find eigenvalues within some rounding error close to the machine precision. Thus, if the user want to be sure not to miss any eigenvalue within the interval bound, we suggest that, the user subtract/add epsilon (machine precision) to the interval bound such as (<code class="docutils literal notranslate"><span class="pre">vl</span></code>=<code class="docutils literal notranslate"><span class="pre">vl</span></code>-<code class="docutils literal notranslate"><span class="pre">eps</span></code>, <code class="docutils literal notranslate"><span class="pre">vu</span></code>=<code class="docutils literal notranslate"><span class="pre">vu</span></code>+<code class="docutils literal notranslate"><span class="pre">eps</span></code>]. this suggestion is valid for any selective routine from cuSolver or LAPACK.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">il,iu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Integer. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, the indices (in ascending order) of the smallest and largest eigenvalues to be returned. 1 &lt;= <code class="docutils literal notranslate"><span class="pre">il</span></code> &lt;= <code class="docutils literal notranslate"><span class="pre">iu</span></code> &lt;= <code class="docutils literal notranslate"><span class="pre">n</span></code>, if <code class="docutils literal notranslate"><span class="pre">n</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">il</span></code> = 1 and <code class="docutils literal notranslate"><span class="pre">iu</span></code> = 0 if <code class="docutils literal notranslate"><span class="pre">n</span></code> = 0. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_meig</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Integer. The total number of eigenvalues found. 0 &lt;= h_meig &lt;= n. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>, h_meig = n, and if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, h_meig = iu-il+1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&gt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">sygvdx_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">devInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">devInfo</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">devInfo</span></code> indicates either <code class="docutils literal notranslate"><span class="pre">potrf</span></code> or <code class="docutils literal notranslate"><span class="pre">syevd</span></code> is wrong.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 92%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">itype</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_1</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_2</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_TYPE_3</span></code> or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTORL</span></code>, or <code class="docutils literal notranslate"><span class="pre">range</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-syevj">
<h4>
<span class="section-number">2.4.3.17. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-syevj">cusolverDn&lt;t&gt;syevj()</a><a class="headerlink" href="index.html#cusolverdn-t-syevj" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*Q = Q*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">Q</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p><code class="docutils literal notranslate"><span class="pre">syevj</span></code> has the same functionality as <code class="docutils literal notranslate"><span class="pre">syevd</span></code>. The difference is that <code class="docutils literal notranslate"><span class="pre">syevd</span></code> uses QR algorithm and <code class="docutils literal notranslate"><span class="pre">syevj</span></code> uses Jacobi method. The parallelism of Jacobi method gives GPU better performance on small and medium size matrices. Moreover the user can configure <code class="docutils literal notranslate"><span class="pre">syevj</span></code> to perform approximation up to certain accuracy.</p>
<p>How does it work?</p>
<p><code class="docutils literal notranslate"><span class="pre">syevj</span></code> iteratively generates a sequence of unitary matrices to transform matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to the following form</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(V^{H}*A*V = W + E\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">W</span></code> is diagonal and <code class="docutils literal notranslate"><span class="pre">E</span></code> is symmetric without diagonal.</p>
<p>During the iterations, the Frobenius norm of <code class="docutils literal notranslate"><span class="pre">E</span></code> decreases monotonically. As <code class="docutils literal notranslate"><span class="pre">E</span></code> goes down to zero, <code class="docutils literal notranslate"><span class="pre">W</span></code> is the set of eigenvalues. In practice, Jacobi method stops if</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({||E||}_{F}\leq\operatorname{eps}*{||A||}_{F}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">eps</span></code> is the given tolerance.</p>
<p><code class="docutils literal notranslate"><span class="pre">syevj</span></code> has two parameters to control the accuracy. First parameter is tolerance (<code class="docutils literal notranslate"><span class="pre">eps</span></code>). The default value is machine accuracy but The user can use function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjSetTolerance</span></code> to set a priori tolerance. The second parameter is maximum number of sweeps which controls number of iterations of Jacobi method. The default value is 100 but the user can use function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjSetMaxSweeps</span></code> to set a proper bound. The experiments show 15 sweeps are good enough to converge to machine accuracy. <code class="docutils literal notranslate"><span class="pre">syevj</span></code> stops either tolerance is met or maximum number of sweeps is met.</p>
<p>The Jacobi method has quadratic convergence, so the accuracy is not proportional to number of sweeps. To guarantee certain accuracy, the user should configure tolerance only.</p>
<p>After <code class="docutils literal notranslate"><span class="pre">syevj</span></code>, the user can query residual by function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjGetResidual</span></code> and number of executed sweeps by function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjGetSweeps</span></code>. However the user needs to be aware that residual is the Frobenius norm of <code class="docutils literal notranslate"><span class="pre">E</span></code>, not accuracy of individual eigenvalue, i.e.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({residual}={||E||}_{F} = {{||}\Lambda - W{||}}_{F}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The same as <code class="docutils literal notranslate"><span class="pre">syevd</span></code>, the user has to provide working space pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">syevj_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">n+1</span></code>, <code class="docutils literal notranslate"><span class="pre">syevj</span></code> does not converge under given tolerance and maximum sweeps.</p>
<p>If the user sets an improper tolerance, <code class="docutils literal notranslate"><span class="pre">syevj</span></code> may not converge. For example, tolerance should not be smaller than machine accuracy.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/syevj">cuSOLVER Library Samples - syevj</a> for a code example.</p>
<p><strong>API of syevj</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">syevj_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">n+1</span></code>, <code class="docutils literal notranslate"><span class="pre">syevj</span></code> does not converge under given tolerance and maximum sweeps.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Structure filled with parameters of Jacobi algorithm and results of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-sygvj">
<h4>
<span class="section-number">2.4.3.18. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-sygvj">cusolverDn&lt;t&gt;sygvj()</a><a class="headerlink" href="index.html#cusolverdn-t-sygvj" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvj_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsygvj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsygvj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnChegvj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZhegvj</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigType_t</span><span class="w"> </span><span class="n">itype</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix-pair (<code class="docutils literal notranslate"><span class="pre">A</span></code>,<code class="docutils literal notranslate"><span class="pre">B</span></code>). The generalized symmetric-definite eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({eig(A,B)} = \left\{ \begin{matrix}
{A*V = B*V*\Lambda} &amp; {\text{if }\textsf{itype = CUSOLVER_EIG_TYPE_1}} \\
{A*B*V = V*\Lambda} &amp; {\text{if }\textsf{itype = CUSOLVER_EIG_TYPE_2}} \\
{B*A*V = V*\Lambda} &amp; {\text{if }\textsf{itype = CUSOLVER_EIG_TYPE_3}} \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>where the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> is positive definite. <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>) in ascending order. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> orthogonal matrix. The eigenvectors are normalized as follows:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\left\{ \begin{matrix}
{V^{H}*B*V = I} &amp; {\text{if }\textsf{itype = CUSOLVER_EIG_TYPE_1, CUSOLVER_EIG_TYPE_2}} \\
{V^{H}*{inv(B)}*V = I} &amp; {\text{if }\textsf{itype = CUSOLVER_EIG_TYPE_3}}      \\
\end{matrix} \right.\)</span></p></td>
</tr>
</tbody>
</table>
<p>This function has the same functionality as <code class="docutils literal notranslate"><span class="pre">sygvd</span></code> except that <code class="docutils literal notranslate"><span class="pre">syevd</span></code> in <code class="docutils literal notranslate"><span class="pre">sygvd</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">syevj</span></code> in <code class="docutils literal notranslate"><span class="pre">sygvj</span></code>. Therefore, <code class="docutils literal notranslate"><span class="pre">sygvj</span></code> inherits properties of <code class="docutils literal notranslate"><span class="pre">syevj</span></code>, the user can use <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjSetTolerance</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjSetMaxSweeps</span></code> to configure tolerance and maximum sweeps.</p>
<p>However the meaning of residual is different from <code class="docutils literal notranslate"><span class="pre">syevj</span></code>. <code class="docutils literal notranslate"><span class="pre">sygvj</span></code> first computes Cholesky factorization of matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(B = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>transform the problem to standard eigenvalue problem, then calls <code class="docutils literal notranslate"><span class="pre">syevj</span></code>.</p>
<p>For example, the standard eigenvalue problem of type I is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(M*Q = Q*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where matrix <code class="docutils literal notranslate"><span class="pre">M</span></code> is symmetric</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(M = L^{-1}*A*L^{-H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The residual is the result of <code class="docutils literal notranslate"><span class="pre">syevj</span></code> on matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>, not <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide working space which is pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">sygvj_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (i &gt; 0 and i&lt;=n), <code class="docutils literal notranslate"><span class="pre">B</span></code> is not positive definite, the factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code> could not be completed and no eigenvalues or eigenvectors were computed. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">n+1</span></code>, <code class="docutils literal notranslate"><span class="pre">syevj</span></code> does not converge under given tolerance and maximum sweeps. In this case, the eigenvalues and eigenvectors are still computed because non-convergence comes from improper tolerance of maximum sweeps.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthogonal eigenvectors <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/sygvj">cuSOLVER Library Samples - sygvj</a> for a code example.</p>
<p><strong>API of sygvj</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">itype</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies the problem type to be solved: <code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x. <code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x. <code class="docutils literal notranslate"><span class="pre">itype</span></code>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">info</span></code> is less than <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is overwritten by triangular factor <code class="docutils literal notranslate"><span class="pre">U</span></code> or <code class="docutils literal notranslate"><span class="pre">L</span></code> from the Cholesky factorization of <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&gt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Working space, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">sygvj_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates either <code class="docutils literal notranslate"><span class="pre">B</span></code> is not positive definite or <code class="docutils literal notranslate"><span class="pre">syevj</span></code> (called by <code class="docutils literal notranslate"><span class="pre">sygvj</span></code>) does not converge.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 88%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">itype</span></code> is not 1, 2 or 3, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdn-t-syevjbatched">
<h4>
<span class="section-number">2.4.3.19. </span><a class="reference external" href="index.html#cuSolverDN-lt-t-gt-syevjbatch">cusolverDn&lt;t&gt;syevjBatched()</a><a class="headerlink" href="index.html#cusolverdn-t-syevjbatched" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevjBatched_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnSsyevjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnDsyevjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnCheevjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnZheevjBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">syevjInfo_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a sequence of symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrices</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j}*Q_{j} = Q_{j}*\Lambda_{j}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(\Lambda_{j}\)</span> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. <span class="math notranslate nohighlight">\(Q_{j}\)</span> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <span class="math notranslate nohighlight">\(\Lambda_{j}\)</span> are the eigenvalues of <span class="math notranslate nohighlight">\(A_{j}\)</span> in either ascending order or non-sorting order.</p>
<p><code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> performs <code class="docutils literal notranslate"><span class="pre">syevj</span></code> on each matrix. It requires that all matrices are of the same size <code class="docutils literal notranslate"><span class="pre">n</span></code> and are packed in contiguous way,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{A0} &amp; {A1} &amp; \cdots \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Each matrix is column-major with leading dimension <code class="docutils literal notranslate"><span class="pre">lda</span></code>, so the formula for random access is <span class="math notranslate nohighlight">\(A_{k}\operatorname{(i,j)} = {A\lbrack\ i\ +\ lda*j\ +\ lda*n*k\rbrack}\)</span> .</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">W</span></code> also contains eigenvalues of each matrix in contiguous way,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(W = \begin{pmatrix}
{W0} &amp; {W1} &amp; \cdots \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The formula for random access of <code class="docutils literal notranslate"><span class="pre">W</span></code> is <span class="math notranslate nohighlight">\(W_{k}\operatorname{(j)} = {W\lbrack\ j\ +\ n*k\rbrack}\)</span> .</p>
<p>Except for tolerance and maximum sweeps, <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> can either sort the eigenvalues in ascending order (default) or chose as-is (without sorting) by the function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjSetSortEig</span></code>. If the user packs several tiny matrices into diagonal blocks of one matrix, non-sorting option can separate spectrum of those tiny matrices.</p>
<p><code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> cannot report residual and executed sweeps by function <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjGetResidual</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevjGetSweeps</span></code>. Any call of the above two returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code>. The user needs to compute residual explicitly.</p>
<p>The user has to provide working space pointed by input parameter <code class="docutils literal notranslate"><span class="pre">work</span></code>. The input parameter <code class="docutils literal notranslate"><span class="pre">lwork</span></code> is the size of the working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">syevjBatched_bufferSize()</span></code>. Please note that the size in bytes of the working space is equal to <code class="docutils literal notranslate"><span class="pre">sizeof(&lt;type&gt;)</span> <span class="pre">*</span> <span class="pre">lwork</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> is an integer array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If the function returns <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>, the first element <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">n+1</span></code>, <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> does not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix under given tolerance and maximum sweeps.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <span class="math notranslate nohighlight">\(A_{j}\)</span> contains the orthonormal eigenvectors <span class="math notranslate nohighlight">\(V_{j}\)</span> .</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/syevjBatched">cuSOLVER Library Samples - syevjBatched</a> for a code example.</p>
<p><strong>API of syevjBatched</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> is stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix each <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">batchSize</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info[j]</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">Aj</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n*batchSize</span></code>. It stores the eigenvalues of <code class="docutils literal notranslate"><span class="pre">Aj</span></code> in ascending order or non-sorting order.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>, workspace.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">work</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">syevjBatched_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>An integer array of dimension <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. If <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code> is returned, <code class="docutils literal notranslate"><span class="pre">info[0]</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero) indicates <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). Otherwise, if <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info[i]</span> <span class="pre">=</span> <span class="pre">n+1</span></code>, <code class="docutils literal notranslate"><span class="pre">syevjBatched</span></code> does not converge on <code class="docutils literal notranslate"><span class="pre">i-th</span></code> matrix under given tolerance and maximum sweeps.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Structure filled with parameters of Jacobi algorithm.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of matrices.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 87%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>), or <code class="docutils literal notranslate"><span class="pre">batchSize&lt;0</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-linear-solver-reference-64-bit-api">
<h3>
<span class="section-number">2.4.4. </span>Dense Linear Solver Reference (64-bit API)<a class="headerlink" href="index.html#dense-linear-solver-reference-64-bit-api" title="Permalink to this headline"></a>
</h3>
<p>This section describes linear solver 64-bit API of cuSolverDN, including Cholesky factorization, LU with partial pivoting and QR factorization.</p>
<section id="cusolverdnxpotrf">
<h4>
<span class="section-number">2.4.4.1. </span>cusolverDnXpotrf()<a class="headerlink" href="index.html#cusolverdnxpotrf" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXpotrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXpotrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the Cholesky factorization of a Hermitian positive-definite matrix using the generic API interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf_bufferSize()</span></code>.</p>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, or equivalently some diagonal elements of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> is not a real number. The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> would indicate smallest leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> which is not positive definite.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf</span></code> supports only the default algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xpotrf">cuSOLVER Library Samples - Xpotrf</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXpotrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf</span></code>:</p>
<p><strong>API of potrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code>, the leading minor of order <code class="docutils literal notranslate"><span class="pre">i</span></code> is not positive definite.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxpotrs">
<h4>
<span class="section-number">2.4.4.2. </span>cusolverDnXpotrs()<a class="headerlink" href="index.html#cusolverdnxpotrs" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXpotrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a system of linear equations</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful using the generic API interface. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>The user has to call <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrf</span></code> first to factorize matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> corresponding to <span class="math notranslate nohighlight">\(A = L*L^{H}\)</span> . If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code> corresponding to <span class="math notranslate nohighlight">\(A = U^{H}*U\)</span> .</p>
<p>The operation is in-place, i.e. matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> overwrites matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> with the same leading dimension <code class="docutils literal notranslate"><span class="pre">ldb</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrs</span></code> supports only the default algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xpotrf">cuSOLVER Library Samples - Xpotrf</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXpotrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrs</span></code>:</p>
<p><strong>API of potrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">A</span></code> is either lower Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code> or upper Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code>. <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. As an input, <code class="docutils literal notranslate"><span class="pre">B</span></code> is right hand side matrix. As an output, <code class="docutils literal notranslate"><span class="pre">B</span></code> is the solution matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverDnXpotrs</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 36%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>dataTypeA</strong></p></th>
<th class="head"><p><strong>dataTypeB</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">nrhs&lt;0</span></code>, <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgetrf">
<h4>
<span class="section-number">2.4.4.3. </span>cusolverDnXgetrf()<a class="headerlink" href="index.html#cusolverdnxgetrf" title="Permalink to this headline"></a>
</h4>
<p>The helper function below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">cusolverDnXgetrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The function below</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgetrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the LU factorization of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">P</span></code> is a permutation matrix, <code class="docutils literal notranslate"><span class="pre">L</span></code> is a lower triangular matrix with unit diagonal, and <code class="docutils literal notranslate"><span class="pre">U</span></code> is an upper triangular matrix using the generic API interface.</p>
<p>If LU factorization failed, i.e. matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> (<code class="docutils literal notranslate"><span class="pre">U</span></code>) is singular, The output parameter <code class="docutils literal notranslate"><span class="pre">info=i</span></code> indicates <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> is null, no pivoting is performed. The factorization is <code class="docutils literal notranslate"><span class="pre">A=L*U</span></code>, which is not numerically stable.</p>
<p>No matter LU factorization failed or not, the output parameter <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> contains pivoting sequence, row <code class="docutils literal notranslate"><span class="pre">i</span></code> is interchanged with row <code class="docutils literal notranslate"><span class="pre">ipiv(i)</span></code>.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf_bufferSize()</span></code>.</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnGetrs</span></code> to complete a linear solver.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code> supports two algorithms. To select legacy implementation, the user has to call <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgetrf">cuSOLVER Library Samples - Xgetrf</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXgetrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm. The fastest, requires a large workspace of <code class="docutils literal notranslate"><span class="pre">m*n</span></code> elements.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_1</span></code></p></td>
<td><p>Legacy implementation</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code>:</p>
<p><strong>API of cusolverDnXgetrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code>, the <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code> only supports the following four combinations.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgetrs">
<h4>
<span class="section-number">2.4.4.4. </span>cusolverDnXgetrs()<a class="headerlink" href="index.html#cusolverdnxgetrs" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgetrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a linear system of multiple right-hand sides</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({op(A)}*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix, and was LU-factored by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code>, that is, lower triangular part of A is <code class="docutils literal notranslate"><span class="pre">L</span></code>, and upper triangular part (including diagonal elements) of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">U</span></code>. <code class="docutils literal notranslate"><span class="pre">B</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×nrhs</span></code> right-hand side matrix using the generic API interface.</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">trans</span></code> is defined by</p>
<p><span class="math notranslate nohighlight">\(\text{op}(A) = \left\{ \begin{matrix}
A &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_N}} \\
A^{T} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_T}} \\
A^{H} &amp; {\text{if~}\textsf{trans\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">ipiv</span></code> is an output of <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code>. It contains pivot indices, which are used to permutate right-hand sides.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user can combine <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrf</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrs</span></code> to complete a linear solver.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrs</span></code> supports only the default algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgetrf">cuSOLVER Library Samples - Xgetrf</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXgetrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrs</span></code>:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">trans</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(A)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right-hand sides.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">n</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>&lt;type&gt; array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code> with <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types: <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgetrs</span></code> only supports the following four combinations:</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 36%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>dataTypeB</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 31%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldb&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgeqrf">
<h4>
<span class="section-number">2.4.4.5. </span>cusolverDnXgeqrf()<a class="headerlink" href="index.html#cusolverdnxgeqrf" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgeqrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">cusolverDnXgeqrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the QR factorization of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = Q*R\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">Q</span></code> is a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix, and <code class="docutils literal notranslate"><span class="pre">R</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> upper triangular matrix using the generic API interface.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf_bufferSize()</span></code>.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> is overwritten in upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>, including diagonal elements.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> is not formed explicitly, instead, a sequence of householder vectors are stored in lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code>. The leading nonzero element of householder vector is assumed to be 1 such that output parameter <code class="docutils literal notranslate"><span class="pre">TAU</span></code> contains the scaling factor <code class="docutils literal notranslate"><span class="pre">τ</span></code>. If <code class="docutils literal notranslate"><span class="pre">v</span></code> is original householder vector, <code class="docutils literal notranslate"><span class="pre">q</span></code> is the new householder vector corresponding to <code class="docutils literal notranslate"><span class="pre">τ</span></code>, satisfying the following relation</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(I - 2*v*v^{H} = I - \tau*q*q^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf</span></code> supports only the default algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgeqrf">cuSOLVER Library Samples - Xgeqrf</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXgeqrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf</span></code>:</p>
<p><strong>API of geqrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeTau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">tau</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension at least <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the QR factorization is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeTau</span></code> is data type of the array <code class="docutils literal notranslate"><span class="pre">tau</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgeqrf</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGEQRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGEQRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGEQRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGEQRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 64%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsytrs">
<h4>
<span class="section-number">2.4.4.6. </span>cusolverDnXsytrs()<a class="headerlink" href="index.html#cusolverdnxsytrs" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffers.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnXsytrs_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverDnXsytrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">ipiv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>solves a system of linear equations using the generic API interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> contains the factorization from <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrf()</span></code>, only lower or upper part is meaningful, the other part is not touched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the details of the factorization are stores as:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*D*L^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the details of the factorization are stores as:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*D*U^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide the pivot indices that can be obtained by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrf()</span></code> as well as device and host work spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> are sizes in bytes of the device and host work spaces, and they are returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs</span></code>:</p>
<p><strong>API of sytrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of right-hand sides.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ipiv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of size at least <code class="docutils literal notranslate"><span class="pre">n</span></code>, containing pivot indices.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldb</span> <span class="pre">*</span> <span class="pre">nrhs</span></code> with <code class="docutils literal notranslate"><span class="pre">ldb</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,nrhs)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldb</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the leading minor of order i is not positive definite.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has two different types: <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverDnXsytrs</span></code> only supports the following four combinations:</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 36%">
<col style="width: 36%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeB</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYTRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CSYTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZSYTRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 43%">
<col style="width: 57%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>Data type is not supported.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxtrtri">
<h4>
<span class="section-number">2.4.4.7. </span>cusolverDnXtrtri()<a class="headerlink" href="index.html#cusolverdnxtrtri" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffers.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnXtrtri_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasDiagType_t</span><span class="w"> </span><span class="n">diag</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverDnXtrtri</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasDiagType_t</span><span class="w"> </span><span class="n">diag</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>computes the inverse of a triangular matrix using the generic API interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> triangular matrix, only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other part untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular inverse.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular inverse.</p>
<p>The user has to provide device and host work spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> are sizes in bytes of the device and host work spaces, and they are returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXtrtri_bufferSize()</span></code>.</p>
<p>If matrix inversion fails, the output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> shows <code class="docutils literal notranslate"><span class="pre">A(i,i)</span> <span class="pre">=</span>                                     <span class="pre">0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xtrtri">cuSOLVER Library Samples - Xtrtri</a> for a code example.</p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXtrtri_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXtrtri</span></code>:</p>
<p><strong>API of trtri</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 74%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">diag</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The enumerated unit diagonal type.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXtrtri_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXtrtri_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the matrix inversion succeeded. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">A(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Valid data types</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 56%">
<col style="width: 44%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">DataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meaning</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRTRI</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DTRTRI</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CTRTRI</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZTRTRI</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 37%">
<col style="width: 63%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_SUPPORTED</span></code></p></td>
<td><p>Data type is not supported.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxlarft">
<span id="id16"></span><h4>
<span class="section-number">2.4.4.8. </span>cusolverDnXlarft()<a class="headerlink" href="index.html#cusolverdnxlarft" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">cusolverDnXlarft_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDirectMode_t</span><span class="w"> </span><span class="n">direct</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverStorevMode_t</span><span class="w"> </span><span class="n">storev</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeV</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeT</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">cusolverDnXlarft</span><span class="p">(</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverDirectMode_t</span><span class="w"> </span><span class="n">direct</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cusolverStorevMode_t</span><span class="w"> </span><span class="n">storev</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeV</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeTau</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tau</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeT</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>forms the triangular factor <code class="docutils literal notranslate"><span class="pre">T</span></code> of a real block reflector <code class="docutils literal notranslate"><span class="pre">H</span></code> of order <code class="docutils literal notranslate"><span class="pre">n</span></code>, which is defined as a product of <code class="docutils literal notranslate"><span class="pre">k</span></code> elementary reflectors.
If:</p>
<blockquote>
<div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">direct</span> <span class="pre">==</span> <span class="pre">CUBLAS_DIRECT_FORWARD</span></code>: <span class="math notranslate nohighlight">\(H = H(1) H(2) ... H(k)\)</span> and <code class="docutils literal notranslate"><span class="pre">T</span></code> is upper triangular;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direct</span> <span class="pre">==</span> <span class="pre">CUBLAS_DIRECT_BACKWARD</span></code>: <span class="math notranslate nohighlight">\(H = H(k) ... H(2) H(1)\)</span> and <code class="docutils literal notranslate"><span class="pre">T</span></code> is lower triangular.</p></li>
</ul>
</div>
</blockquote>
<p>Only <code class="docutils literal notranslate"><span class="pre">storev</span> <span class="pre">==</span> <span class="pre">CUBLAS_STOREV_COLUMNWISE</span></code> is supported, which indicates that the vector defining the elementary reflector <code class="docutils literal notranslate"><span class="pre">H(i)</span></code> is stored in the i-th column of the array <code class="docutils literal notranslate"><span class="pre">V</span></code>, and <span class="math notranslate nohighlight">\(H = I - V * T * V^{T}\)</span> (<span class="math notranslate nohighlight">\(H = I - V * T * V^{H}\)</span> for complex types).</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXlarft_bufferSize()</span></code>.</p>
<p>Currently, only <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;=</span> <span class="pre">k</span></code> scenario is supported.</p>
<p><strong>API of larft</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">direct</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies the order in which the elementary reflectors are multiplied to form the block reflector.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">storev</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies how the vectors which define the elementary reflectors are stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The order of the block reflector <code class="docutils literal notranslate"><span class="pre">H</span></code>. <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The order of the triangular factor <code class="docutils literal notranslate"><span class="pre">T</span></code> (= the number of elementary reflectors). <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The matrix <code class="docutils literal notranslate"><span class="pre">V</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">k</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of the array <code class="docutils literal notranslate"><span class="pre">V</span></code>. <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">&gt;=</span> <span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeTau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">tau</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tau</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Dimension <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">tau(i)</span></code> must contain the scalar factor of the elementary reflector <code class="docutils literal notranslate"><span class="pre">H(i)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Dimension <code class="docutils literal notranslate"><span class="pre">ldt</span> <span class="pre">*</span> <span class="pre">k</span></code>. The <code class="docutils literal notranslate"><span class="pre">k×k</span></code> triangular factor <code class="docutils literal notranslate"><span class="pre">T</span></code> of the block reflector. If <code class="docutils literal notranslate"><span class="pre">direct</span> <span class="pre">==</span> <span class="pre">CUBLAS_DIRECT_FORWARD</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code> is upper triangular; if <code class="docutils literal notranslate"><span class="pre">direct</span> <span class="pre">==</span> <span class="pre">CUBLAS_DIRECT_BACKWARD</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code> is lower triangular.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The leading dimension of the array <code class="docutils literal notranslate"><span class="pre">T</span></code>. <code class="docutils literal notranslate"><span class="pre">ldt</span> <span class="pre">&gt;=</span> <span class="pre">k</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXlarft_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXlarft_bufferSize</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has four different types:</p>
<blockquote>
<div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code> is data type of the array <code class="docutils literal notranslate"><span class="pre">V</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataTypeTau</span></code> is data type of the array <code class="docutils literal notranslate"><span class="pre">tau</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataTypeT</span></code> is data type of the array <code class="docutils literal notranslate"><span class="pre">T</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation</p></li>
</ul>
</div>
</blockquote>
<p><code class="docutils literal notranslate"><span class="pre">cusolverDnXlarft</span></code> only supports the following four combinations.</p>
<p><strong>Valid combinations of data types and compute types</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeV</strong></p></th>
<th class="head"><p><strong>DataTypeTau</strong></p></th>
<th class="head"><p><strong>DataTypeT</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SLARFT</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DLARFT</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CLARFT</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZLARFT</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">==</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&gt;</span> <span class="pre">n</span></code>, or <code class="docutils literal notranslate"><span class="pre">storev</span> <span class="pre">==</span> <span class="pre">CUBLAS_STOREV_ROWWISE</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-eigenvalue-solver-reference-64-bit-api">
<h3>
<span class="section-number">2.4.5. </span>Dense Eigenvalue Solver Reference (64-bit API)<a class="headerlink" href="index.html#dense-eigenvalue-solver-reference-64-bit-api" title="Permalink to this headline"></a>
</h3>
<p>This section describes eigenvalue solver API of cuSolverDN, including bidiagonalization and SVD.</p>
<section id="cusolverdnxgesvd">
<h4>
<span class="section-number">2.4.5.1. </span>cusolverDnXgesvd()<a class="headerlink" href="index.html#cusolverdnxgesvd" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">VT</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the singular value decomposition (SVD) of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and/or right singular vectors. The SVD is written</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). if <code class="docutils literal notranslate"><span class="pre">bdsqr</span></code> did not converge, <code class="docutils literal notranslate"><span class="pre">info</span></code> specifies how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnXgesvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgesvd">cuSOLVER Library Samples - Xgesvd</a> for a code example.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvd</span></code> only supports <code class="docutils literal notranslate"><span class="pre">m&gt;=n</span></code>.</p>
<p>Remark 2: the routine returns <span class="math notranslate nohighlight">\(V^{H}\)</span> , not <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd</span></code>:</p>
<p><strong>API of cusolverDnXgesvd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 88%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>: = ‘A’: all m columns of U are returned in array U: = ‘S’: the first min(m,n) columns of U (the left singular vectors) are returned in the array U; = ‘O’: the first min(m,n) columns of U (the left singular vectors) are overwritten on the array A; = ‘N’: no columns of U (no left singular vectors) are computed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix V**T: = ‘A’: all N rows of V**T are returned in the array VT; = ‘S’: the first min(m,n) rows of V**T (the right singular vectors) are returned in the array VT; = ‘O’: the first min(m,n) rows of V**T (the right singular vectors) are overwritten on the array A; = ‘N’: no rows of V**T (no right singular vectors) are computed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> with <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeVT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">VT</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">VT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldvt</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">ldvt</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">VT</span></code> contains the <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix V**T.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldvt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">Vt</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates how many superdiagonals of an intermediate bidiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code> is data type of the vector <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeVT</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">VT</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeS</strong></p></th>
<th class="head"><p><strong>DataTypeU</strong></p></th>
<th class="head"><p><strong>DataTypeVT</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGESVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGESVD</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGESVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGESVD</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 74%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldvt&lt;max(1,n)</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdp">
<h4>
<span class="section-number">2.4.5.2. </span>cusolverDnXgesvdp()<a class="headerlink" href="index.html#cusolverdnxgesvdp" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdp_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdp</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">econ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">S</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeU</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeV</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">V</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">d_info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_err_sigma</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the singular value decomposition (SVD) of a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and corresponding the left and/or right singular vectors. The SVD is written</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix which is zero except for its <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp</span></code> combines polar decomposition in [14] and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd</span></code> to compute SVD. It is much faster than <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvd</span></code> which is based on QR algorithm. However polar decomposition in [14] may not deliver a full unitary matrix when the matrix A has a singular value close to zero. To workaround the issue when the singular value is close to zero, we add a small perturbation so polar decomposition can deliver the correct result. The consequence is inaccurate singular values shifted by this perturbation. The output parameter <code class="docutils literal notranslate"><span class="pre">h_err_sigma</span></code> is the magnitude of this perturbation. In other words, <code class="docutils literal notranslate"><span class="pre">h_err_sigma</span></code> shows the accuracy of SVD.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnXgesvdp</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgesvdp">cuSOLVER Library Samples - Xgesvdp</a> for a code example.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvdp</span></code> supports <code class="docutils literal notranslate"><span class="pre">n&gt;=m</span></code> as well.</p>
<p>Remark 2: the routine returns <code class="docutils literal notranslate"><span class="pre">V</span></code>, not <span class="math notranslate nohighlight">\(V^{H}\)</span></p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp</span></code>:</p>
<p><strong>API of cusolverDnXgesvdp</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td>
<p>Specifies options to either compute singular values only or compute singular vectors as well:</p>
<p><code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute singular values only.</p>
<p><code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute singular values and singular vectors.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">econ</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">econ</span> <span class="pre">=</span> <span class="pre">1</span></code> for economy size for <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> with <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. If <code class="docutils literal notranslate"><span class="pre">econ=1</span></code>, only reports first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">ldv</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">V</span></code> contains the <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix V. if <code class="docutils literal notranslate"><span class="pre">econ=1</span></code>, only reports first <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code> columns of <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_err_sigma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Magnitude of the perturbation, showing the accuracy of SVD.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code> is data type of the vector <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">V</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdp</span></code> only supports the following four combinations:</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeS</strong></p></th>
<th class="head"><p><strong>DataTypeU</strong></p></th>
<th class="head"><p><strong>DataTypeV</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGESVDP</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGESVDP</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGESVDP</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGESVDP</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 74%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldv&lt;max(1,n)</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxgesvdr">
<h4>
<span class="section-number">2.4.5.3. </span>cusolverDnXgesvdr()<a class="headerlink" href="index.html#cusolverdnxgesvdr" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdr_bufferSize</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">niters</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeSrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Srand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeUrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Urand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldUrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Vrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldVrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The routine below</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXgesvdr</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">signed</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">niters</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeSrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Srand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w">  </span><span class="n">dataTypeUrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Urand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldUrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeVrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">Vrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">ldVrand</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">d_info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the approximated rank-k singular value decomposition (k-SVD) of an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and the corresponding left and/or right singular vectors. The k-SVD is written as</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{k}\approx U*\Sigma*V^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Σ</span></code> is a <code class="docutils literal notranslate"><span class="pre">k×k</span></code> matrix which is zero except for its diagonal elements, <code class="docutils literal notranslate"><span class="pre">U</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×k</span></code> orthonormal matrix, and <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">k×n</span></code> orthonormal matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Σ</span></code> are the approximated singular values of <code class="docutils literal notranslate"><span class="pre">A</span></code>; they are real and non-negative, and are returned in descending order. The columns of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are the top-<code class="docutils literal notranslate"><span class="pre">k</span></code> left and right singular vectors of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code> implements randomized methods described in [15] to compute k-SVD that is accurate with high probability if the conditions described in [15] hold. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code> is intended to compute a very small portion of the spectrum (meaning that <code class="docutils literal notranslate"><span class="pre">k</span></code> is very small compared to <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>). of <code class="docutils literal notranslate"><span class="pre">A</span></code> fast and with good quality, specially when the dimensions of the matrix are large.</p>
<p>The accuracy of the method depends on the spectrum of <code class="docutils literal notranslate"><span class="pre">A</span></code>, the number of power iterations <code class="docutils literal notranslate"><span class="pre">niters</span></code>, the oversampling parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> and the ratio between <code class="docutils literal notranslate"><span class="pre">p</span></code> and the dimensions of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. Larger values of oversampling <code class="docutils literal notranslate"><span class="pre">p</span></code> or larger number of iterations <code class="docutils literal notranslate"><span class="pre">niters</span></code> might produce more accurate approximations, but it will also increase the run time of <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code>.</p>
<p>Our recommendation is to use two iterations and set the oversampling to at least <code class="docutils literal notranslate"><span class="pre">2k</span></code>. Once the solver provides enough accuracy, adjust the values of <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">niters</span></code> for better performance.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnXgesvdr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xgesvdr">cuSOLVER Library Samples - Xgesvdr</a> for a code example.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">gesvdr</span></code> supports <code class="docutils literal notranslate"><span class="pre">n&gt;=m</span></code> as well.</p>
<p>Remark 2: the routine returns <code class="docutils literal notranslate"><span class="pre">V</span></code>, not <span class="math notranslate nohighlight">\(V^{H}\)</span></p>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code>:</p>
<p><strong>API of cusolverDnXgesvdr</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 11%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>: = ‘S’: the first k columns of U (the left singular vectors) are returned in the array U; = ‘N’: no columns of U (no left singular vectors) are computed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options for computing all or part of the matrix V: = ‘S’: the first k rows of V (the right singular vectors) are returned in the array V; = ‘N’: no rows of V (no right singular vectors) are computed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Rank of the k-SVD decomposition of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">rank</span></code> is less than <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Oversampling. The size of the subspace will be <code class="docutils literal notranslate"><span class="pre">(k</span> <span class="pre">+</span> <span class="pre">p)</span></code>. <code class="docutils literal notranslate"><span class="pre">(k+p)</span></code> is less than <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">niters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of iteration of power method.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. On exit, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Real array of dimension <code class="docutils literal notranslate"><span class="pre">min(m,n)</span></code>. The singular values of A, sorted so that <code class="docutils literal notranslate"><span class="pre">S(i)</span> <span class="pre">&gt;=</span> <span class="pre">S(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldu</span> <span class="pre">*</span> <span class="pre">m</span></code> with <code class="docutils literal notranslate"><span class="pre">ldu</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,m)</span></code>. <code class="docutils literal notranslate"><span class="pre">U</span></code> contains the <code class="docutils literal notranslate"><span class="pre">m×m</span></code> unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. if <code class="docutils literal notranslate"><span class="pre">jobu=S</span></code>, only reports first min(m,n) columns of <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">ldu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">ldv</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">ldv</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. <code class="docutils literal notranslate"><span class="pre">V</span></code> contains the <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix V. If <code class="docutils literal notranslate"><span class="pre">jobv=S</span></code>, only reports first min(m,n) columns of <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">d_info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p></td>
</tr>
</tbody>
</table>
<p>The generic API has five different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeS</span></code> is data type of the vector <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeU</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeV</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">V</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXgesvdr</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeS</strong></p></th>
<th class="head"><p><strong>DataTypeU</strong></p></th>
<th class="head"><p><strong>DataTypeV</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGESVDR</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGESVDR</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGESVDR</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGESVDR</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 74%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldu&lt;max(1,m)</span></code> or <code class="docutils literal notranslate"><span class="pre">ldv&lt;max(1,n)</span></code> ).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevd">
<h4>
<span class="section-number">2.4.5.4. </span>cusolverDnXsyevd()<a class="headerlink" href="index.html#cusolverdnxsyevd" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the generic API interface. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×n</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xsyevd">cuSOLVER Library Samples - Xsyevd</a> for a code example.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd</span></code> supports only the default algorithm.</p>
<p><strong>Table of algorithms supported by cusolverDnXsyevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd</span></code>:</p>
<p><strong>API of cusolverDnXsyevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">W</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order, i.e., sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevd</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeW</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYEVD</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHEEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZHEEVD</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverdnxsyevdx">
<h4>
<span class="section-number">2.4.5.5. </span>cusolverDnXsyevdx()<a class="headerlink" href="index.html#cusolverdnxsyevdx" title="Permalink to this headline"></a>
</h4>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverDnXsyevdx_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">h_meig</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytesOnHost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="n">cusolverDnXsyevdx</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverDnParams_t</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigRange_t</span><span class="w"> </span><span class="n">range</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">meig64</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnDevice</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">bufferOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">workspaceInBytesOnHost</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">n×n</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the generic API interface. The standard symmetric eigenvalue problem is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×h_meig</span></code> unitary matrix. <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is the number of eigenvalues/eigenvectors computed by the routine, <code class="docutils literal notranslate"><span class="pre">h_meig</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">n</span></code> when the whole spectrum (e.g., <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>) is requested. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p>The user has to provide device and host working spaces which are pointed by input parameters <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code> and <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>. The input parameters <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> (and <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code>) is size in bytes of the device (and host) working space, and it is returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx</span></code> supports only the default algorithm.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/Xsyevdx">cuSOLVER Library Samples - Xsyevdx</a> for a code example.</p>
<p><strong>Table of algorithms supported by cusolverDnXsyevdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 63%">
<col style="width: 38%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_ALG_0</span></code> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p>Default algorithm.</p></td>
</tr>
</tbody>
</table>
<p>List of input arguments for <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx_bufferSize</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx</span></code>:</p>
<p><strong>API of cusolverDnXsyevdx</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverDN library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Structure with information collected by <code class="docutils literal notranslate"><span class="pre">cusolverDnSetAdvOptions</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to either compute eigenvalue only or compute eigen-pair: <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only; <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed: <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> : all eigenvalues/eigenvectors in the half-open interval (vl,vu] will be found; <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code> : the il-th through iu-th eigenvalues/eigenvectors will be found;</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored. <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of dimension <code class="docutils literal notranslate"><span class="pre">lda</span> <span class="pre">*</span> <span class="pre">n</span></code> with <code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than <code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading n-by-n upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading n-by-n lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lda</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Leading dimension of two-dimensional array used to store matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.<code class="docutils literal notranslate"><span class="pre">lda</span></code> is not less than<code class="docutils literal notranslate"><span class="pre">max(1,n)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">vl,vu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>, the lower and upper bounds of the interval to be searched for eigenvalues. vl &gt; vu. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>. Note that, if eigenvalues are very close to each other, it is well known that two different eigenvalues routines might find slightly different number of eigenvalues inside the same interval. This is due to the fact that different eigenvalue algorithms, or even same algorithm but different run might find eigenvalues within some rounding error close to the machine precision. Thus, if the user want to be sure not to miss any eigenvalue within the interval bound, we suggest that, the user subtract/add epsilon (machine precision) to the interval bound such as (vl=vl-eps, vu=vu+eps]. this suggestion is valid for any selective routine from cuSolver or LAPACK.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">il,iu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Integer. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, the indices (in ascending order) of the smallest and largest eigenvalues to be returned. 1 &lt;= il &lt;= iu &lt;= n, if n &gt; 0; il = 1 and iu = 0 if n = 0. Not referenced if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_meig</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Integer. The total number of eigenvalues found. 0 &lt;= h_meig &lt;= n. If <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code>, h_meig = n, and if <code class="docutils literal notranslate"><span class="pre">range</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, h_meig = iu-il+1.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of array <code class="docutils literal notranslate"><span class="pre">W</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">n</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">A</span></code>, in ascending order, i.e., sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span> <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p>Data type of computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Device workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnDevice</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnDevice</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Host workspace. Array of type <code class="docutils literal notranslate"><span class="pre">void</span></code> of size <code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code> bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytesOnHost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size in bytes of <code class="docutils literal notranslate"><span class="pre">bufferOnHost</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx_bufferSize</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful. if <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p></td>
</tr>
</tbody>
</table>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation. <code class="docutils literal notranslate"><span class="pre">cusolverDnXsyevdx</span></code> only supports the following four combinations:</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeW</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYEVDX</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYEVDX</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHEEVDX</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZHEEVDX</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,n)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">range</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_ALL</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_V</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_RANGE_I</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="cusolversp-sparse-lapack-function-reference">
<h2>
<span class="section-number">2.5. </span>cuSolverSP: sparse LAPACK Function Reference<a class="headerlink" href="index.html#cusolversp-sparse-lapack-function-reference" title="Permalink to this headline"></a>
</h2>
<p>This section describes the API of cuSolverSP, which provides a subset of LAPACK functions for sparse matrices in CSR or CSC format.</p>
<section id="helper-function-reference">
<h3>
<span class="section-number">2.5.1. </span>Helper Function Reference<a class="headerlink" href="index.html#helper-function-reference" title="Permalink to this headline"></a>
</h3>
<section id="cusolverspcreate">
<h4>
<span class="section-number">2.5.1.1. </span>cusolverSpCreate()<a class="headerlink" href="index.html#cusolverspcreate" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCreate</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function initializes the cuSolverSP library and creates a handle on the cuSolver context. It must be called before any other cuSolverSP API function is invoked. It allocates hardware resources necessary for accessing the GPU.</p>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 84%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The pointer to the handle to the cuSolverSP context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The initialization succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The CUDA Runtime initialization failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspdestroy">
<h4>
<span class="section-number">2.5.1.2. </span>cusolverSpDestroy()<a class="headerlink" href="index.html#cusolverspdestroy" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDestroy</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function releases CPU-side resources used by the cuSolverSP library.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 79%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The handle to the cuSolverSP context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The shutdown succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspsetstream">
<h4>
<span class="section-number">2.5.1.3. </span>cusolverSpSetStream()<a class="headerlink" href="index.html#cusolverspsetstream" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpSetStream</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="n">streamId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets the stream to be used by the cuSolverSP library to execute its routines.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 24%">
<col style="width: 76%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The handle to the cuSolverSP context.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">streamId</span></code></p></td>
<td><p>The stream to be used by the library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The stream was set successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrissym">
<h4>
<span class="section-number">2.5.1.4. </span>cusolverSpXcsrissym()<a class="headerlink" href="index.html#cusolverspxcsrissym" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrissymHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrEndPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">issym</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function checks if <code class="docutils literal notranslate"><span class="pre">A</span></code> has symmetric pattern or not. The output parameter <code class="docutils literal notranslate"><span class="pre">issym</span></code> reports 1 if <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric; otherwise, it reports 0.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> sparse matrix that is defined in CSR storage format by the four arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrEndPtrA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code> and <code class="docutils literal notranslate"><span class="pre">csrlsvqr</span></code> do not accept non-general matrix. the user has to extend the matrix into its missing upper/lower part, otherwise the result is not expected. The user can use <code class="docutils literal notranslate"><span class="pre">csrissym</span></code> to check if the matrix has symmetric pattern or not.</p>
<p>Remark 1: only CPU path is provided.</p>
<p>Remark 2: the user has to check returned status to get valid information. The function converts <code class="docutils literal notranslate"><span class="pre">A</span></code> to CSC format and compare CSR and CSC format. If the CSC failed because of insufficient resources, <code class="docutils literal notranslate"><span class="pre">issym</span></code> is undefined, and this state can only be detected by the return status code.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemorySpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code> elements that contains the start of every row.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrEndPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code> elements that contains the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 23%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemorySpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">issym</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>1 if <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric; 0 otherwise.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="high-level-function-reference">
<h3>
<span class="section-number">2.5.2. </span>High Level Function Reference<a class="headerlink" href="index.html#high-level-function-reference" title="Permalink to this headline"></a>
</h3>
<p>This section describes high level API of cuSolverSP, including linear solver, least-square solver and eigenvalue solver. The high-level API is designed for ease-of-use, so it allocates any required memory under the hood automatically. If the host or GPU system memory is not enough, an error is returned.</p>
<section id="cusolversp-t-csrlsvlu">
<h4>
<span class="section-number">2.5.2.1. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csrlsvlu">cusolverSp&lt;t&gt;csrlsvlu()</a><a class="headerlink" href="index.html#cusolversp-t-csrlsvlu" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsrlsvlu</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsrlsvlu</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsrlsvlu</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsrlsvlu</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves the linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*x = b\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. <code class="docutils literal notranslate"><span class="pre">b</span></code> is the right-hand-side vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code> is the solution vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric/Hermitian and only lower/upper part is used or meaningful, the user has to extend the matrix into its missing upper/lower part, otherwise the result would be wrong.</p>
<p>The linear system is solved by sparse LU with partial pivoting:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">cusolver</span></code> library provides three reordering schemes, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code><code class="docutils literal notranslate"><span class="pre">symamd</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> to reduce zero fill-in which dramatically affects the performance of LU factorization. The input parameter <code class="docutils literal notranslate"><span class="pre">reorder</span></code> can enable <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> (<code class="docutils literal notranslate"><span class="pre">symamd</span></code> or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code>) if <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is 1 (2, or 3), otherwise, no reordering is performed.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is nonzero, <code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code> does</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A*Q^{T} = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(Q = {symrcm}(A + A^{T})\)</span> .</p>
<p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is singular under given tolerance (<code class="docutils literal notranslate"><span class="pre">max(tol,0)</span></code>), then some diagonal elements of <code class="docutils literal notranslate"><span class="pre">U</span></code> is zero, i.e.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({|U(j,j)|} &lt; {tol\ for\ some\ j}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is the smallest index of such <code class="docutils literal notranslate"><span class="pre">j</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is non-singular, <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is -1. The index is base-0, independent of base index of <code class="docutils literal notranslate"><span class="pre">A</span></code>. For example, if 2nd column of <code class="docutils literal notranslate"><span class="pre">A</span></code> is the same as first column, then <code class="docutils literal notranslate"><span class="pre">A</span></code> is singular and <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">=</span> <span class="pre">1</span></code> which means <code class="docutils literal notranslate"><span class="pre">U(1,1)≈0</span></code>.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code> performs traditional LU with partial pivoting, the pivot of k-th column is determined dynamically based on the k-th column of intermediate matrix. <code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code> follows Gilbert and Peierls’s algorithm [4] which uses depth-first-search and topological ordering to solve triangular system (Davis also describes this algorithm in detail in his book [1]). Since CUDA 10.1, <code class="docutils literal notranslate"><span class="pre">csrlsvlu</span></code> will incrementally reallocate the memory to store <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">U</span></code>. This feature can avoid over-estimate size from QR factorization. In some cases, zero fill-in of QR can be order of magnitude higher than LU.</p>
<p>Remark 2: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(n)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(n)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right hand side vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Tolerance to decide if singular or not.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">reorder</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>No ordering if <code class="docutils literal notranslate"><span class="pre">reorder</span></code>=0. Otherwise, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code>, <code class="docutils literal notranslate"><span class="pre">symamd</span></code>, or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> is used to reduce zero fill-in.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Solution vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>, x = inv(A)*b.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">singularity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>-1 if <code class="docutils literal notranslate"><span class="pre">A</span></code> is invertible. Otherwise, first index <code class="docutils literal notranslate"><span class="pre">j</span></code> such that <code class="docutils literal notranslate"><span class="pre">U(j,j)≈0</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>, base index is not 0 or 1, <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is not 0,1,2,3)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolversp-t-csrlsvqr">
<h4>
<span class="section-number">2.5.2.2. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csrlsvqr">cusolverSp&lt;t&gt;csrlsvqr()</a><a class="headerlink" href="index.html#cusolversp-t-csrlsvqr" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsrlsvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsrlsvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsrlsvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsrlsvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves the linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*x = b\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. <code class="docutils literal notranslate"><span class="pre">b</span></code> is the right-hand-side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code> is the solution vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric/Hermitian and only lower/upper part is used or meaningful, the user has to extend the matrix into its missing upper/lower part, otherwise the result would be wrong.</p>
<p>The linear system is solved by sparse QR factorization,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A\ =\ Q*R\)</span></p></td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is singular under given tolerance (<code class="docutils literal notranslate"><span class="pre">max(tol,0)</span></code>), then some diagonal elements of <code class="docutils literal notranslate"><span class="pre">R</span></code> is zero, i.e.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({|R(j,j)|} &lt; {tol\ for\ some\ j}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is the smallest index of such <code class="docutils literal notranslate"><span class="pre">j</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is non-singular, <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is -1. The <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is base-0, independent of base index of <code class="docutils literal notranslate"><span class="pre">A</span></code>. For example, if 2nd column of <code class="docutils literal notranslate"><span class="pre">A</span></code> is the same as first column, then <code class="docutils literal notranslate"><span class="pre">A</span></code> is singular and <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">=</span> <span class="pre">1</span></code> which means <code class="docutils literal notranslate"><span class="pre">R(1,1)≈0</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">cusolver</span></code> library provides three reordering schemes, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code><code class="docutils literal notranslate"><span class="pre">symamd</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> to reduce zero fill-in which dramatically affects the performance of QR factorization. The input parameter <code class="docutils literal notranslate"><span class="pre">reorder</span></code> can enable <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> (<code class="docutils literal notranslate"><span class="pre">symamd</span></code> or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code>) if <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is 1 (2, or 3), otherwise, no reordering is performed.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right hand side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Tolerance to decide if singular or not.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">reorder</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>No ordering if <code class="docutils literal notranslate"><span class="pre">reorder</span></code>=0. Otherwise, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code>, <code class="docutils literal notranslate"><span class="pre">symamd</span></code>, or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> is used to reduce zero fill-in.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Solution vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>, x = inv(A)*b.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">singularity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>-1 if <code class="docutils literal notranslate"><span class="pre">A</span></code> is invertible. Otherwise, first index j such that <code class="docutils literal notranslate"><span class="pre">R(j,j)≈0</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,nnz&lt;=0</span></code>, base index is not 0 or 1, <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is not 0,1,2,3)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolversp-t-csrlsvchol">
<h4>
<span class="section-number">2.5.2.3. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csrlsvchol">cusolverSp&lt;t&gt;csrlsvchol()</a><a class="headerlink" href="index.html#cusolversp-t-csrlsvchol" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsrlsvchol</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrVal</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtr</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColInd</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsrlsvchol</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrVal</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtr</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColInd</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsrlsvchol</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrVal</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtr</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColInd</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsrlsvchol</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrVal</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtr</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColInd</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="n">reorder</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">singularity</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves the linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*x = b\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> symmetric positive definite sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. <code class="docutils literal notranslate"><span class="pre">b</span></code> is the right-hand-side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code> is the solution vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code> and upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is ignored (if parameter <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is zero). In other words, suppose input matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is decomposed as <span class="math notranslate nohighlight">\(A = L + D + U\)</span> , where <code class="docutils literal notranslate"><span class="pre">L</span></code> is lower triangular, <code class="docutils literal notranslate"><span class="pre">D</span></code> is diagonal and <code class="docutils literal notranslate"><span class="pre">U</span></code> is upper triangular. The function would ignore <code class="docutils literal notranslate"><span class="pre">U</span></code> and regard <code class="docutils literal notranslate"><span class="pre">A</span></code> as a symmetric matrix with the formula <span class="math notranslate nohighlight">\(A = L + D + L^{H}\)</span> . If parameter <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is nonzero, the user has to extend <code class="docutils literal notranslate"><span class="pre">A</span></code> to a full matrix, otherwise the solution would be wrong.</p>
<p>The linear system is solved by sparse Cholesky factorization,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = G*G^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">G</span></code> is the Cholesky factor, a lower triangular matrix.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">singularity</span></code> has two meanings:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, there exists some integer <code class="docutils literal notranslate"><span class="pre">k</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(0:k,</span> <span class="pre">0:k)</span></code> is not positive definite. <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is the minimum of such <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is positive definite but near singular under tolerance (<code class="docutils literal notranslate"><span class="pre">max(tol,0)</span></code>), i.e. there exists some integer <code class="docutils literal notranslate"><span class="pre">k</span></code> such that <span class="math notranslate nohighlight">\(G\begin{pmatrix}
{k,k} \\
\end{pmatrix}&lt;={tol}\)</span> . <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is the minimum of such <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">singularity</span></code> is base-0. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is positive definite and not near singular under tolerance, <code class="docutils literal notranslate"><span class="pre">singularity</span></code> is -1. If the user wants to know if <code class="docutils literal notranslate"><span class="pre">A</span></code> is positive definite or not, <code class="docutils literal notranslate"><span class="pre">tol=0</span></code> is enough.</p>
<p><code class="docutils literal notranslate"><span class="pre">cusolver</span></code> library provides three reordering schemes, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code><code class="docutils literal notranslate"><span class="pre">symamd</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> to reduce zero fill-in which dramatically affects the performance of Cholesky factorization. The input parameter <code class="docutils literal notranslate"><span class="pre">reorder</span></code> can enable <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> (<code class="docutils literal notranslate"><span class="pre">symamd</span></code> or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code>) if <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is 1 (2, or 3), otherwise, no reordering is performed.</p>
<p>Remark 1: the function works for in-place (<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> point to the same memory block) and out-of-place.</p>
<p>Remark 2: the function only works on 32-bit index, if matrix <code class="docutils literal notranslate"><span class="pre">G</span></code> has large zero fill-in such that number of nonzeros is bigger than <span class="math notranslate nohighlight">\(2^{31}\)</span> , then <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code> is returned.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right hand side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Tolerance to decide singularity.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">reorder</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>No ordering if <code class="docutils literal notranslate"><span class="pre">reorder</span></code>=0. Otherwise, <code class="docutils literal notranslate"><span class="pre">symrcm</span></code>, <code class="docutils literal notranslate"><span class="pre">symamd</span></code>, or <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> is used to reduce zero fill-in.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 19%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Solution vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>, x = inv(A)*b.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">singularity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>-1 if <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric positive definite.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,nnz&lt;=0</span></code>, base index is not 0 or 1, <code class="docutils literal notranslate"><span class="pre">reorder</span></code> is not 0,1,2,3)</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolversp-t-csrlsqvqr">
<h4>
<span class="section-number">2.5.2.4. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csrlsqvqr">cusolverSp&lt;t&gt;csrlsqvqr()</a><a class="headerlink" href="index.html#cusolversp-t-csrlsqvqr" title="Permalink to this headline"></a>
</h4>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsrlsqvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">rankA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">min_norm</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsrlsqvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">rankA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">min_norm</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsrlsqvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">rankA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">min_norm</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsrlsqvqr</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">rankA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">min_norm</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves the following least-square problem:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(x = {argmin}{||}A*z - b{||}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. <code class="docutils literal notranslate"><span class="pre">b</span></code> is the right-hand-side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code> is the least-square solution vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is square, symmetric/Hermitian and only lower/upper part is used or meaningful, the user has to extend the matrix into its missing upper/lower part, otherwise the result is wrong.</p>
<p>This function only works if <code class="docutils literal notranslate"><span class="pre">m</span></code> is greater or equal to <code class="docutils literal notranslate"><span class="pre">n</span></code>, in other words, <code class="docutils literal notranslate"><span class="pre">A</span></code> is a tall matrix.</p>
<p>The least-square problem is solved by sparse QR factorization with column pivoting,</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*P^{T} = Q*R\)</span></p></td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is of full rank (i.e. all columns of <code class="docutils literal notranslate"><span class="pre">A</span></code> are linear independent), then matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> is an identity. Suppose rank of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">k</span></code>, less than <code class="docutils literal notranslate"><span class="pre">n</span></code>, the permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> reorders columns of <code class="docutils literal notranslate"><span class="pre">A</span></code> in the following sense:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*P^{T} = \begin{pmatrix}
A_{1} &amp; A_{2} \\
\end{pmatrix} = \begin{pmatrix}
Q_{1} &amp; Q_{2} \\
\end{pmatrix}\begin{pmatrix}
R_{11} &amp; R_{12} &amp; R_{22} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(R_{11}\)</span> and <code class="docutils literal notranslate"><span class="pre">A</span></code> have the same rank, but <span class="math notranslate nohighlight">\(R_{22}\)</span> is almost zero, i.e. every column of <span class="math notranslate nohighlight">\(A_{2}\)</span> is linear combination of <span class="math notranslate nohighlight">\(A_{1}\)</span> .</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">tol</span></code> decides numerical rank. The absolute value of every entry in <span class="math notranslate nohighlight">\(R_{22}\)</span> is less than or equal to <code class="docutils literal notranslate"><span class="pre">tolerance=max(tol,0)</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">rankA</span></code> denotes numerical rank of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>Suppose <span class="math notranslate nohighlight">\(y = P*x\)</span> and <span class="math notranslate nohighlight">\(c = Q^{H}*b\)</span> , the least square problem can be reformed by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\left. \min||A*x - b|| = \min||R*y - c \right.||\)</span></p></td>
</tr>
</tbody>
</table>
<p>or in matrix form</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{pmatrix}
R_{11} &amp; R_{12} &amp; R_{22} \\
\end{pmatrix}\begin{pmatrix}
y_{1} \\
y_{2} \\
\end{pmatrix} = \begin{pmatrix}
c_{1} \\
c_{2} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">min_norm</span></code> is <span class="math notranslate nohighlight">\(\left. ||c_{2} \right.||\)</span> , which is minimum value of least-square problem.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">A</span></code> is not of full rank, above equation does not have a unique solution. The least-square problem is equivalent to</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(\begin{matrix}
\left. \min||y \right.|| \\
{{subject\ to}R_{11}*y_{1} + R_{12}*y_{2} = c_{1}} \\
\end{matrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Or equivalently another least-square problem</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p>min|| R 1 1 \ R 1 2 I * y 2 - R 1 1 \ c 1 O ||</p></td>
</tr>
</tbody>
</table>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">x</span></code> is <span class="math notranslate nohighlight">\(P^{T}*y\)</span> , the solution of least-square problem.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is a vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>. It corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>. <code class="docutils literal notranslate"><span class="pre">p(i)=j</span></code> means <code class="docutils literal notranslate"><span class="pre">(P*x)(i)</span> <span class="pre">=</span> <span class="pre">x(j)</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is of full rank, <code class="docutils literal notranslate"><span class="pre">p=0:n-1</span></code>.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">p</span></code> is always base 0, independent of base index of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>Remark 2: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolver library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right hand side vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Tolerance to decide rank of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">rankA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Numerical rank of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Solution vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>, x=pinv(A)*b.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>A vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>, which represents the permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> satisfying A*P^T=Q*R.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">min_norm</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">||A*x-b||,</span> <span class="pre">x=pinv(A)*b</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n,nnz&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolversp-t-csreigvsi">
<h4>
<span class="section-number">2.5.2.5. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csreigsi">cusolverSp&lt;t&gt;csreigvsi()</a><a class="headerlink" href="index.html#cusolversp-t-csreigvsi" title="Permalink to this headline"></a>
</h4>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsreigvsi</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">mu0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">maxite</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">mu</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsreigvsi</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">mu0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">maxite</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">mu</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsreigvsi</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="n">mu0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">maxite</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">float</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">mu</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpZcsreigvsi</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="n">mu0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x0</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">maxite</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">mu</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves the simple eigenvalue problem <span class="math notranslate nohighlight">\(A*x = \lambda*x\)</span> by shift-inverse method.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. The output parameter <code class="docutils literal notranslate"><span class="pre">x</span></code> is the approximated eigenvector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>,</p>
<p>The following shift-inverse method corrects eigenpair step-by-step until convergence.</p>
<p>It accepts several parameters:</p>
<p><code class="docutils literal notranslate"><span class="pre">mu0</span></code> is an initial guess of eigenvalue. The shift-inverse method will converge to the eigenvalue <code class="docutils literal notranslate"><span class="pre">mu</span></code> nearest <code class="docutils literal notranslate"><span class="pre">mu0</span></code> if <code class="docutils literal notranslate"><span class="pre">mu</span></code> is a singleton. Otherwise, the shift-inverse method may not converge.</p>
<p><code class="docutils literal notranslate"><span class="pre">x0</span></code> is an initial eigenvector. If the user has no preference, just chose <code class="docutils literal notranslate"><span class="pre">x0</span></code> randomly. <code class="docutils literal notranslate"><span class="pre">x0</span></code> must be nonzero. It can be non-unit length.</p>
<p><code class="docutils literal notranslate"><span class="pre">tol</span></code> is the tolerance to decide convergence. If <code class="docutils literal notranslate"><span class="pre">tol</span></code> is less than zero, it would be treated as zero.</p>
<p><code class="docutils literal notranslate"><span class="pre">maxite</span></code> is maximum number of iterations. It is useful when shift-inverse method does not converge because the tolerance is too small or the desired eigenvalue is not a singleton.</p>
<p><strong>Shift-Inverse Method</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p>Given a initial guess of eigenvalue μ0 and initial vector x0 x (0) = x0 of unit length for j = 0 : maxite     solve ( A - μ0 * I ) * x (k+1) = x (k)     normalize x (k+1) to unit length     compute approx. eigenvalue μ = x H * A * x where x = x (k+1)     if || A * x (k+1) - μ * x (k+1) || &lt; tolerance, then stop endfor</p></td>
</tr>
</tbody>
</table>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric/Hermitian and only lower/upper part is used or meaningful, the user has to extend the matrix into its missing upper/lower part, otherwise the result is wrong.</p>
<p>Remark 1: <code class="docutils literal notranslate"><span class="pre">[cu|h]solver[S|D]csreigvsi</span></code> only allows <code class="docutils literal notranslate"><span class="pre">mu0</span></code> as a real number. This works if <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric. Otherwise, the non-real eigenvalue has a conjugate counterpart on the complex plan, and shift-inverse method would not converge to such eigenvalue even the eigenvalue is a singleton. The user has to extend <code class="docutils literal notranslate"><span class="pre">A</span></code> to complex numbers and call <code class="docutils literal notranslate"><span class="pre">[cu|h]solver[C|Z]csreigvsi</span></code> with <code class="docutils literal notranslate"><span class="pre">mu0</span></code> not on real axis.</p>
<p>Remark 2: the tolerance <code class="docutils literal notranslate"><span class="pre">tol</span></code> should not be smaller than |mu0|*eps, where eps is machine zero. Otherwise, shift-inverse may not converge because of small tolerance.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolver library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">mu0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Initial guess of eigenvalue.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">x0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Initial guess of eigenvector, a vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">maxite</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Maximum iterations in shift-inverse method.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Tolerance for convergence.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">mu</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Approximated eigenvalue nearest <code class="docutils literal notranslate"><span class="pre">mu0</span></code> under tolerance.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Approximated eigenvector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,nnz&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolversp-t-csreigs">
<h4>
<span class="section-number">2.5.2.6. </span><a class="reference external" href="index.html#cusolver-lt-t-gt-csreigs">cusolverSp&lt;t&gt;csreigs()</a><a class="headerlink" href="index.html#cusolversp-t-csreigs" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">solverspScsreigs</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuComplex</span><span class="w"> </span><span class="n">left_bottom_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuComplex</span><span class="w"> </span><span class="n">right_upper_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">num_eigs</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsreigs</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="n">left_bottom_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="n">right_upper_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">num_eigs</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsreigs</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuComplex</span><span class="w"> </span><span class="n">left_bottom_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuComplex</span><span class="w"> </span><span class="n">right_upper_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">num_eigs</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsreigs</span><span class="p">[</span><span class="n">Host</span><span class="p">](</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="n">left_bottom_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="n">right_upper_corner</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">num_eigs</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes number of algebraic eigenvalues in a given box <code class="docutils literal notranslate"><span class="pre">B</span></code> by contour integral</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({number\ of\ algebraic\ eigenvalues\ in\ box\ B} = \frac{1}{2*\pi*\sqrt{- 1}}\oint_{C}\frac{P^{\prime}{(z)}}{P(z)}dz\)</span></p></td>
</tr>
</tbody>
</table>
<p>where closed line <code class="docutils literal notranslate"><span class="pre">C</span></code> is boundary of the box <code class="docutils literal notranslate"><span class="pre">B</span></code> which is a rectangle specified by two points, one is left bottom corner (input parameter <code class="docutils literal notranslate"><span class="pre">left_bottom_corner</span></code>) and the other is right upper corner (input parameter <code class="docutils literal notranslate"><span class="pre">right_upper_corner</span></code>). <code class="docutils literal notranslate"><span class="pre">P(z)=det(A</span> <span class="pre">-</span> <span class="pre">z*I)</span></code> is the characteristic polynomial of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×m</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">num_eigs</span></code> is number of algebraic eigenvalues in the box <code class="docutils literal notranslate"><span class="pre">B</span></code>. This number may not be accurate due to several reasons:</p>
<ol class="arabic simple">
<li><p>The contour <code class="docutils literal notranslate"><span class="pre">C</span></code> is close to some eigenvalues or even passes through some eigenvalues.</p></li>
<li><p>The numerical integration is not accurate due to coarse grid size. The default resolution is 1200 grids along contour <code class="docutils literal notranslate"><span class="pre">C</span></code> uniformly.</p></li>
</ol>
<p>Even though <code class="docutils literal notranslate"><span class="pre">csreigs</span></code> may not be accurate, it still can give the user some idea how many eigenvalues in a region where the resolution of disk theorem is bad. For example, standard 3-point stencil of finite difference of Laplacian operator is a tridiagonal matrix, and disk theorem would show “all eigenvalues are in the interval [0, 4*N^2]” where N is number of grids. In this case, <code class="docutils literal notranslate"><span class="pre">csreigs</span></code> is useful for any interval inside [0, 4*N^2].</p>
<p>Remark 1: if <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric in real or Hermitian in complex, all eigenvalues are real. The user still needs to specify a box, not an interval. The height of the box can be much smaller than the width.</p>
<p>Remark 2: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m</span></code><span class="math notranslate nohighlight">\(+ 1\)</span> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnz</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">left_bottom_corner</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Left bottom corner of the box.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">right_upper_corner</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right upper corner of the box.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 14%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">num_eigs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of algebraic eigenvalues in a box.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,nnz&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="low-level-function-reference">
<h3>
<span class="section-number">2.5.3. </span>Low Level Function Reference<a class="headerlink" href="index.html#low-level-function-reference" title="Permalink to this headline"></a>
</h3>
<p>This section describes low level API of cuSolverSP, including symrcm and batched QR.</p>
<section id="cusolverspxcsrsymrcm">
<h4>
<span class="section-number">2.5.3.1. </span>cusolverSpXcsrsymrcm()<a class="headerlink" href="index.html#cusolverspxcsrsymrcm" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrsymrcmHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function implements Symmetric Reverse Cuthill-McKee permutation. It returns a permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(p,p)</span></code> would concentrate nonzeros to diagonal. This is equivalent to <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> in MATLAB, however the result may not be the same because of different heuristics in the pseudoperipheral finder. The <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library implements <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> based on the following two papers:</p>
<blockquote>
<div>
<ul class="simple">
<li><p>E. Cuthill and J. McKee, Reducing the bandwidth of sparse symmetric matrices, ACM ‘69 Proceedings of the 1969 24th national conference, Pages 157-172</p></li>
<li><p>Alan George, Joseph W. H. Liu, An Implementation of a Pseudoperipheral Node Finder, ACM Transactions on Mathematical Software (TOMS) Volume 5 Issue 3, Sept. 1979, Pages 284-295</p></li>
</ul>
</div>
</blockquote>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is an integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. It represents a permutation array and it indexed using the base-0 convention. The permutation array <code class="docutils literal notranslate"><span class="pre">p</span></code> corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>, and satisfies the following relation:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A(p,p)} = P*A*P^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Internally <code class="docutils literal notranslate"><span class="pre">rcm</span></code> works on <span class="math notranslate nohighlight">\(A + A^{T}\)</span> , the user does not need to extend the matrix if the matrix is not symmetric.</p>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 23%">
<col style="width: 19%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>hsolver</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrsymmdq">
<h4>
<span class="section-number">2.5.3.2. </span>cusolverSpXcsrsymmdq()<a class="headerlink" href="index.html#cusolverspxcsrsymmdq" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrsymmdqHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function implements Symmetric Minimum Degree Algorithm based on Quotient Graph. It returns a permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(p,p)</span></code> would have less zero fill-in during Cholesky factorization. The <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library implements <code class="docutils literal notranslate"><span class="pre">symmdq</span></code> based on the following two papers:</p>
<p>Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff, An Approximate Minimum Degree Ordering Algorithm, SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.</p>
<p>Alan George, Joseph W. Liu, A Fast Implementation of the Minimum Degree Algorithm Using Quotient Graphs, ACM Transactions on Mathematical Software, Vol 6, No. 3, September 1980, page 337-358.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is an integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. It represents a permutation array with base-0 index. The permutation array <code class="docutils literal notranslate"><span class="pre">p</span></code> corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>, and satisfies the following relation:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A(p,p)} = P*A*P^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Internally <code class="docutils literal notranslate"><span class="pre">mdq</span></code> works on <span class="math notranslate nohighlight">\(A + A^{T}\)</span> , the user does not need to extend the matrix if the matrix is not symmetric.</p>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 23%">
<col style="width: 19%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>hsolver</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrsymamd">
<h4>
<span class="section-number">2.5.3.3. </span>cusolverSpXcsrsymamd()<a class="headerlink" href="index.html#cusolverspxcsrsymamd" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrsymamdHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function implements Symmetric Approximate Minimum Degree Algorithm based on Quotient Graph. It returns a permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(p,p)</span></code> would have less zero fill-in during Cholesky factorization. The <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library implements <code class="docutils literal notranslate"><span class="pre">symamd</span></code> based on the following paper:</p>
<p>Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff, An Approximate Minimum Degree Ordering Algorithm, SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is an integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. It represents a permutation array with base-0 index. The permutation array <code class="docutils literal notranslate"><span class="pre">p</span></code> corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>, and satisfies the following relation:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A(p,p)} = P*A*P^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Internally <code class="docutils literal notranslate"><span class="pre">amd</span></code> works on <span class="math notranslate nohighlight">\(A + A^{T}\)</span> , the user does not need to extend the matrix if the matrix is not symmetric.</p>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 23%">
<col style="width: 19%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>hsolver</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrmetisnd">
<h4>
<span class="section-number">2.5.3.4. </span>cusolverSpXcsrmetisnd()<a class="headerlink" href="index.html#cusolverspxcsrmetisnd" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrmetisndHost</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">options</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function is a wrapper of <code class="docutils literal notranslate"><span class="pre">METIS_NodeND</span></code>. It returns a permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(p,p)</span></code> would have less zero fill-in during nested dissection. The <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library links <code class="docutils literal notranslate"><span class="pre">libcusolver_metis_static.a</span></code> which is 64-bit metis-5.1.0 .</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">options</span></code> is the configuration of <code class="docutils literal notranslate"><span class="pre">metis</span></code>. For those who do not have experiences of <code class="docutils literal notranslate"><span class="pre">metis</span></code>, set <code class="docutils literal notranslate"><span class="pre">options</span> <span class="pre">=</span> <span class="pre">NULL</span></code> for default setting.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is an integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. It represents a permutation array with base-0 index. The permutation array <code class="docutils literal notranslate"><span class="pre">p</span></code> corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>, and satisfies the following relation:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A(p,p)} = P*A*P^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Internally <code class="docutils literal notranslate"><span class="pre">csrmetisnd</span></code> works on <span class="math notranslate nohighlight">\(A + A^{T}\)</span> , the user does not need to extend the matrix if the matrix is not symmetric.</p>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array to configure <code class="docutils literal notranslate"><span class="pre">metis</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 29%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrzfd">
<h4>
<span class="section-number">2.5.3.5. </span>cusolverSpXcsrzfd()<a class="headerlink" href="index.html#cusolverspxcsrzfd" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpScsrzfdHost</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">numnz</span><span class="p">)</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpDcsrzfdHost</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">numnz</span><span class="p">)</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpCcsrzfdHost</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">numnz</span><span class="p">)</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverSpZcsrzfdHost</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">numnz</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function implements MC21, zero-free diagonal algorithm. It returns a permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> such that <code class="docutils literal notranslate"><span class="pre">A(p,:)</span></code> has no zero diagonal.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>.</p>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> is an integer array of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. It represents a permutation array with base-0 index. The permutation array <code class="docutils literal notranslate"><span class="pre">p</span></code> corresponds to a permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>, and satisfies the following relation:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({A(p,:)} = P*A\)</span></p></td>
</tr>
</tbody>
</table>
<p>The output parameter <code class="docutils literal notranslate"><span class="pre">numnz</span></code> describes number of nonzero diagonal in permutated matrix <code class="docutils literal notranslate"><span class="pre">A(p,:)</span></code>. If <code class="docutils literal notranslate"><span class="pre">numnz</span></code> is less than <code class="docutils literal notranslate"><span class="pre">n</span></code>, matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> has structural singularity.</p>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p>Remark 2: this routine does not maximize diagonal value of permuted matrix. The user cannot expect this routine can make “LU without pivoting” stable.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code><span class="math notranslate nohighlight">\(( =\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(m)</span></code><span class="math notranslate nohighlight">\(-\)</span><code class="docutils literal notranslate"><span class="pre">csrRowPtrA(0)</span></code><span class="math notranslate nohighlight">\()\)</span> nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">n+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 24%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>*Host MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">numnz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros on diagonal of permuted matrix.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrperm">
<h4>
<span class="section-number">2.5.3.6. </span>cusolverSpXcsrperm()<a class="headerlink" href="index.html#cusolverspxcsrperm" title="Permalink to this headline"></a>
</h4>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrperm_bufferSizeHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">q</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">bufferSizeInBytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrpermHost</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">q</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">map</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Given a left permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> which corresponds to permutation matrix <code class="docutils literal notranslate"><span class="pre">P</span></code> and a right permutation vector <code class="docutils literal notranslate"><span class="pre">q</span></code> which corresponds to permutation matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code>, this function computes permutation of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> by</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(B = P*A*Q^{T}\)</span></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">m×n</span></code> sparse matrix that is defined in CSR storage format by the three arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The operation is in-place, i.e. the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is overwritten by <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<p>The permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> are base 0. <code class="docutils literal notranslate"><span class="pre">p</span></code> performs row permutation while <code class="docutils literal notranslate"><span class="pre">q</span></code> performs column permutation. One can also use MATLAB command <span class="math notranslate nohighlight">\(B = {A(p,q)}\)</span> to permutate matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>This function only computes sparsity pattern of <code class="docutils literal notranslate"><span class="pre">B</span></code>. The user can use parameter <code class="docutils literal notranslate"><span class="pre">map</span></code> to get <code class="docutils literal notranslate"><span class="pre">csrValB</span></code> as well. The parameter <code class="docutils literal notranslate"><span class="pre">map</span></code> is an input/output. If the user sets <code class="docutils literal notranslate"><span class="pre">map=0:1:(nnzA-1)</span></code> before calling <code class="docutils literal notranslate"><span class="pre">csrperm</span></code>, <code class="docutils literal notranslate"><span class="pre">csrValB=csrValA(map)</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric and only lower/upper part is provided, the user has to pass <span class="math notranslate nohighlight">\(A + A^{T}\)</span> into this function.</p>
<p>This function requires a buffer size returned by <code class="docutils literal notranslate"><span class="pre">csrperm_bufferSize()</span></code>. The address of <code class="docutils literal notranslate"><span class="pre">pBuffer</span></code> must be a multiple of 128 bytes. If it is not, <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code> is returned.</p>
<p>For example, if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = \begin{pmatrix}
{1.0} &amp; {2.0} &amp; {3.0} \\
{4.0} &amp; {5.0} &amp; {6.0} \\
{7.0} &amp; {8.0} &amp; {9.0} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>and left permutation vector <code class="docutils literal notranslate"><span class="pre">p=(0,2,1)</span></code>, right permutation vector <code class="docutils literal notranslate"><span class="pre">q=(2,1,0)</span></code>, then <span class="math notranslate nohighlight">\(P*A*Q^{T}\)</span> is</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A*Q^{T} = \begin{pmatrix}
{3.0} &amp; {2.0} &amp; {1.0} \\
{9.0} &amp; {8.0} &amp; {7.0} \\
{6.0} &amp; {5.0} &amp; {4.0} \\
\end{pmatrix}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Remark 1: only CPU (Host) path is provided.</p>
<p>Remark 2: the user can combine <code class="docutils literal notranslate"><span class="pre">csrsymrcm</span></code> and <code class="docutils literal notranslate"><span class="pre">csrperm</span></code> to get <span class="math notranslate nohighlight">\(P*A*P^{T}\)</span> which has less zero fill-in during QR factorization.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolver library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. It is the size of <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m+1</span></code> elements that contains the start of every row and end of last row plus one of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Left permutation vector of size <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Right permutation vector of size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">map</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code> indices. If the user wants to get relationship between <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">map</span></code> must be set <code class="docutils literal notranslate"><span class="pre">0:1:(nnzA-1)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Buffer allocated by the user, the size is returned by <code class="docutils literal notranslate"><span class="pre">csrperm_bufferSize()</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>hsolver</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m+1</span></code> elements that contains the start of every row and end of last row plus one of matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">map</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code> indices that maps matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBufferSizeInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of bytes of the buffer.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverspxcsrqrbatched">
<h4>
<span class="section-number">2.5.3.7. </span>cusolverSpXcsrqrBatched()<a class="headerlink" href="index.html#cusolverspxcsrqrbatched" title="Permalink to this headline"></a>
</h4>
<p>The create and destroy methods start and end the lifetime of a csrqrInfo object.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpCreateCsrqrInfo</span><span class="p">(</span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpDestroyCsrqrInfo</span><span class="p">(</span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Analysis is the same for all data types, but each data type has a unique buffer size.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpXcsrqrAnalysisBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpScsrqrBufferInfoBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">internalDataInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpDcsrqrBufferInfoBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">internalDataInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Calculate buffer sizes for complex valued data types.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpCcsrqrBufferInfoBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">internalDataInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpZcsrqrBufferInfoBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">internalDataInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The S and D data types are real valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpScsrqrsvBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpDcsrqrsvBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The C and Z data types are complex valued single and double precision, respectively.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpCcsrqrsvBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">cuComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>

<span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverSpZcsrqrsvBatched</span><span class="p">(</span><span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">cuDoubleComplex</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The batched sparse QR factorization is used to solve either a set of least-squares problems</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(x_{j} = {argmin}{||}A_{j}*z - b_{j}{||}{,\ j\ =\ 1,2,...,\ batchSize}\)</span></p></td>
</tr>
</tbody>
</table>
<p>or a set of linear systems</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j}x_{j} = b_{j}{,\ j\ =\ 1,2,...,\ batchSize}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where each <span class="math notranslate nohighlight">\(A_{j}\)</span> is a <code class="docutils literal notranslate"><span class="pre">m×n</span></code> sparse matrix that is defined in CSR storage format by the four arrays <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p>
<p>The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. If <code class="docutils literal notranslate"><span class="pre">A</span></code> is symmetric and only lower/upper part is provided, the user has to pass <span class="math notranslate nohighlight">\(A + A^{H}\)</span> into this function.</p>
<p>The prerequisite to use batched sparse QR has two-folds. First all matrices <span class="math notranslate nohighlight">\(A_{j}\)</span> must have the same sparsity pattern. Second, no column pivoting is used in least-square problem, so the solution is valid only if <span class="math notranslate nohighlight">\(A_{j}\)</span> is of full rank for all <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">1,2,...,</span> <span class="pre">batchSize</span></code>. All matrices have the same sparsity pattern, so only one copy of <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code> is used. But the array <code class="docutils literal notranslate"><span class="pre">csrValA</span></code> stores coefficients of <span class="math notranslate nohighlight">\(A_{j}\)</span> one after another. In other words, <code class="docutils literal notranslate"><span class="pre">csrValA[k*nnzA</span> <span class="pre">:</span> <span class="pre">(k+1)*nnzA]</span></code> is the value of <span class="math notranslate nohighlight">\(A_{k}\)</span> .</p>
<p>The batched QR uses opaque data structure <code class="docutils literal notranslate"><span class="pre">csrqrInfo</span></code> to keep intermediate data, for example, matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> and matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> of QR factorization. The user needs to create <code class="docutils literal notranslate"><span class="pre">csrqrInfo</span></code> first by <code class="docutils literal notranslate"><span class="pre">cusolverSpCreateCsrqrInfo</span></code> before any function in batched QR operation. The <code class="docutils literal notranslate"><span class="pre">csrqrInfo</span></code> would not release internal data until <code class="docutils literal notranslate"><span class="pre">cusolverSpDestroyCsrqrInfo</span></code> is called.</p>
<p>There are three routines in batched sparse QR, <code class="docutils literal notranslate"><span class="pre">cusolverSpXcsrqrAnalysisBatched</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code>.</p>
<p>First, <code class="docutils literal notranslate"><span class="pre">cusolverSpXcsrqrAnalysisBatched</span></code> is the analysis phase, used to analyze sparsity pattern of matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> and matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> of QR factorization. Also parallelism is extracted during analysis phase. Once analysis phase is done, the size of working space to perform QR is known. However <code class="docutils literal notranslate"><span class="pre">cusolverSpXcsrqrAnalysisBatched</span></code> uses CPU to analyze the structure of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, and this may consume a lot of memory. If host memory is not sufficient to finish the analysis, <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code> is returned. The required memory for analysis is proportional to zero fill-in in QR factorization. The user may need to perform some kind of reordering to minimize zero fill-in, for example, <code class="docutils literal notranslate"><span class="pre">colamd</span></code> or <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> in MATLAB. <code class="docutils literal notranslate"><span class="pre">cuSolverSP</span></code> library provides <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> (<code class="docutils literal notranslate"><span class="pre">cusolverSpXcsrsymrcm</span></code>).</p>
<p>Second, the user needs to choose proper <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> and to prepare working space for sparse QR. There are two memory blocks used in batched sparse QR. One is internal memory block used to store matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> and matrix <code class="docutils literal notranslate"><span class="pre">R</span></code>. The other is working space used to perform numerical factorization. The size of the former is proportional to <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>, and the size is specified by returned parameter <code class="docutils literal notranslate"><span class="pre">internalDataInBytes</span></code> of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</span></code>. while the size of the latter is almost independent of <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>, and the size is specified by returned parameter <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</span></code>. The internal memory block is allocated implicitly during first call of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code>. The user only needs to allocate working space for <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code>.</p>
<p>Instead of trying all batched matrices, the user can find maximum <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> by querying <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</span></code>. For example, the user can increase <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> till summation of <code class="docutils literal notranslate"><span class="pre">internalDataInBytes</span></code> and <code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code> is greater than size of available device memory.</p>
<p>Suppose that the user needs to perform 253 linear solvers and available device memory is 2GB. if <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code> can only afford <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> 100, the user has to call <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code> three times to finish all. The user calls <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</span></code> with <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> 100. The opaque <code class="docutils literal notranslate"><span class="pre">info</span></code> would remember this <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> and any subsequent call of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code> cannot exceed this value. In this example, the first two calls of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code> will use <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> 100, and last call of <code class="docutils literal notranslate"><span class="pre">cusolverSp[S|D|C|Z]csrqrsvBatched</span></code> will use <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> 53.</p>
<p>Example: suppose that A0, A1, .., A9 have the same sparsity pattern, the following code solves 10 linear systems <span class="math notranslate nohighlight">\(A_{j}x_{j} = b_{j}{,\ j\ =\ 0,2,...,\ 9}\)</span> by batched sparse QR.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="c1">// Suppose that A0, A1, .., A9 are m x m sparse matrix represented by CSR format,</span>
<span class="c1">// Each matrix Aj has nonzero nnzA, and shares the same csrRowPtrA and csrColIndA.</span>
<span class="c1">// csrValA is aggregation of A0, A1, ..., A9.</span>
<span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// number of rows and columns of each Aj</span>
<span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// number of nonzeros of each Aj</span>
<span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrRowPtrA</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// each Aj has the same csrRowPtrA</span>
<span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">csrColIndA</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// each Aj has the same csrColIndA</span>
<span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">csrValA</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// aggregation of A0,A1,...,A9</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="c1">// 10 linear systems</span>

<span class="n">cusolverSpHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"> </span><span class="c1">// handle to cusolver library</span>
<span class="n">csrqrInfo_t</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="n">cusparseMatDescr_t</span><span class="w"> </span><span class="n">descrA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="c1">// working space for numerical factorization</span>

<span class="c1">// step 1: create a descriptor</span>
<span class="n">cusparseCreateMatDescr</span><span class="p">(</span><span class="o">&amp;</span><span class="n">descrA</span><span class="p">);</span><span class="w"></span>
<span class="n">cusparseSetMatIndexBase</span><span class="p">(</span><span class="n">descrA</span><span class="p">,</span><span class="w"> </span><span class="n">CUSPARSE_INDEX_BASE_ONE</span><span class="p">);</span><span class="w"> </span><span class="c1">// A is base-1</span>
<span class="n">cusparseSetMatType</span><span class="p">(</span><span class="n">descrA</span><span class="p">,</span><span class="w"> </span><span class="n">CUSPARSE_MATRIX_TYPE_GENERAL</span><span class="p">);</span><span class="w"> </span><span class="c1">// A is a general matrix</span>

<span class="c1">// step 2: create empty info structure</span>
<span class="n">cusolverSpCreateCsrqrInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">info</span><span class="p">);</span><span class="w"></span>

<span class="c1">// step 3: symbolic analysis</span>
<span class="n">cusolverSpXcsrqrAnalysisBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">descrA</span><span class="p">,</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="c1">// step 4: allocate working space for Aj*xj=bj</span>
<span class="n">cusolverSpDcsrqrBufferInfoBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">csrValA</span><span class="p">,</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="o">&amp;</span><span class="n">internalDataInBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="o">&amp;</span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>

<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">workspaceInBytes</span><span class="p">);</span><span class="w"></span>

<span class="c1">// step 5: solve Aj*xj = bj</span>
<span class="n">cusolverSpDcsrqrsvBatched</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">descrA</span><span class="p">,</span><span class="w"> </span><span class="n">csrValA</span><span class="p">,</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">pBuffer</span><span class="p">);</span><span class="w"></span>

<span class="c1">// step 7: destroy info</span>
<span class="n">cusolverSpDestroyCsrqrInfo</span><span class="p">(</span><span class="n">info</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Please refer to <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/csrqr">cuSOLVER Library Samples - csrqr</a> for a code example.</p>
<p>Remark 1: only GPU (device) path is provided.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Handle to the cuSolverSP library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of rows of each matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of columns of each matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of nonzeros of each matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. It is the size <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The descriptor of each matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>. The supported matrix type is <code class="docutils literal notranslate"><span class="pre">CUSPARSE_MATRIX_TYPE_GENERAL</span></code>. Also, the supported index bases are <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ZERO</span></code> and <code class="docutils literal notranslate"><span class="pre">CUSPARSE_INDEX_BASE_ONE</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">nnzA*batchSize</span></code> nonzero elements of matrices <code class="docutils literal notranslate"><span class="pre">A0,</span> <span class="pre">A1,</span> <span class="pre">...</span></code>. All matrices are aggregated one after another.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">m+1</span></code> elements that contains the start of every row and the end of the last row plus one.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>Integer array of <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>column indices of the nonzero elements of each matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">m*batchSize</span></code> of right-hand-side vectors <code class="docutils literal notranslate"><span class="pre">b0,</span> <span class="pre">b1,</span> <span class="pre">...</span></code>. All vectors are aggregated one after another.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of systems to be solved.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Opaque structure for QR factorization.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">pBuffer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>Buffer allocated by the user, the size is returned by <code class="docutils literal notranslate"><span class="pre">cusolverSpXcsrqrBufferInfoBatched()</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>cusolverSp MemSpace</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>&lt;type&gt; array of <code class="docutils literal notranslate"><span class="pre">m*batchSize</span></code> of solution vectors <code class="docutils literal notranslate"><span class="pre">x0,</span> <span class="pre">x1,</span> <span class="pre">...</span></code>. All vectors are aggregated one after another.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">internalDataInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of bytes of the internal data.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">workspaceInBytes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>Number of bytes of the buffer in numerical factorization.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">m,n,nnzA&lt;=0</span></code>), base index is not 0 or 1.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</span></code></p></td>
<td><p>The matrix type is not supported.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="cusolverrf-refactorization-reference">
<h2>
<span class="section-number">2.6. </span>cuSolverRF: Refactorization Reference<a class="headerlink" href="index.html#cusolverrf-refactorization-reference" title="Permalink to this headline"></a>
</h2>
<p>This section describes API of cuSolverRF, a library for fast refactorization.</p>
<section id="cusolverrfaccessbundledfactors">
<h3>
<span class="section-number">2.6.1. </span>cusolverRfAccessBundledFactors()<a class="headerlink" href="index.html#cusolverrfaccessbundledfactors" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfAccessBundledFactors</span><span class="p">(</span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">                                  </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="cm">/* Output (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">nnzM</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="cm">/* Output (in the device memory) */</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">Mp</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">Mi</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">double</span><span class="o">**</span><span class="w"> </span><span class="n">Mx</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine allows direct access to the lower <code class="docutils literal notranslate"><span class="pre">L</span></code> and upper <code class="docutils literal notranslate"><span class="pre">U</span></code> triangular factors stored in the cuSolverRF library handle. The factors are compressed into a single matrix <code class="docutils literal notranslate"><span class="pre">M=(L-I)+U</span></code>, where the unitary diagonal of <code class="docutils literal notranslate"><span class="pre">L</span></code> is not stored. It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> was done in order to generate these triangular factors.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzM</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Mp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">Mi</span></code> and <code class="docutils literal notranslate"><span class="pre">Mx</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix $M$. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Mi</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzM</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Mx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzM</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfanalyze">
<h3>
<span class="section-number">2.6.2. </span>cusolverRfAnalyze()<a class="headerlink" href="index.html#cusolverrfanalyze" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfAnalyze</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine performs the appropriate analysis of parallelism available in the LU re-factorization depending upon the algorithm chosen by the user.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetup[Host|Device]()</span></code> was done in order to create internal data structures needed for the analysis.</p>
<p>This routine needs to be called only once for a single linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetupdevice">
<h3>
<span class="section-number">2.6.3. </span>cusolverRfSetupDevice()<a class="headerlink" href="index.html#cusolverrfsetupdevice" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetupDevice</span><span class="p">(</span><span class="cm">/* Input (in the device memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzL</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrRowPtrL</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrColIndL</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">csrValL</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzU</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrRowPtrU</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrColIndU</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">csrValU</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="cm">/* Output */</span><span class="w"></span>
<span class="w">                    </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine assembles the internal data structures of the cuSolverRF library. It is often the first routine to be called after the call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfCreate()</span></code> routine.</p>
<p>This routine accepts as input (on the device) the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, the lower <code class="docutils literal notranslate"><span class="pre">(L)</span></code> and upper <code class="docutils literal notranslate"><span class="pre">(U)</span></code> triangular factors, as well as the left <code class="docutils literal notranslate"><span class="pre">(P)</span></code> and the right <code class="docutils literal notranslate"><span class="pre">(Q)</span></code> permutations resulting from the full LU factorization of the first <code class="docutils literal notranslate"><span class="pre">(i=1)</span></code> linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The permutations <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> represent the final composition of all the left and right reorderings applied to the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, respectively. However, these permutations are often associated with partial pivoting and reordering to minimize fill-in, respectively.</p>
<p>This routine needs to be called only once for a single linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows (and columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColIndL</span></code> and <code class="docutils literal notranslate"><span class="pre">csrValL</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColIndU</span></code> and <code class="docutils literal notranslate"><span class="pre">csrValU</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetuphost">
<h3>
<span class="section-number">2.6.4. </span>cusolverRfSetupHost()<a class="headerlink" href="index.html#cusolverrfsetuphost" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetupHost</span><span class="p">(</span><span class="cm">/* Input (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzL</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrL</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndL</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrValL</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzU</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrU</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndU</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrValU</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_P</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_Q</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="cm">/* Output */</span><span class="w"></span>
<span class="w">                  </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine assembles the internal data structures of the cuSolverRF library. It is often the first routine to be called after the call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfCreate()</span></code> routine.</p>
<p>This routine accepts as input (on the host) the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, the lower <code class="docutils literal notranslate"><span class="pre">(L)</span></code> and upper <code class="docutils literal notranslate"><span class="pre">(U)</span></code> triangular factors, as well as the left <code class="docutils literal notranslate"><span class="pre">(P)</span></code> and the right <code class="docutils literal notranslate"><span class="pre">(Q)</span></code> permutations resulting from the full LU factorization of the first <code class="docutils literal notranslate"><span class="pre">(i=1)</span></code> linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The permutations <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> represent the final composition of all the left and right reorderings applied to the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, respectively. However, these permutations are often associated with partial pivoting and reordering to minimize fill-in, respectively.</p>
<p>This routine needs to be called only once for a single linear system</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows (and columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndA</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValA</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndL</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValL</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndU</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValU</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfcreate">
<h3>
<span class="section-number">2.6.5. </span>cusolverRfCreate()<a class="headerlink" href="index.html#cusolverrfcreate" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverRfCreate</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine initializes the cuSolverRF library. It allocates required resources and must be called prior to any other cuSolverRF library routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the cuSolverRF library handle.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfextractbundledfactorshost">
<h3>
<span class="section-number">2.6.6. </span>cusolverRfExtractBundledFactorsHost()<a class="headerlink" href="index.html#cusolverrfextractbundledfactorshost" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfExtractBundledFactorsHost</span><span class="p">(</span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">                                 </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="cm">/* Output (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_nnzM</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Mp</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Mi</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">double</span><span class="o">**</span><span class="w"> </span><span class="n">h_Mx</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine extracts lower <code class="docutils literal notranslate"><span class="pre">(L)</span></code> and upper <code class="docutils literal notranslate"><span class="pre">(U)</span></code> triangular factors from the cuSolverRF library handle into the host memory. The factors are compressed into a single matrix <code class="docutils literal notranslate"><span class="pre">M=(L-I)+U</span></code>, where the unitary diagonal of <code class="docutils literal notranslate"><span class="pre">(L)</span></code> is not stored. It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> was done in order to generate these triangular factors.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_nnzM</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Mp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_Mi</span></code> and <code class="docutils literal notranslate"><span class="pre">h_Mx</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">M</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Mi</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzM</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Mx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzM</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfextractsplitfactorshost">
<h3>
<span class="section-number">2.6.7. </span>cusolverRfExtractSplitFactorsHost()<a class="headerlink" href="index.html#cusolverrfextractsplitfactorshost" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfExtractSplitFactorsHost</span><span class="p">(</span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">                               </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="cm">/* Output (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_nnzL</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Lp</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Li</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">double</span><span class="o">**</span><span class="w"> </span><span class="n">h_Lx</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_nnzU</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Up</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">int</span><span class="o">**</span><span class="w"> </span><span class="n">h_Ui</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">double</span><span class="o">**</span><span class="w"> </span><span class="n">h_Ux</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine extracts lower <code class="docutils literal notranslate"><span class="pre">(L)</span></code> and upper <code class="docutils literal notranslate"><span class="pre">(U)</span></code> triangular factors from the cuSolverRF library handle into the host memory. It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> was done in order to generate these triangular factors.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_nnzL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Lp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_Li</span></code> and <code class="docutils literal notranslate"><span class="pre">h_Lx</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Li</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Lx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_nnzU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Up</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_Ui</span></code> and <code class="docutils literal notranslate"><span class="pre">h_Ux</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Ui</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzU</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Ux</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">h_nnzU</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfdestroy">
<h3>
<span class="section-number">2.6.8. </span>cusolverRfDestroy()<a class="headerlink" href="index.html#cusolverrfdestroy" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverRfDestroy</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine shuts down the cuSolverRF library. It releases acquired resources and must be called after all the cuSolverRF library routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The cuSolverRF library handle.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfgetmatrixformat">
<h3>
<span class="section-number">2.6.9. </span>cusolverRfGetMatrixFormat()<a class="headerlink" href="index.html#cusolverrfgetmatrixformat" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfGetMatrixFormat</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cusolverRfMatrixFormat_t</span><span class="w"> </span><span class="o">*</span><span class="n">format</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cusolverRfUnitDiagonal_t</span><span class="w"> </span><span class="o">*</span><span class="n">diag</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine gets the matrix format used in the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupDevice()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupHost()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractBundledFactorsHost()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractSplitFactorsHost()</span></code> routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The enumerated matrix format type.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">diag</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The enumerated unit diagonal type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfgetnumericproperties">
<h3>
<span class="section-number">2.6.10. </span>cusolverRfGetNumericProperties()<a class="headerlink" href="index.html#cusolverrfgetnumericproperties" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfGetNumericProperties</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">zero</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">boost</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine gets the numeric values used for checking for ‘’zero’’ pivot and for boosting it in the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routines. The numeric boosting will be used only if <code class="docutils literal notranslate"><span class="pre">boost</span> <span class="pre">&gt;</span> <span class="pre">0.0</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The value below which zero pivot is flagged.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">boost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The value which is substituted for zero pivot (if the later is flagged).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfgetnumericboostreport">
<h3>
<span class="section-number">2.6.11. </span>cusolverRfGetNumericBoostReport()<a class="headerlink" href="index.html#cusolverrfgetnumericboostreport" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfGetNumericBoostReport</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">cusolverRfNumericBoostReport_t</span><span class="w"> </span><span class="o">*</span><span class="n">report</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine gets the report whether numeric boosting was used in the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">report</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The enumerated boosting report type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfgetresetvaluesfastmode">
<h3>
<span class="section-number">2.6.12. </span>cusolverRfGetResetValuesFastMode()<a class="headerlink" href="index.html#cusolverrfgetresetvaluesfastmode" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfGetResetValuesFastMode</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="n">cusolverRfResetValuesFastMode_t</span><span class="w"> </span><span class="o">*</span><span class="n">fastMode</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine gets the mode used in the <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">fastMode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The enumerated mode type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfget-algs">
<h3>
<span class="section-number">2.6.13. </span>cusolverRfGet_Algs()<a class="headerlink" href="index.html#cusolverrfget-algs" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfGet_Algs</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="n">cusolverRfFactorization_t</span><span class="o">*</span><span class="w"> </span><span class="n">fact_alg</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="n">cusolverRfTriangularSolve_t</span><span class="o">*</span><span class="w"> </span><span class="n">solve_alg</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine gets the algorithm used for the refactorization in <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and the triangular solve in <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The enumerated algorithm type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfrefactor">
<h3>
<span class="section-number">2.6.14. </span>cusolverRfRefactor()<a class="headerlink" href="index.html#cusolverrfrefactor" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverRfRefactor</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine performs the LU re-factorization:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>exploring the available parallelism on the GPU. It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfAnalyze()</span></code> was done in order to find the available parallelism.</p>
<p>This routine may be called multiple times, once for each of the linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>There are some constraints to the combination of algorithms used for refactorization and solving routines, <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code>. The wrong combination generates the error code <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code>. The table below summarizes the supported combinations of algorithms:</p>
<p><strong>Compatible algorithms for solving and refactorization routines.</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 41%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Factorization</strong></p></th>
<th class="head"><p><strong>Solving</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVERRF_FACTORIZATION_ALG0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TRIANGULAR_SOLVE_ALG1</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVERRF_FACTORIZATION_ALG1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TRIANGULAR_SOLVE_ALG2,</span> <span class="pre">TRIANGULAR_SOLVE_ALG3</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVERRF_FACTORIZATION_ALG2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TRIANGULAR_SOLVE_ALG2,</span> <span class="pre">TRIANGULAR_SOLVE_ALG3</span></code></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 41%">
<col style="width: 59%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ZERO_PIVOT</span></code></p></td>
<td><p>A zero pivot was encountered during the computation.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfresetvalues">
<h3>
<span class="section-number">2.6.15. </span>cusolverRfResetValues()<a class="headerlink" href="index.html#cusolverrfresetvalues" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfResetValues</span><span class="p">(</span><span class="cm">/* Input (in the device memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">csrValA</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="cm">/* Output */</span><span class="w"></span>
<span class="w">                 </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine updates internal data structures with the values of the new coefficient matrix. It is assumed that the arrays <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> have not changed since the last call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetup[Host|Device]</span></code> routine. This assumption reflects the fact that the sparsity pattern of coefficient matrices as well as reordering to minimize fill-in and pivoting remain the same in the set of linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>This routine may be called multiple times, once for each of the linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows (and columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetmatrixformat">
<h3>
<span class="section-number">2.6.16. </span>cusolverRfSetMatrixFormat()<a class="headerlink" href="index.html#cusolverrfsetmatrixformat" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetMatrixFormat</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cusolverRfMatrixFormat_t</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">cusolverRfUnitDiagonal_t</span><span class="w"> </span><span class="n">diag</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine sets the matrix format used in the <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupDevice()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupHost()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code>, <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractBundledFactorsHost()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfExtractSplitFactorsHost()</span></code> routines. It may be called once prior to <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupDevice()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSetupHost()</span></code> routines.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The enumerated matrix format type.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">diag</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The enumerated unit diagonal type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 48%">
<col style="width: 52%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An enumerated mode parameter is wrong.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetnumericproperties">
<h3>
<span class="section-number">2.6.17. </span>cusolverRfSetNumericProperties()<a class="headerlink" href="index.html#cusolverrfsetnumericproperties" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetNumericProperties</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">double</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">double</span><span class="w"> </span><span class="n">boost</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine sets the numeric values used for checking for ‘’zero’’ pivot and for boosting it in the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routines. It may be called multiple times prior to <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code> routines. The numeric boosting will be used only if <code class="docutils literal notranslate"><span class="pre">boost</span> <span class="pre">&gt;</span> <span class="pre">0.0</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The value below which zero pivot is flagged.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">boost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The value which is substituted for zero pivot (if the later is flagged).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetresetvaluesfastmode">
<h3>
<span class="section-number">2.6.18. </span>cusolverRfSetResetValuesFastMode()<a class="headerlink" href="index.html#cusolverrfsetresetvaluesfastmode" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetResetValuesFastMode</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="n">cusolverRfResetValuesFastMode_t</span><span class="w"> </span><span class="n">fastMode</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine sets the mode used in the <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues</span></code> routine. The fast mode requires extra memory and is recommended only if very fast calls to <code class="docutils literal notranslate"><span class="pre">cusolverRfResetValues()</span></code> are needed. It may be called once prior to <code class="docutils literal notranslate"><span class="pre">cusolverRfAnalyze()</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">fastMode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The enumerated mode type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 48%">
<col style="width: 52%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An enumerated mode parameter is wrong.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsetalgs">
<h3>
<span class="section-number">2.6.19. </span>cusolverRfSetAlgs()<a class="headerlink" href="index.html#cusolverrfsetalgs" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSetAlgs</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="n">cusolverRfFactorization_t</span><span class="w"> </span><span class="n">fact_alg</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="n">cusolverRfTriangularSolve_t</span><span class="w"> </span><span class="n">alg</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine sets the algorithm used for the refactorization in <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> and the triangular solve in <code class="docutils literal notranslate"><span class="pre">cusolverRfSolve()</span></code>. It may be called once prior to <code class="docutils literal notranslate"><span class="pre">cusolverRfAnalyze()</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The enumerated algorithm type.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfsolve">
<h3>
<span class="section-number">2.6.20. </span>cusolverRfSolve()<a class="headerlink" href="index.html#cusolverrfsolve" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfSolve</span><span class="p">(</span><span class="cm">/* Input (in the device memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">          </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Q</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Temp</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="cm">/* Input/Output (in the device memory) */</span><span class="w"></span>
<span class="w">          </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">XF</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="n">ldxf</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine performs the forward and backward solve with the lower <span class="math notranslate nohighlight">\(L\in R^{nxn}\)</span> and upper <span class="math notranslate nohighlight">\(U\in R^{nxn}\)</span> triangular factors resulting from the LU re-factorization:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>which is assumed to have been computed by a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfRefactor()</span></code> routine.</p>
<p>The routine can solve linear systems with multiple right-hand-sides (RHS):</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(AX = {(LU)}X = L{(UX)} = LY = F~{where}~UX = Y\)</span></p></td>
</tr>
</tbody>
</table>
<p>even though currently only a single RHS is supported.</p>
<p>This routine may be called multiple times, once for each of the linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number right-hand-sides to be solved.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Temp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The dense matrix that contains temporary workspace (of size <code class="docutils literal notranslate"><span class="pre">ldt*nrhs</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The leading dimension of dense matrix Temp (<code class="docutils literal notranslate"><span class="pre">ldt</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">XF</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The dense matrix that contains the right-hand-sides <code class="docutils literal notranslate"><span class="pre">F</span></code> and solutions <code class="docutils literal notranslate"><span class="pre">X</span></code> (of size <code class="docutils literal notranslate"><span class="pre">ldxf*nrhs</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldxf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The leading dimension of dense matrix <code class="docutils literal notranslate"><span class="pre">XF</span></code> (<code class="docutils literal notranslate"><span class="pre">ldxf</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchsetuphost">
<h3>
<span class="section-number">2.6.21. </span>cusolverRfBatchSetupHost()<a class="headerlink" href="index.html#cusolverrfbatchsetuphost" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfBatchSetupHost</span><span class="p">(</span><span class="cm">/* Input (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_csrValA_array</span><span class="p">[],</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzL</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrL</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndL</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_csrValL</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzU</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrRowPtrU</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_csrColIndU</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_csrValU</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_P</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">h_Q</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="cm">/* Output */</span><span class="w"></span>
<span class="w">                       </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine assembles the internal data structures of the cuSolverRF library for batched operation. It is called after the call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfCreate()</span></code> routine, and before any other batched routines.</p>
<p>The batched operation assumes that the user has the following linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j}x_{j} = b_{j}{,\ j\ =\ 1,2,...,\ batchSize}\)</span></p></td>
</tr>
</tbody>
</table>
<p>where each matrix in the set: <span class="math notranslate nohighlight">\(\{ A_{j}\}\)</span> has the same sparsity pattern, and quite similar such that factorization can be done by the same permutation <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code>. In other words, <span class="math notranslate nohighlight">\(A_{j}{,\ j&gt;1}\)</span> is a small perturbation of <span class="math notranslate nohighlight">\(A_{1}\)</span> .</p>
<p>This routine accepts as input (on the host) the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> (sparsity pattern and batched values), the lower <code class="docutils literal notranslate"><span class="pre">(L)</span></code> and upper <code class="docutils literal notranslate"><span class="pre">(U)</span></code> triangular factors, as well as the left <code class="docutils literal notranslate"><span class="pre">(P)</span></code> and the right <code class="docutils literal notranslate"><span class="pre">(Q)</span></code> permutations resulting from the full LU factorization of the first <code class="docutils literal notranslate"><span class="pre">(i=1)</span></code> linear system:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The permutations <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> represent the final composition of all the left and right reorderings applied to the original matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, respectively. However, these permutations are often associated with partial pivoting and reordering to minimize fill-in, respectively.</p>
<p>Remark 1: the matrices <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">U</span></code> must be CSR format and base-0.</p>
<p>Remark 2: to get best performance, <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> should be multiple of 32 and greater or equal to 32. The algorithm is memory-bound, once bandwidth limit is reached, there is no room to improve performance by large <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. In practice, <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> of 32 - 128 is often enough to obtain good performance, but in some cases larger <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> might be beneficial.</p>
<p>The following routine needs to be called only once for a single linear system:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{i}x_{i} = f_{i}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of matrices in the batched mode.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows (and columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndA</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValA</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValA_array</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of pointers of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>, each pointer points to the array of values corresponding to the non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndL</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValL</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzL</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrRowPtrU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">h_csrColIndU</span></code> and <code class="docutils literal notranslate"><span class="pre">h_csrValU</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrColIndU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_csrValU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of values corresponding to the non-zero elements in the matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzU</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">h_P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">h_Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchanalyze">
<h3>
<span class="section-number">2.6.22. </span>cusolverRfBatchAnalyze()<a class="headerlink" href="index.html#cusolverrfbatchanalyze" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverRfBatchAnalyze</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine performs the appropriate analysis of parallelism available in the batched LU re-factorization.</p>
<p>It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfBatchSetup[Host]()</span></code> was done in order to create internal data structures needed for the analysis.</p>
<p>The following routine needs to be called only once for a single linear system:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j}x_{j} = b_{j}{,\ j\ =\ 1,2,...,\ batchSize}\)</span></p></td>
</tr>
</tbody>
</table>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>An allocation of memory failed.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchresetvalues">
<h3>
<span class="section-number">2.6.23. </span>cusolverRfBatchResetValues()<a class="headerlink" href="index.html#cusolverrfbatchresetvalues" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfBatchResetValues</span><span class="p">(</span><span class="cm">/* Input (in the device memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">nnzA</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrRowPtrA</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">csrColIndA</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">csrValA_array</span><span class="p">[],</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Q</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="cm">/* Output */</span><span class="w"></span>
<span class="w">                      </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine updates internal data structures with the values of the new coefficient matrix. It is assumed that the arrays <code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code>, <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> have not changed since the last call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfbatch_setup_host</span></code> routine.</p>
<p>This assumption reflects the fact that the sparsity pattern of coefficient matrices as well as reordering to minimize fill-in and pivoting remain the same in the set of linear systems:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A_{j}x_{j} = b_{j}{,\ j\ =\ 1,2,...,\ batchSize}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">csrValA_array</span></code> is an array of pointers on device memory. <code class="docutils literal notranslate"><span class="pre">csrValA_array(j)</span></code> points to matrix: <span class="math notranslate nohighlight">\(A_{j}\)</span> which is also on device memory.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">batchSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of matrices in batched mode.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows (and columns) of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nnzA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of non-zero elements of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrRowPtrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of offsets corresponding to the start of each row in the arrays <code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code> and <code class="docutils literal notranslate"><span class="pre">csrValA</span></code>. This array has also an extra entry at the end that stores the number of non-zero elements in the matrix. The array size is <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">csrColIndA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The array of column indices corresponding to the non-zero elements in the matrix. It is assumed that this array is sorted by row and by column within each row. The array size is <code class="docutils literal notranslate"><span class="pre">nnzA</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">csrValA_array</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Array of pointers of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>, each pointer points to the array of values corresponding to the non-zero elements in the matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchrefactor">
<h3>
<span class="section-number">2.6.24. </span>cusolverRfBatchRefactor()<a class="headerlink" href="index.html#cusolverrfbatchrefactor" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"> </span><span class="nf">cusolverRfBatchRefactor</span><span class="p">(</span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This routine performs the LU re-factorization:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(M_{j} = P*A_{j}*Q^{T} = L_{j}*U_{j}\)</span></p></td>
</tr>
</tbody>
</table>
<p>exploring the available parallelism on the GPU. It is assumed that a prior call to the <code class="docutils literal notranslate"><span class="pre">cusolverRfBatchAnalyze()</span></code> was done in order to find the available parallelism.</p>
<p>Remark: <code class="docutils literal notranslate"><span class="pre">cusolverRfBatchRefactor()</span></code> would not report any failure of LU refactorization. The user has to call <code class="docutils literal notranslate"><span class="pre">cusolverRfBatchZeroPivot()</span></code> to know which matrix failed the LU refactorization.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 49%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchsolve">
<h3>
<span class="section-number">2.6.25. </span>cusolverRfBatchSolve()<a class="headerlink" href="index.html#cusolverrfbatchsolve" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfBatchSolve</span><span class="p">(</span><span class="cm">/* Input (in the device memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">               </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">Q</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Temp</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="cm">/* Input/Output (in the device memory) */</span><span class="w"></span>
<span class="w">               </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">XF_array</span><span class="p">[],</span><span class="w"></span>
<span class="w">               </span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="n">ldxf</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>To solve <span class="math notranslate nohighlight">\(A_{j}*x_{j} = b_{j}\)</span> , first we reform the equation by <span class="math notranslate nohighlight">\(M_{j}*Q*x_{j} = P*b_{j}\)</span> where <span class="math notranslate nohighlight">\(M_{j} = P*A_{j}*Q^{T}\)</span> . Then do refactorization <span class="math notranslate nohighlight">\(M_{j} = L_{j}*U_{j}\)</span> by <code class="docutils literal notranslate"><span class="pre">cusolverRfBatch_Refactor()</span></code>. Further <code class="docutils literal notranslate"><span class="pre">cusolverRfBatch_Solve()</span></code> takes over the remaining steps, including:</p>
<p><span class="math notranslate nohighlight">\(z_{j} = P*b_{j}\)</span></p>
<p><span class="math notranslate nohighlight">\(M_{j}*y_{j} = z_{j}\)</span></p>
<p><span class="math notranslate nohighlight">\(x_{j} = Q^{T}*y_{j}\)</span></p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">XF_array</span></code> is an array of pointers on device memory. <code class="docutils literal notranslate"><span class="pre">XF_array(j)</span></code> points to matrix <span class="math notranslate nohighlight">\(x_{j}\)</span> which is also on device memory.</p>
<p>Remark 1: only a single rhs is supported.</p>
<p>Remark 2: no singularity is reported during backward solve. If some matrix <span class="math notranslate nohighlight">\(A_{j}\)</span> failed the refactorization and <span class="math notranslate nohighlight">\(U_{j}\)</span> has some zero diagonal, backward solve would compute NAN. The user has to call <code class="docutils literal notranslate"><span class="pre">cusolverRfBatch_Zero_Pivot</span></code> to check if refactorization is successful or not.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The left permutation (often associated with pivoting). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The right permutation (often associated with reordering). The array size in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">nrhs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number right-hand-sides to be solved.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">Temp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The dense matrix that contains temporary workspace (of size <code class="docutils literal notranslate"><span class="pre">ldt*nrhs</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The leading dimension of dense matrix Temp (<code class="docutils literal notranslate"><span class="pre">ldt</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">XF_array</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>Array of pointers of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>, each pointer points to the dense matrix that contains the right-hand-sides <code class="docutils literal notranslate"><span class="pre">F</span></code> and solutions <code class="docutils literal notranslate"><span class="pre">X</span></code> (of size <code class="docutils literal notranslate"><span class="pre">ldxf*nrhs</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">ldxf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The leading dimension of dense matrix <code class="docutils literal notranslate"><span class="pre">XF</span></code> (<code class="docutils literal notranslate"><span class="pre">ldxf</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>).</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 45%">
<col style="width: 55%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>An unsupported value or parameter was passed.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_EXECUTION_FAILED</span></code></p></td>
<td><p>A kernel failed to launch on the GPU.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolverrfbatchzeropivot">
<h3>
<span class="section-number">2.6.26. </span>cusolverRfBatchZeroPivot()<a class="headerlink" href="index.html#cusolverrfbatchzeropivot" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverRfBatchZeroPivot</span><span class="p">(</span><span class="cm">/* Input */</span><span class="w"></span>
<span class="w">                    </span><span class="n">cusolverRfHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="w"></span>
<span class="w">                    </span><span class="cm">/* Output (in the host memory)</span><span class="w"> </span><span class="o">*/</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">position</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Although <span class="math notranslate nohighlight">\(A_{j}\)</span> is close to each other, it does not mean <span class="math notranslate nohighlight">\(M_{j} = P*A_{j}*Q^{T} = L_{j}*U_{j}\)</span> exists for every j. The user can query which matrix failed LU refactorization by checking corresponding value in <code class="docutils literal notranslate"><span class="pre">position</span></code> array. The input parameter <code class="docutils literal notranslate"><span class="pre">position</span></code> is an integer array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">j-th</span></code> component denotes the refactorization result of matrix <span class="math notranslate nohighlight">\(A_{j}\)</span> . If <code class="docutils literal notranslate"><span class="pre">position(j)</span></code> is -1, the LU refactorization of matrix <span class="math notranslate nohighlight">\(A_{j}\)</span> is successful. If <code class="docutils literal notranslate"><span class="pre">position(j)</span></code> is <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code>, matrix <span class="math notranslate nohighlight">\(A_{j}\)</span> is not LU factorizable and its matrix <span class="math notranslate nohighlight">\(U_{j}{(j,j)}\)</span> is zero.</p>
<p>The return value of <code class="docutils literal notranslate"><span class="pre">cusolverRfBatch_Zero_Pivot</span></code> is <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ZERO_PIVOT</span></code> if there exists one <span class="math notranslate nohighlight">\(A_{j}\)</span> which failed LU refactorization. The user can redo LU factorization to get new permutation <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> if error code <code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ZERO_PIVOT</span></code> is returned.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The handle to the cuSolverRF library.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">position</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>Integer array of size <code class="docutils literal notranslate"><span class="pre">batchSize</span></code>. The value of <code class="docutils literal notranslate"><span class="pre">position(j)</span></code> reports singularity of matrix <code class="docutils literal notranslate"><span class="pre">Aj</span></code>, -1 if no structural/numerical zero, <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">Aj(k,k)</span></code> is either structural zero or numerical zero.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 41%">
<col style="width: 59%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ZERO_PIVOT</span></code></p></td>
<td><p>A zero pivot was encountered during the computation.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="using-the-cusolvermg-api">
<h1>
<span class="section-number">3. </span>Using the CUSOLVERMG API<a class="headerlink" href="index.html#using-the-cusolvermg-api" title="Permalink to this headline"></a>
</h1>
<section id="id17">
<h2>
<span class="section-number">3.1. </span>General Description<a class="headerlink" href="index.html#id17" title="Permalink to this headline"></a>
</h2>
<p>This section describes how to use the cuSolverMG library API. It is not a reference for the cuSolverMG API data types and functions; that is provided in subsequent chapters.</p>
<section id="id18">
<h3>
<span class="section-number">3.1.1. </span>Thread Safety<a class="headerlink" href="index.html#id18" title="Permalink to this headline"></a>
</h3>
<p>The library is thread-safe only if there is one cuSolverMG context per thread.</p>
</section>
<section id="determinism">
<h3>
<span class="section-number">3.1.2. </span>Determinism<a class="headerlink" href="index.html#determinism" title="Permalink to this headline"></a>
</h3>
<p>Currently all cuSolverMG API routines from a given toolkit version generate the same bit-wise results when the following conditions are respected :</p>
<ul class="simple">
<li><p>all GPUs participating to the computation have the same compute-capabilities and the same number of SMs.</p></li>
<li><p>the tiles size is kept the same between run.</p></li>
<li><p>number of logical GPUs is kept the same. The order of GPUs are not important because all have the same compute-capabilities.</p></li>
</ul>
</section>
<section id="tile-strategy">
<h3>
<span class="section-number">3.1.3. </span>Tile Strategy<a class="headerlink" href="index.html#tile-strategy" title="Permalink to this headline"></a>
</h3>
<p>The tiling strategy of cuSolverMG is compatible with ScaLAPACK. The current release only supports 1-D column block cyclic, column-major PACKED format.</p>
<p>Figure 1.a shows a partition of the matrix A of dimension <code class="docutils literal notranslate"><span class="pre">M_A</span></code> by <code class="docutils literal notranslate"><span class="pre">N_A</span></code>. Each column tile has <code class="docutils literal notranslate"><span class="pre">T_A</span></code> columns. There are seven columns of tiles, labeled as 0,1,2,3,4,5,6, distributed into three GPUs in a <code class="docutils literal notranslate"><span class="pre">cyclic</span></code> way, i.e. each GPU takes one column tile in turn. For example, GPU 0 has column tile 0, 3, 6 (yellow tiles) and GPU 1 takes column tiles next to GPU 0 (blue tiles). Not all GPUs have the same number of tiles; in this example, GPU 0 has three tiles, others have only two tiles.</p>
<p>Figure 1.b shows two possible formats to store those column tiles locally in each GPU. Left side is called PACKED format and right side is UNPACKED format. PACKED format aggregates three column tiles in a contiguous memory block while UNPACKED format distributes these three column tiles into different memory blocks. The only difference between them is that PACKED format can have a big GEMM call instead of three GEMM calls in UNPACKED format. So theoretically speaking, PACKED format can deliver better performance than UNPACKED format. <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> only supports PACKED format in the API. In order to achieve maximal performance, the user just needs to choose the proper tile size <code class="docutils literal notranslate"><span class="pre">T_A</span></code> to partition the matrix, not too small, for example 256 or above is enough.</p>
<p>There is another parameter, called <code class="docutils literal notranslate"><span class="pre">LLD_A</span></code>, to control the leading dimension of the local matrix in each GPU. <code class="docutils literal notranslate"><span class="pre">LLD_A</span></code> must be greater or equal to <code class="docutils literal notranslate"><span class="pre">M_A</span></code>. The purpose of <code class="docutils literal notranslate"><span class="pre">LLD_A</span></code> is for better performance of GEMM. For small problems, GEMM is faster if <code class="docutils literal notranslate"><span class="pre">LLD_A</span></code> is power of 2. However for big problems, <code class="docutils literal notranslate"><span class="pre">LLD_A</span></code> does not show significant improvement. <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> only supports <code class="docutils literal notranslate"><span class="pre">LLD_A=M_A</span></code>.</p>
<figure class="align-center" id="mg-tile-info-example-of-mg-tiling-for-3-gpus">
<img alt="Example of ``cuSolverMG`` tiling for 3 GPUs" src="_images/figure_1.jpg">
<figcaption>
<p><span class="caption-text">Example of <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> tiling for 3 GPUs</span><a class="headerlink" href="index.html#mg-tile-info-example-of-mg-tiling-for-3-gpus" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The processing grid in <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> is a list of GPU IDs, similar to the process ID in <code class="docutils literal notranslate"><span class="pre">ScaLAPACK</span></code>. <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> only supports 1D column block cyclic, so only 1D grid is supported as well. Suppose <code class="docutils literal notranslate"><span class="pre">deviceId</span></code> is a list of GPU IDs, both <code class="docutils literal notranslate"><span class="pre">deviceId=1,1,1</span></code> and <code class="docutils literal notranslate"><span class="pre">deviceId=2,1,0</span></code> are valid. The former describes three logical devices that are selected to run <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> routines, and all have the same physical ID, 0. The latter still uses three logical devices, but each has a different physical ID. The current design only accepts 32 logical devices, that is, the length of <code class="docutils literal notranslate"><span class="pre">deviceId</span></code> is less or equal to 32. Figure 1 uses <code class="docutils literal notranslate"><span class="pre">deviceId=0,1,2</span></code>.</p>
<p>In practice, the matrix A is distributed into GPUs listed in <code class="docutils literal notranslate"><span class="pre">deviceId</span></code>. If the user chooses <code class="docutils literal notranslate"><span class="pre">deviceId=1,1,1</span></code>, all columns tile are located in GPU 1, this will limit the size of the problem because of memory capacity of one GPU. Besides, multiGPU routine adds extra overhead on data communication through the off-chip bus, which has a big performance impact if NVLINK is not supported or used. It would be faster to run on a single GPU instead of running multiGPU version with devices of the same GPU ID.</p>
</section>
<section id="global-matrix-versus-local-matrix">
<h3>
<span class="section-number">3.1.4. </span>Global Matrix Versus Local Matrix<a class="headerlink" href="index.html#global-matrix-versus-local-matrix" title="Permalink to this headline"></a>
</h3>
<p>Operating a submatrix of the matrix A is simple in dense linear algebra, just shift the pointer to the starting point of the submatrix relative to A. For example, <code class="docutils literal notranslate"><span class="pre">gesvd(10,10,</span> <span class="pre">A)</span></code> is SVD of <code class="docutils literal notranslate"><span class="pre">A(0:9,0:9)</span></code>. <code class="docutils literal notranslate"><span class="pre">gesvd(10,10,</span> <span class="pre">A</span> <span class="pre">+</span> <span class="pre">5</span> <span class="pre">+</span> <span class="pre">2*lda</span> <span class="pre">)</span></code> is SVD of 10-by-10 submatrix starting at <code class="docutils literal notranslate"><span class="pre">A(5,2)</span></code>.</p>
<p>However it is not simple to operate on a submatrix of a distributed matrix because different starting point of the submatrix changes the distribution of the layout of that submatrix. <code class="docutils literal notranslate"><span class="pre">ScaLAPACK</span></code> introduces two parameters, <code class="docutils literal notranslate"><span class="pre">IA</span></code> and <code class="docutils literal notranslate"><span class="pre">JA</span></code>, to locate the submatrix. Figure 2 shows (global) matrix A of dimension <code class="docutils literal notranslate"><span class="pre">M_A</span></code> by <code class="docutils literal notranslate"><span class="pre">N_A</span></code>. The <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> is a <code class="docutils literal notranslate"><span class="pre">M</span></code> by <code class="docutils literal notranslate"><span class="pre">N</span></code> submatrix of A, starting at <code class="docutils literal notranslate"><span class="pre">IA</span></code> and <code class="docutils literal notranslate"><span class="pre">JA</span></code>. Please be aware that <code class="docutils literal notranslate"><span class="pre">IA</span></code> and <code class="docutils literal notranslate"><span class="pre">JA</span></code> are base-1.</p>
<p>Given a distributed matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, the user can compute eigenvalues of the submatrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> by either calling <code class="docutils literal notranslate"><span class="pre">syevd(A,</span> <span class="pre">IA,</span> <span class="pre">JA)</span></code> or gathering <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> to another distributed matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> and calling <code class="docutils literal notranslate"><span class="pre">syevd(B,</span> <span class="pre">IB=1,</span> <span class="pre">JB=1)</span></code>.</p>
<figure class="align-center" id="mg-global-matrix-example-of-mg-global-matrix">
<img alt="global matrix and local matrix" src="_images/figure_2.jpg">
<figcaption>
<p><span class="caption-text">global matrix and local matrix</span><a class="headerlink" href="index.html#mg-global-matrix-example-of-mg-global-matrix" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="id19">
<h3>
<span class="section-number">3.1.5. </span>Usage of _bufferSize<a class="headerlink" href="index.html#id19" title="Permalink to this headline"></a>
</h3>
<p>There is no cudaMalloc inside <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> library, so the user must allocate the device workspace explicitly. The routine <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> is to query the size of workspace of the routine <code class="docutils literal notranslate"><span class="pre">xyz</span></code>, for example <code class="docutils literal notranslate"><span class="pre">xyz</span> <span class="pre">=</span> <span class="pre">syevd</span></code>. To make the API simple, <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> follows almost the same signature of <code class="docutils literal notranslate"><span class="pre">xyz</span></code> even it only depends on some parameters, for example, the device pointer is not used to decide the size of workspace. In most cases, <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> is called in the beginning before actual device data (pointing by a device pointer) is prepared or before the device pointer is allocated. In such cases, the user can pass a null pointer to <code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> without breaking the functionality.</p>
<p><code class="docutils literal notranslate"><span class="pre">xyz_bufferSize</span></code> returns bufferSize for each device. The size is number of elements, not number of bytes.</p>
</section>
<section id="synchronization">
<h3>
<span class="section-number">3.1.6. </span>Synchronization<a class="headerlink" href="index.html#synchronization" title="Permalink to this headline"></a>
</h3>
<p>All routines are in synchronous (blocking call) manner. The data is ready after the routine. However the user has to prepare the distributed data before calling the routine. For example, if the user has multiple streams to set up the matrix, stream synchronization or device synchronization is necessary to guarantee the distributed matrix is ready.</p>
</section>
<section id="context-switch">
<h3>
<span class="section-number">3.1.7. </span>Context Switch<a class="headerlink" href="index.html#context-switch" title="Permalink to this headline"></a>
</h3>
<p>The user does not need to restore the device by <code class="docutils literal notranslate"><span class="pre">cudaSetDevice()</span></code> after each cuSolverMG call. All routines set the device back to what the caller has.</p>
</section>
<section id="nvlink">
<h3>
<span class="section-number">3.1.8. </span>NVLINK<a class="headerlink" href="index.html#nvlink" title="Permalink to this headline"></a>
</h3>
<p>The peer-to-peer communication via NVLINK can dramatically reduce the overhead of data exchange among GPUs. <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> does not enable NVLINK implicitly, instead, it gives this option back to the user, not to interfere with other libraries. The example code H.1 shows how to enable peer-to-peer communication.</p>
</section>
</section>
<section id="cusolvermg-types-reference">
<h2>
<span class="section-number">3.2. </span>cuSolverMG Types Reference<a class="headerlink" href="index.html#cusolvermg-types-reference" title="Permalink to this headline"></a>
</h2>
<section id="cusolvermg-types">
<h3>
<span class="section-number">3.2.1. </span>cuSolverMG Types<a class="headerlink" href="index.html#cusolvermg-types" title="Permalink to this headline"></a>
</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">cuComplex</span></code>, and <code class="docutils literal notranslate"><span class="pre">cuDoubleComplex</span></code> data types are supported. The first two are standard C data types, while the last two are exported from <code class="docutils literal notranslate"><span class="pre">cuComplex.h</span></code>. In addition, cuSolverMG uses some familiar types from cuBLAS.</p>
</section>
<section id="cusolvermghandle-t">
<h3>
<span class="section-number">3.2.2. </span>cusolverMgHandle_t<a class="headerlink" href="index.html#cusolvermghandle-t" title="Permalink to this headline"></a>
</h3>
<p>This is a pointer type to an opaque cuSolverMG context, which the user must initialize by calling <code class="docutils literal notranslate"><span class="pre">cusolverMgCreate()</span></code> prior to calling any other library function. An un-initialized handle object will lead to unexpected behavior, including crashes of cuSolverMG. The handle created and returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgCreate()</span></code> must be passed to every cuSolverMG function.</p>
</section>
<section id="cusolvermggridmapping-t">
<h3>
<span class="section-number">3.2.3. </span>cusolverMgGridMapping_t<a class="headerlink" href="index.html#cusolvermggridmapping-t" title="Permalink to this headline"></a>
</h3>
<p>The type indicates layout of grids.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 62%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDALIBMG_GRID_MAPPING_ROW_MAJOR</span></code></p></td>
<td><p>Row-major ordering.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDALIBMG_GRID_MAPPING_COL_MAJOR</span></code></p></td>
<td><p>Column-major ordering.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cudalibmggrid-t">
<h3>
<span class="section-number">3.2.4. </span>cudaLibMgGrid_t<a class="headerlink" href="index.html#cudalibmggrid-t" title="Permalink to this headline"></a>
</h3>
<p>Opaque structure of the distributed grid.</p>
</section>
<section id="cudalibmgmatrixdesc-t">
<h3>
<span class="section-number">3.2.5. </span>cudaLibMgMatrixDesc_t<a class="headerlink" href="index.html#cudalibmgmatrixdesc-t" title="Permalink to this headline"></a>
</h3>
<p>Opaque structure of the distributed matrix descriptor.</p>
</section>
</section>
<section id="id20">
<h2>
<span class="section-number">3.3. </span>Helper Function Reference<a class="headerlink" href="index.html#id20" title="Permalink to this headline"></a>
</h2>
<section id="cusolvermgcreate">
<h3>
<span class="section-number">3.3.1. </span>cusolverMgCreate()<a class="headerlink" href="index.html#cusolvermgcreate" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgCreate</span><span class="p">(</span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function initializes the cuSolverMG library and creates a handle on the cuSolverMG context. It must be called before any other cuSolverMG API function is invoked. It allocates hardware resources necessary for accessing the GPU.</p>
<p><strong>Output</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 16%">
<col style="width: 84%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The pointer to the handle to the cuSolverMG context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 46%">
<col style="width: 54%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The initialization succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgdestroy">
<h3>
<span class="section-number">3.3.2. </span>cusolverMgDestroy()<a class="headerlink" href="index.html#cusolvermgdestroy" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgDestroy</span><span class="p">(</span><span class="w"> </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function releases CPU-side resources used by the cuSolverMG library.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 79%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The handle to the cuSolverMG context.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 54%">
<col style="width: 46%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The shutdown succeeded.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgdeviceselect">
<h3>
<span class="section-number">3.3.3. </span>cusolverMgDeviceSelect()<a class="headerlink" href="index.html#cusolvermgdeviceselect" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgDeviceSelect</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nbDevices</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">deviceId</span><span class="p">[]</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function registers a subset of devices (GPUs) to <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> handle. Such subset of devices is used in subsequent API calls. The array <code class="docutils literal notranslate"><span class="pre">deviceId</span></code> contains a list of logical device ID. The term <code class="docutils literal notranslate"><span class="pre">logical</span></code> means repeated device ID are permitted. For example, suppose the user has only one GPU in the system, say device 0. If the user sets <code class="docutils literal notranslate"><span class="pre">deviceId=0,0,0</span></code>, then <code class="docutils literal notranslate"><span class="pre">cuSolverMG</span></code> treats them as three independent GPUs, one stream each, so concurrent kernel launches still hold. The current design only supports up to 32 logical devices.</p>
<p><strong>Input</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p>The pointer to the handle to the cuSolverMG context.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">nbDevices</span></code></p></td>
<td><p>The number of logical devices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">deviceId</span></code></p></td>
<td><p>An integer array of size <code class="docutils literal notranslate"><span class="pre">nbDevices</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The initialization succeeded.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nbDevices</span></code> must be greater than zero, and less or equal to 32.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ALLOC_FAILED</span></code></p></td>
<td><p>The resources could not be allocated.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>Internal error occurred when setting internal streams and events.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgcreatedevicegrid">
<h3>
<span class="section-number">3.3.4. </span>cusolverMgCreateDeviceGrid()<a class="headerlink" href="index.html#cusolvermgcreatedevicegrid" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgCreateDeviceGrid</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgGrid_t</span><span class="o">*</span><span class="w"> </span><span class="n">grid</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">numRowDevices</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">numColDevices</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">deviceId</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgGridMapping_t</span><span class="w"> </span><span class="n">mapping</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets up a grid of devices.</p>
<p>Only 1-D column block cyclic is supported, so <code class="docutils literal notranslate"><span class="pre">numRowDevices</span></code> must be equal to 1.</p>
<p>WARNING: <code class="docutils literal notranslate"><span class="pre">cusolverMgCreateDeviceGrid()</span></code> must be consistent with <code class="docutils literal notranslate"><span class="pre">cusolverMgDeviceSelect()</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">numColDevices</span></code> must be equal to <code class="docutils literal notranslate"><span class="pre">nbDevices</span></code> in <code class="docutils literal notranslate"><span class="pre">cusolverMgDeviceSelect()</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The pointer to the opaque structure.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">numRowDevices</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of devices in the row.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">numColDevices</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of devices in the column.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">deviceId</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Integer array of size <code class="docutils literal notranslate"><span class="pre">numColDevices</span></code>, containing device IDs.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">mapping</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Row-major or column-major ordering.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 33%">
<col style="width: 67%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">numColDevices</span></code> is not greater than 0. <code class="docutils literal notranslate"><span class="pre">numRowDevices</span></code> is not 1.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgdestroygrid">
<h3>
<span class="section-number">3.3.5. </span>cusolverMgDestroyGrid()<a class="headerlink" href="index.html#cusolvermgdestroygrid" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgDestroyGrid</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgGrid_t</span><span class="w"> </span><span class="n">grid</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function releases resources of a grid.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 18%">
<col style="width: 16%">
<col style="width: 21%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>MemSpace</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input/output</span></code></p></td>
<td><p>The pointer to the opaque structure.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgcreatematdescr">
<h3>
<span class="section-number">3.3.6. </span>cusolverMgCreateMatDescr()<a class="headerlink" href="index.html#cusolvermgcreatematdescr" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgCreateMatrixDesc</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgMatrixDesc_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">desc</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">numRows</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">numCols</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">rowBlockSize</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">colBlockSize</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">dataType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cusolverMgGrid_t</span><span class="w"> </span><span class="n">grid</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function sets up the matrix descriptor <code class="docutils literal notranslate"><span class="pre">desc</span></code>.</p>
<p>Only 1-D column block cyclic is supported, so <code class="docutils literal notranslate"><span class="pre">numRows</span></code> must be equal to <code class="docutils literal notranslate"><span class="pre">rowBlockSize</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>The matrix descriptor.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">numRows</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows of global A.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">numCols</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of columns of global A.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">rowBlockSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of rows per tile.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">colBlockSize</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The number of columns per tile.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of the matrix.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The pointer to structure of grid.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 79%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">numRows</span></code>, <code class="docutils literal notranslate"><span class="pre">numCols</span></code>, or <code class="docutils literal notranslate"><span class="pre">rowBlockSize</span></code> or <code class="docutils literal notranslate"><span class="pre">colBlockSize</span></code> is less than 0. <code class="docutils literal notranslate"><span class="pre">numRows</span></code> is not equal to <code class="docutils literal notranslate"><span class="pre">rowBlockSize</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgdestroymatrixdesc">
<h3>
<span class="section-number">3.3.7. </span>cusolverMgDestroyMatrixDesc()<a class="headerlink" href="index.html#cusolvermgdestroymatrixdesc" title="Permalink to this headline"></a>
</h3>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgDestroyMatrixDesc</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgMatrixDesc_t</span><span class="w"> </span><span class="n">desc</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function releases the matrix descriptor <code class="docutils literal notranslate"><span class="pre">desc</span></code>.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 26%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input/output</span></code></p></td>
<td><p>The matrix descriptor.</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 42%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-linear-solver-reference">
<h2>
<span class="section-number">3.4. </span>Dense Linear Solver Reference<a class="headerlink" href="index.html#dense-linear-solver-reference" title="Permalink to this headline"></a>
</h2>
<p>This section describes the linear solver API of cuSolverMG.</p>
<section id="cusolvermgpotrf">
<h3>
<span class="section-number">3.4.1. </span>cusolverMgPotrf()<a class="headerlink" href="index.html#cusolvermgpotrf" title="Permalink to this headline"></a>
</h3>
<p>The following helper function can calculate the sizes needed for pre-allocated buffer for <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code>:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>computes the Cholesky factorization of a Hermitian positive-definite matrix using the generic API interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is an <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix; only lower or upper part is meaningful. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other parts untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by lower triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">L</span></code>:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced by upper triangular Cholesky factor <code class="docutils literal notranslate"><span class="pre">U</span></code>:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in j-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is the number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf_bufferSize()</span></code>.</p>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> is not positive definite, or equivalently some diagonal elements of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> is not a real number. The output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> would indicate smallest leading minor of <code class="docutils literal notranslate"><span class="pre">A</span></code> which is not positive definite.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, and<code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code> only supports the following four combinations.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgPotrf">cuSOLVER Library Samples - MgPotrf</a> for a code example.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRF</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>API of potrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMg library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced. Only <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> is supported.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">N</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the factors <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Sze of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code>, the leading minor of order <code class="docutils literal notranslate"><span class="pre">i</span></code> is not positive definite.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">M,N&lt;0</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgpotrs">
<h3>
<span class="section-number">3.4.2. </span>cusolverMgPotrs()<a class="headerlink" href="index.html#cusolvermgpotrs" title="Permalink to this headline"></a>
</h3>
<p>The helper function below can calculate the sizes needed for pre-allocated buffer for <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrs</span></code>.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotrs_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_B</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nrhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_B</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a system of linear equations:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">n×n</span></code> Hermitian matrix, only lower or upper part is meaningful using the generic API interface. The input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> indicates which part of the matrix is used. The function would leave other parts untouched.</p>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the matrix should <code class="docutils literal notranslate"><span class="pre">A</span></code> contain the lower triangular factor for Cholesky decomposition previously computed by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H}\)</span></p></td>
</tr>
</tbody>
</table>
<p>If input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the matrix should <code class="docutils literal notranslate"><span class="pre">A</span></code> contain the upper triangular factor for Cholesky decomposition previously computed by the <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code> routine.</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The operation is in-place, i.e. matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> contains the solution of the linear system on exit.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is the number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in the <code class="docutils literal notranslate"><span class="pre">j</span></code>-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrs_bufferSize()</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th parameter is wrong (not counting handle).</p>
<p>The generic API has four different types: <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> and <code class="docutils literal notranslate"><span class="pre">descrB</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> and so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> and <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrs</span></code> only supports the following four combinations.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgPotrf">cuSOLVER Library Samples - MgPotrf</a> for a code example.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeB</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRS</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>API of potrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMg library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced. Only <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> is supported.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">NRHS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> and <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">N</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the factors <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">NRHS</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the solution to the linear system.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">IB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array B indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">JB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array B indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix B.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrs_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the routine successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">M,N&lt;0</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermgpotri">
<h3>
<span class="section-number">3.4.3. </span>cusolverMgPotri()<a class="headerlink" href="index.html#cusolvermgpotri" title="Permalink to this headline"></a>
</h3>
<p>The helper function below can calculate the sizes needed for pre-allocated buffer for <code class="docutils literal notranslate"><span class="pre">cusolverMgPotri</span></code>.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotri_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The following routine:</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="n">cusolverMgPotri</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the inverse of a Hermitian positive-definite matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> using the Cholesky factorization</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A = L*L^{H} = U^{H}*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>computed by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf()</span></code>.</p>
<p>If the input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, on input, matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the lower triangular factor of <code class="docutils literal notranslate"><span class="pre">A</span></code> computed by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code>. Only lower triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced the by lower triangular part of the inverse of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>If the input parameter <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, on input, matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the upper triangular factor of <code class="docutils literal notranslate"><span class="pre">A</span></code> computed by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotrf</span></code>. Only upper triangular part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is processed, and replaced the by upper triangular part of the inverse of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in the <code class="docutils literal notranslate"><span class="pre">j</span></code>-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotri_bufferSize()</span></code>.</p>
<p>If the computation of the inverse fails, i.e. some leading minor of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code>, is null, the output parameter <code class="docutils literal notranslate"><span class="pre">info</span></code> would indicate the smallest leading minor of <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">U</span></code> which is not positive definite.</p>
<p>If the output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting the handle).</p>
<p>The generic API has two different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgPotri</span></code> only supports the following four combinations.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgPotrf">cuSOLVER Library Samples - MgPotrf</a> for a code example.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SPOTRI</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DPOTRI</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CPOTRI</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZPOTRI</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>API of potrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMg library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Indicates if matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> lower or upper part is stored, the other part is not referenced. Only <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> is supported.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">N</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the upper or lower triangular part of the inverse of A depending on the value of <code class="docutils literal notranslate"><span class="pre">uplo</span></code> argument.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgPotri_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the Cholesky factorization is successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the leading minor of order i is zero.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 38%">
<col style="width: 62%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_NOT_INITIALIZED</span></code></p></td>
<td><p>The library was not initialized.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">M,N&lt;0</span></code>).</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_ARCH_MISMATCH</span></code></p></td>
<td><p>The device only supports compute capability 5.0 and above.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermggetrf">
<h3>
<span class="section-number">3.4.4. </span>cusolverMgGetrf()<a class="headerlink" href="index.html#cusolvermggetrf" title="Permalink to this headline"></a>
</h3>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgGetrf_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_IPIV</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgGetrf</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_IPIV</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes the LU factorization of a <code class="docutils literal notranslate"><span class="pre">M×N</span></code> matrix</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(P*A = L*U\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">M×N</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">P</span></code> is a permutation matrix, <code class="docutils literal notranslate"><span class="pre">L</span></code> is a lower triangular matrix with unit diagonal, and <code class="docutils literal notranslate"><span class="pre">U</span></code> is an upper triangular matrix.</p>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in j-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrf_bufferSize()</span></code>.</p>
<p>If LU factorization failed, i.e. matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> (<code class="docutils literal notranslate"><span class="pre">U</span></code>) is singular, The output parameter <code class="docutils literal notranslate"><span class="pre">info=i</span></code> indicates <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code> is null, no pivoting is performed. The factorization is <code class="docutils literal notranslate"><span class="pre">A=L*U</span></code>, which is not numerically stable.</p>
<p><code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code> must be consistent with <code class="docutils literal notranslate"><span class="pre">array_d_A</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">JA</span></code> is the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>, also the first column of <code class="docutils literal notranslate"><span class="pre">sub(IPIV)</span></code>.</p>
<p>No matter LU factorization failed or not, the output parameter <code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code> contains pivoting sequence, row <code class="docutils literal notranslate"><span class="pre">i</span></code> is interchanged with row <code class="docutils literal notranslate"><span class="pre">array_d_IPIV(i)</span></code>.</p>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrf</span></code> only supports the following four combinations.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgGetrf">cuSOLVER Library Samples - MgGetrf</a> for a code example.</p>
<p><strong>valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRF</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRF</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRF</span></code></p></td>
</tr>
</tbody>
</table>
<p>Remark 1: tile size <code class="docutils literal notranslate"><span class="pre">TA</span></code> must be less or equal to 512.</p>
<p><strong>API of getrf</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMg library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">N</span></code>. On exit, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the factors <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. it contains a distributed integer array containing <code class="docutils literal notranslate"><span class="pre">sub(IPIV)</span></code> of size <code class="docutils literal notranslate"><span class="pre">min(M,N)</span></code>. <code class="docutils literal notranslate"><span class="pre">sub(IPIV)</span></code> contains pivot indices.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrf_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the LU factorization is successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span></code>, the <code class="docutils literal notranslate"><span class="pre">U(i,i)</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 44%">
<col style="width: 56%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">M,N&lt;0</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cusolvermggetrs">
<h3>
<span class="section-number">3.4.5. </span>cusolverMgGetrs()<a class="headerlink" href="index.html#cusolvermggetrs" title="Permalink to this headline"></a>
</h3>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgGetrs_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">TRANS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NRHS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_IPIV</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_B</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgGetrs</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasOperation_t</span><span class="w"> </span><span class="n">TRANS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NRHS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_IPIV</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_B</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function solves a linear system of multiple right-hand sides</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\({op(A)}*X = B\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <code class="docutils literal notranslate"><span class="pre">N×N</span></code> matrix, and was LU-factored by <code class="docutils literal notranslate"><span class="pre">getrf</span></code>, that is, lower triangular part of A is <code class="docutils literal notranslate"><span class="pre">L</span></code>, and upper triangular part (including diagonal elements) of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">U</span></code>. <code class="docutils literal notranslate"><span class="pre">B</span></code> is a <code class="docutils literal notranslate"><span class="pre">N×NRHS</span></code> right-hand side matrix. The solution matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> overwrites the right-hand-side matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<p>The input parameter <code class="docutils literal notranslate"><span class="pre">TRANS</span></code> is defined by</p>
<p><span class="math notranslate nohighlight">\(\text{op}(A) = \left\{ \begin{matrix}
A &amp; {\text{if~}\textsf{TRANS\ ==\ CUBLAS\_OP\_N}} \\
A^{T} &amp; {\text{if~}\textsf{TRANS\ ==\ CUBLAS\_OP\_T}} \\
A^{H} &amp; {\text{if~}\textsf{TRANS\ ==\ CUBLAS\_OP\_C}} \\
\end{matrix} \right.\)</span></p>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in j-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrs_bufferSize()</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code> is null, no pivoting is performed. Otherwise, <code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code> is an output of <code class="docutils literal notranslate"><span class="pre">getrf</span></code>. It contains pivot indices, which are used to permutate right-hand sides.</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. <code class="docutils literal notranslate"><span class="pre">descrB</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeB</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrs</span></code> only supports the following four combinations.</p>
<p><strong>Valid combinations of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeB</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DGETRS</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGETRS</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZGETRS</span></code></p></td>
</tr>
</tbody>
</table>
<p>Remark 1: tile size <code class="docutils literal notranslate"><span class="pre">TA</span></code> must be less or equal to 512.</p>
<p>Remark 2: only support <code class="docutils literal notranslate"><span class="pre">TRANS=CUBLAS_OP_N</span></code>.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgGetrf">cuSOLVER Library Samples - MgGetrf</a> for a code example.</p>
<p><strong>API of getrs</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMG library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">TRANS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Operation <code class="docutils literal notranslate"><span class="pre">op(A)</span></code> that is non- or (conj.) transpose.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows and columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">NRHS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of columns of matrix <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">N</span></code>. <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the factors <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_IPIV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. it contains a distributed integer array containing <code class="docutils literal notranslate"><span class="pre">sub(IPIV)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">min(M,N)</span></code>. <code class="docutils literal notranslate"><span class="pre">sub(IPIV)</span></code> contains pivot indices.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">NRHS</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">IB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array B indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">JB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array B indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(B)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">descrB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix B.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgGetrs_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 39%">
<col style="width: 61%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">N&lt;0</span></code> or <code class="docutils literal notranslate"><span class="pre">NRHS&lt;0</span></code>).</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dense-eigenvalue-solver-reference">
<h2>
<span class="section-number">3.5. </span>Dense Eigenvalue Solver Reference<a class="headerlink" href="index.html#dense-eigenvalue-solver-reference" title="Permalink to this headline"></a>
</h2>
<p>This section describes the eigenvalue solver API of cuSolverMG.</p>
<section id="cusolvermgsyevd">
<h3>
<span class="section-number">3.5.1. </span>cusolverMgSyevd()<a class="headerlink" href="index.html#cusolvermgsyevd" title="Permalink to this headline"></a>
</h3>
<p>The helper functions below can calculate the sizes needed for pre-allocated buffer.</p>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgSyevd_bufferSize</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="o">*</span><span class="n">lwork</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-c++ notranslate">
<div class="highlight"><pre><span></span><span class="n">cusolverStatus_t</span><span class="w"></span>
<span class="nf">cusolverMgSyevd</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverMgHandle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cusolverEigMode_t</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cublasFillMode_t</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_A</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">IA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">JA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaLibMgMatrixDesc_t</span><span class="w"> </span><span class="n">descrA</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">W</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">dataTypeW</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">cudaDataType_t</span><span class="w"> </span><span class="n">computeType</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">array_d_work</span><span class="p">[],</span><span class="w"></span>
<span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) <code class="docutils literal notranslate"><span class="pre">N×N</span></code> matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The standard symmetric eigenvalue problem is:</p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><span class="math notranslate nohighlight">\(A*V = V*\Lambda\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <code class="docutils literal notranslate"><span class="pre">Λ</span></code> is a real <code class="docutils literal notranslate"><span class="pre">N×N</span></code> diagonal matrix. <code class="docutils literal notranslate"><span class="pre">V</span></code> is an <code class="docutils literal notranslate"><span class="pre">N×N</span></code> unitary matrix. The diagonal elements of <code class="docutils literal notranslate"><span class="pre">Λ</span></code> are the eigenvalues of <code class="docutils literal notranslate"><span class="pre">A</span></code> in ascending order.</p>
<p><code class="docutils literal notranslate"><span class="pre">cusolverMgSyevd</span></code> returns the eigenvalues in <code class="docutils literal notranslate"><span class="pre">W</span></code> and overwrites the eigenvectors in <code class="docutils literal notranslate"><span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">W</span></code> is a host <code class="docutils literal notranslate"><span class="pre">1×N</span></code> vector.</p>
<p>The generic API has three different types, <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code> is data type of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code> is data type of the vector <code class="docutils literal notranslate"><span class="pre">W</span></code>, and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is compute type of the operation and data type of the workspace (<code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>) <code class="docutils literal notranslate"><span class="pre">descrA</span></code> contains <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>, so there is no explicit parameter of <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. <code class="docutils literal notranslate"><span class="pre">cusolverMgSyevd</span></code> only supports the following four combinations.</p>
<p><strong>Valid combination of data type and compute type</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>DataTypeA</strong></p></th>
<th class="head"><p><strong>DataTypeW</strong></p></th>
<th class="head"><p><strong>ComputeType</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SSYEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DSYEVD</span></code></p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_32F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHEEVD</span></code></p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_R_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CUDA_C_64F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZHEEVD</span></code></p></td>
</tr>
</tbody>
</table>
<p>The user has to provide device working space in <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work</span></code> is a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>, where <code class="docutils literal notranslate"><span class="pre">G</span></code> is number of devices. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is a device pointer pointing to a device memory in j-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">computeType</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">lwork</span></code> which is number of elements per device, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgSyevd_bufferSize()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code> is also a host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_A[j]</span></code> is a device pointer pointing to a device memory in j-th device. The data type of <code class="docutils literal notranslate"><span class="pre">array_d_A[j]</span></code> is <code class="docutils literal notranslate"><span class="pre">dataTypeA</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">array_d_A[j]</span></code> is about <code class="docutils literal notranslate"><span class="pre">N*TA*(blocks</span> <span class="pre">per</span>                                  <span class="pre">device)</span></code>. The user has to prepare <code class="docutils literal notranslate"><span class="pre">array_d_A</span></code> manually (see<a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgSyevd">cuSOLVER Library Samples - MgSyevd</a> for a code example.).</p>
<p>If output parameter <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code> (less than zero), the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle). If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">i</span></code> (greater than zero), <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = CUSOLVER_EIG_MODE_VECTOR, <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. The eigenvectors are computed by a divide and conquer algorithm.</p>
<p>Remark 1: only <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> is supported, so the user has to prepare lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>Remark 2: only <code class="docutils literal notranslate"><span class="pre">IA=1</span></code> and <code class="docutils literal notranslate"><span class="pre">JA=1</span></code> are supported.</p>
<p>Remark 3: tile size <code class="docutils literal notranslate"><span class="pre">TA</span></code> must be less or equal to 1024. To achieve best performance, <code class="docutils literal notranslate"><span class="pre">TA</span></code> should be 256 or 512.</p>
<p>Please visit <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuSOLVER/MgSyevd">cuSOLVER Library Samples - MgSyevd</a> for a code example.</p>
<p><strong>API of syevd</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="row-odd">
<th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Memory</strong></p></th>
<th class="head"><p><strong>In/out</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">handle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Handle to the cuSolverMG library context.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">jobz</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td>
<p>Specifies options to either compute eigenvalue only or compute eigen-pair:</p>
<p><code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> : Compute eigenvalues only</p>
<p><code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code> : Compute eigenvalues and eigenvectors</p>
</td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">uplo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td>
<p>Specifies which part of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p>
<p><code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>: Lower triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p>
<p><code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>: Upper triangle of <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored.</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code> is supported.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Number of rows (or columns) of matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td>
<p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. It contains a distributed &lt;type&gt; array containing <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> of dimension <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">N</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_UPPER</span></code>, the leading N-by-N upper triangular part of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the upper triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">uplo</span></code> = <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, the leading N-by-N lower triangular part of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the lower triangular part of the matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>. On exit, if <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span></code> = 0, <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code> contains the orthonormal eigenvectors of the matrix <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">jobz</span></code> = <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code>, the contents of <code class="docutils literal notranslate"><span class="pre">A</span></code> are destroyed.</p>
</td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">IA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The row index in the global array A indicating the first row of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">JA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>The column index in the global array A indicating the first column of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">descrA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Matrix descriptor for the distributed matrix A.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td><p>A real array of dimension <code class="docutils literal notranslate"><span class="pre">N</span></code>. The eigenvalue values of <code class="docutils literal notranslate"><span class="pre">sub(A)</span></code>, in ascending order ie, sorted so that <code class="docutils literal notranslate"><span class="pre">W(i)</span> <span class="pre">&lt;=</span>  <span class="pre">W(i+1)</span></code>.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">dataTypeW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type of the vector W.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">computeType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Data type used for computation.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">array_d_work</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in/out</span></code></p></td>
<td><p>A host pointer array of dimension <code class="docutils literal notranslate"><span class="pre">G</span></code>. <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code> points to a device working space in <code class="docutils literal notranslate"><span class="pre">j-th</span></code> device, &lt;type&gt; array of size <code class="docutils literal notranslate"><span class="pre">lwork</span></code>.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">lwork</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p></td>
<td><p>Size of <code class="docutils literal notranslate"><span class="pre">array_d_work[j]</span></code>, returned by <code class="docutils literal notranslate"><span class="pre">cusolverMgSyevd_bufferSize</span></code>. <code class="docutils literal notranslate"><span class="pre">lwork</span></code> denotes number of elements, not number of bytes.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">info</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p></td>
<td>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">0</span></code>, the operation is successful.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span> <span class="pre">-i</span></code>, the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> parameter is wrong (not counting handle).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">=</span>  <span class="pre">i</span> <span class="pre">(&gt;</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code> indicates <code class="docutils literal notranslate"><span class="pre">i</span></code> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Status Returned</strong></p>
<table class="table-no-stripes docutils align-default">
<colgroup>
<col style="width: 9%">
<col style="width: 91%">
</colgroup>
<tbody>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_SUCCESS</span></code></p></td>
<td><p>The operation completed successfully.</p></td>
</tr>
<tr class="row-even">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INVALID_VALUE</span></code></p></td>
<td><p>Invalid parameters were passed (<code class="docutils literal notranslate"><span class="pre">N&lt;0</span></code>, or <code class="docutils literal notranslate"><span class="pre">lda&lt;max(1,N)</span></code>, or <code class="docutils literal notranslate"><span class="pre">jobz</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_NOVECTOR</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSOLVER_EIG_MODE_VECTOR</span></code>, or <code class="docutils literal notranslate"><span class="pre">uplo</span></code> is not <code class="docutils literal notranslate"><span class="pre">CUBLAS_FILL_MODE_LOWER</span></code>, or <code class="docutils literal notranslate"><span class="pre">IA</span></code> and <code class="docutils literal notranslate"><span class="pre">JA</span></code> are not 1, or <code class="docutils literal notranslate"><span class="pre">N</span></code> is bigger than dimension of global <code class="docutils literal notranslate"><span class="pre">A</span></code>, or the combination of <code class="docutils literal notranslate"><span class="pre">dataType</span></code> and <code class="docutils literal notranslate"><span class="pre">computeType</span></code> is not valid.</p></td>
</tr>
<tr class="row-odd">
<td><p><code class="docutils literal notranslate"><span class="pre">CUSOLVER_STATUS_INTERNAL_ERROR</span></code></p></td>
<td><p>An internal operation failed.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="acknowledgements">
<h1>
<span class="section-number">4. </span>Acknowledgements<a class="headerlink" href="index.html#acknowledgements" title="Permalink to this headline"></a>
</h1>
<p>NVIDIA would like to thank the following individuals and institutions for their contributions:</p>
<ul class="simple">
<li><p>CPU LAPACK routines from netlib, CLAPACK-3.2.1 (<a class="reference external" href="http://www.netlib.org/clapack/">http://www.netlib.org/clapack/</a>)</p></li>
</ul>
<p>The following is license of CLAPACK-3.2.1.</p>
<p>Copyright (c) 1992-2008 The University of Tennessee. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul class="simple">
<li><p>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</p></li>
<li><p>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer listed in this license in the documentation and/or other materials provided with the distribution.</p></li>
<li><p>Neither the name of the copyright holders nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p></li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<ul class="simple">
<li><p>METIS-5.1.0 (<a class="reference external" href="http://glaros.dtc.umn.edu/gkhome/metis/metis/overview">http://glaros.dtc.umn.edu/gkhome/metis/metis/overview</a>)</p></li>
</ul>
<p>The following is license of METIS (Apache 2.0 license).</p>
<p>Copyright 1995-2013, Regents of the University of Minnesota</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<ul class="simple">
<li><p>QD (A C++/fortran-90 double-double and quad-double package) (<a class="reference external" href="http://crd-legacy.lbl.gov/~dhbailey/mpdist/">http://crd-legacy.lbl.gov/~dhbailey/mpdist/</a>)</p></li>
</ul>
<p>The following is license of QD (modified BSD license).</p>
<p>Copyright (c) 2003-2009, The Regents of the University of California, through Lawrence Berkeley National Laboratory (subject to receipt of any required approvals from U.S. Dept. of Energy) All rights reserved.</p>
<ol class="arabic simple">
<li><p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p></li>
</ol>
<ol class="arabic simple">
<li><p>Redistributions of source code must retain the copyright notice, this list of conditions and the following disclaimer.</p></li>
<li><p>Redistributions in binary form must reproduce the copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</p></li>
<li><p>Neither the name of the University of California, Lawrence Berkeley National Laboratory, U.S. Dept. of Energy nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p></li>
<li><p>You are under no obligation whatsoever to provide any bug fixes, patches, or upgrades to the features, functionality or performance of the source code (“Enhancements”) to anyone; however, if you choose to make your Enhancements available either publicly, or directly to Lawrence Berkeley National Laboratory, without imposing a separate written license agreement for such Enhancements, then you hereby grant the following license: a non-exclusive, royalty-free perpetual license to install, use, modify, prepare derivative works, incorporate into other computer software, distribute, and sublicense such enhancements or derivative works thereof, in binary and source code form.</p></li>
</ol>
</section>
<section id="bibliography">
<h1>
<span class="section-number">5. </span>Bibliography<a class="headerlink" href="index.html#bibliography" title="Permalink to this headline"></a>
</h1>
<p>[1] Timothy A. Davis, Direct Methods for sparse Linear Systems, siam 2006.</p>
<p>[2] E. Chuthill and J. McKee, reducing the bandwidth of sparse symmetric matrices, ACM ‘69 Proceedings of the 1969 24th national conference, Pages 157-172.</p>
<p>[3] Alan George, Joseph W. H. Liu, An Implementation of a Pseudoperipheral Node Finder, ACM Transactions on Mathematical Software (TOMS) Volume 5 Issue 3, Sept. 1979 Pages 284-295.</p>
<p>[4] J. R. Gilbert and T. Peierls, Sparse partial pivoting in time proportional to arithmetic operations, SIAM J. Sci. Statist. Comput., 9 (1988), pp. 862-874.</p>
<p>[5] Alan George and Esmond Ng, An Implementation of Gaussian Elimination with Partial Pivoting for Sparse Systems, SIAM J. Sci. and Stat. Comput., 6(2), 390-409.</p>
<p>[6] Alan George and Esmond Ng, Symbolic Factorization for Sparse Gaussian Elimination with Partial Pivoting, SIAM J. Sci. and Stat. Comput., 8(6), 877-898.</p>
<p>[7] John R. Gilbert, Xiaoye S. Li, Esmond G. Ng, Barry W. Peyton, Computing Row and Column Counts for Sparse QR and LU Factorization, BIT 2001, Vol. 41, No. 4, pp. 693-711.</p>
<p>[8] Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff, An Approximate Minimum Degree Ordering Algorithm, SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.</p>
<p>[9] Alan George, Joseph W. Liu, A Fast Implementation of the Minimum Degree Algorithm Using Quotient Graphs, ACM Transactions on Mathematical Software, Vol 6, No. 3, September 1980, page 337-358.</p>
<p>[10] Alan George, Joseph W. Liu, Computer Solution of Large Sparse Positive Definite Systems, Englewood Cliffs, New Jersey: Prentice-Hall, 1981.</p>
<p>[11] Iain S. Duff, ALGORITHM 575 Permutations for a Zero-Free Diagonal, ACM Transactions on Mathematical Software, Vol 7, No 3, September 1981, Page 387-390</p>
<p>[12] Iain S. Duff and Jacko Koster, On algorithms for permuting large entries to the diagonal of a sparse matrix, SIAM Journal on Matrix Analysis and Applications, 2001, Vol. 22, No. 4 : pp. 973-996</p>
<p>[13] “A Fast and Highly Quality Multilevel Scheme for Partitioning Irregular Graphs”. George Karypis and Vipin Kumar. SIAM Journal on Scientific Computing, Vol. 20, No. 1, pp. 359-392, 1999.</p>
<p>[14] YUJI NAKATSUKASA, ZHAOJUN BAI, AND FRANC¸OIS GYGI, OPTIMIZING HALLEY’S ITERATION FOR COMPUTING THE MATRIX POLAR DECOMPOSITION, SIAM J. Matrix Anal. Appl., 31 (5): 2700-2720,2010</p>
<p>[15] Halko, Nathan, Per-Gunnar Martinsson, and Joel A. Tropp. “Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions.” SIAM review 53.2 (2011): 217-288.</p>
</section>
<section id="notices">
<h1>
<span class="section-number">6. </span>Notices<a class="headerlink" href="index.html#notices" title="Permalink to this headline"></a>
</h1>
<section id="notice">
<h2>
<span class="section-number">6.1. </span>Notice<a class="headerlink" href="index.html#notice" title="Permalink to this headline"></a>
</h2>
<p>This document is provided for information purposes only and shall not be regarded as a warranty of a certain functionality, condition, or quality of a product. NVIDIA Corporation (“NVIDIA”) makes no representations or warranties, expressed or implied, as to the accuracy or completeness of the information contained in this document and assumes no responsibility for any errors contained herein. NVIDIA shall have no liability for the consequences or use of such information or for any infringement of patents or other rights of third parties that may result from its use. This document is not a commitment to develop, release, or deliver any Material (defined below), code, or functionality.</p>
<p>NVIDIA reserves the right to make corrections, modifications, enhancements, improvements, and any other changes to this document, at any time without notice.</p>
<p>Customer should obtain the latest relevant information before placing orders and should verify that such information is current and complete.</p>
<p>NVIDIA products are sold subject to the NVIDIA standard terms and conditions of sale supplied at the time of order acknowledgement, unless otherwise agreed in an individual sales agreement signed by authorized representatives of NVIDIA and customer (“Terms of Sale”). NVIDIA hereby expressly objects to applying any customer general terms and conditions with regards to the purchase of the NVIDIA product referenced in this document. No contractual obligations are formed either directly or indirectly by this document.</p>
<p>NVIDIA products are not designed, authorized, or warranted to be suitable for use in medical, military, aircraft, space, or life support equipment, nor in applications where failure or malfunction of the NVIDIA product can reasonably be expected to result in personal injury, death, or property or environmental damage. NVIDIA accepts no liability for inclusion and/or use of NVIDIA products in such equipment or applications and therefore such inclusion and/or use is at customer’s own risk.</p>
<p>NVIDIA makes no representation or warranty that products based on this document will be suitable for any specified use. Testing of all parameters of each product is not necessarily performed by NVIDIA. It is customer’s sole responsibility to evaluate and determine the applicability of any information contained in this document, ensure the product is suitable and fit for the application planned by customer, and perform the necessary testing for the application in order to avoid a default of the application or the product. Weaknesses in customer’s product designs may affect the quality and reliability of the NVIDIA product and may result in additional or different conditions and/or requirements beyond those contained in this document. NVIDIA accepts no liability related to any default, damage, costs, or problem which may be based on or attributable to: (i) the use of the NVIDIA product in any manner that is contrary to this document or (ii) customer product designs.</p>
<p>No license, either expressed or implied, is granted under any NVIDIA patent right, copyright, or other NVIDIA intellectual property right under this document. Information published by NVIDIA regarding third-party products or services does not constitute a license from NVIDIA to use such products or services or a warranty or endorsement thereof. Use of such information may require a license from a third party under the patents or other intellectual property rights of the third party, or a license from NVIDIA under the patents or other intellectual property rights of NVIDIA.</p>
<p>Reproduction of information in this document is permissible only if approved in advance by NVIDIA in writing, reproduced without alteration and in full compliance with all applicable export laws and regulations, and accompanied by all associated conditions, limitations, and notices.</p>
<p>THIS DOCUMENT AND ALL NVIDIA DESIGN SPECIFICATIONS, REFERENCE BOARDS, FILES, DRAWINGS, DIAGNOSTICS, LISTS, AND OTHER DOCUMENTS (TOGETHER AND SEPARATELY, “MATERIALS”) ARE BEING PROVIDED “AS IS.” NVIDIA MAKES NO WARRANTIES, EXPRESSED, IMPLIED, STATUTORY, OR OTHERWISE WITH RESPECT TO THE MATERIALS, AND EXPRESSLY DISCLAIMS ALL IMPLIED WARRANTIES OF NONINFRINGEMENT, MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT WILL NVIDIA BE LIABLE FOR ANY DAMAGES, INCLUDING WITHOUT LIMITATION ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE, OR CONSEQUENTIAL DAMAGES, HOWEVER CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF ANY USE OF THIS DOCUMENT, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. Notwithstanding any damages that customer might incur for any reason whatsoever, NVIDIA’s aggregate and cumulative liability towards customer for the products described herein shall be limited in accordance with the Terms of Sale for the product.</p>
</section>
<section id="opencl">
<h2>
<span class="section-number">6.2. </span>OpenCL<a class="headerlink" href="index.html#opencl" title="Permalink to this headline"></a>
</h2>
<p>OpenCL is a trademark of Apple Inc. used under license to the Khronos Group Inc.</p>
</section>
<section id="trademarks">
<h2>
<span class="section-number">6.3. </span>Trademarks<a class="headerlink" href="index.html#trademarks" title="Permalink to this headline"></a>
</h2>
<p>NVIDIA and the NVIDIA logo are trademarks or registered trademarks of NVIDIA Corporation in the U.S. and other countries. Other company and product names may be trademarks of the respective companies with which they are associated.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr>

  <div role="contentinfo">
<img src="../_static/NVIDIA-LogoBlack.svg" class="only-light">
<img src="../_static/NVIDIA-LogoWhite.svg" class="only-dark">

<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>

<p>
  Copyright © 2014-2024, NVIDIA Corporation &amp; affiliates. All rights reserved.
</p>

    <p>
      <span class="lastupdated">Last updated on Aug 1, 2024.
      </span></p>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
 
<script type="text/javascript">if (typeof _satellite !== "undefined"){_satellite.pageBottom();}</script>
 


<script type="text/javascript">_satellite.pageBottom();</script>
</body>
</html>
