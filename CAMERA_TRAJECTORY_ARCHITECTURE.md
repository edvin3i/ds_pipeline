# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –∫–∞–º–µ—Ä—ã

## üìä –û–±—â–∞—è —Å—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         GStreamer Pipeline (30 FPS)                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               analysis_probe_handler.handle_analysis_probe()                ‚îÇ
‚îÇ                     (–∫–∞–∂–¥—ã–µ ~0.5 —Å–µ–∫ –∏–∑ YOLO)                              ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  1. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤—ã–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ YOLO                            ‚îÇ
‚îÇ  2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –º—è—á ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç history.add_detection() —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—è—á –Ω–∞–π–¥–µ–Ω‚îÇ
‚îÇ  3. –û–±–Ω–æ–≤–ª—è–µ—Ç players_history                                              ‚îÇ
‚îÇ  4. ‚ú® –í–´–ó–´–í–ê–ï–¢ update_camera_trajectory_on_timer() ‚ú® (–ù–ï–ó–ê–í–ò–°–ò–ú–û –æ—Ç –º—è—á–∞!) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ                                      ‚îÇ
                ‚îÇ                                      ‚îÇ
                ‚îÇ (–µ—Å–ª–∏ –º—è—á –Ω–∞–π–¥–µ–Ω)                   ‚îÇ (–í–°–ï–ì–î–ê)
                ‚îÇ                                      ‚îÇ
                ‚ñº                                      ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ history.         ‚îÇ              ‚îÇ history.                     ‚îÇ
        ‚îÇ add_detection()  ‚îÇ              ‚îÇ update_camera_trajectory_    ‚îÇ
        ‚îÇ                  ‚îÇ              ‚îÇ on_timer()                   ‚îÇ
        ‚îÇ (ball detected)  ‚îÇ              ‚îÇ (timer-based, independent)   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ                                         ‚îÇ
               ‚ñº                                         ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ _process_future_ ‚îÇ              ‚îÇ –ö–æ–ø–∏—Ä—É–µ—Ç raw_future_history  ‚îÇ
        ‚îÇ history()        ‚îÇ              ‚îÇ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ü–£–°–¢–û!)          ‚îÇ
        ‚îÇ                  ‚îÇ              ‚îÇ                              ‚îÇ
        ‚îÇ 1. Transfer      ‚îÇ              ‚îÇ –í—ã–∑—ã–≤–∞–µ—Ç POPULATE:           ‚îÇ
        ‚îÇ    to confirmed  ‚îÇ              ‚îÇ populate_camera_trajectory_  ‚îÇ
        ‚îÇ 2. Filter outliers
        ‚îÇ 3. Interpolate   ‚îÇ              ‚îÇ from_ball_history(           ‚îÇ
        ‚îÇ 4. Populate      ‚îÇ              ‚îÇ   future_only,   {–ø—É—Å—Ç–æ}     ‚îÇ
        ‚îÇ    camera_traj   ‚îÇ              ‚îÇ   players_history            ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ )                            ‚îÇ
                                          ‚îÇ                              ‚îÇ
                                          ‚îÇ –í—ã–∑—ã–≤–∞–µ—Ç FILL_GAPS:          ‚îÇ
                                          ‚îÇ fill_gaps_in_trajectory()    ‚îÇ
                                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                         ‚îÇ
                                                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             camera_trajectory.populate_camera_trajectory_from_               ‚îÇ
‚îÇ                         ball_history()                                       ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  ‚ú® –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –¥–µ–ª–∞–µ—Ç –≤—Å—ë –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ö–æ–¥–µ:                         ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –≠–¢–ê–ü 1: –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ò–ó –ú–Ø–ß–ê                                               ‚îÇ
‚îÇ  ‚îú‚îÄ –ï—Å–ª–∏ ball_history_dict –ù–ï –ü–£–°–¢–û:                                      ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—É—é —Ç–æ—á–∫—É –º—è—á–∞ –≤ camera_trajectory                   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑—Ä—ã–≤—ã (gap >= max_gap = 3.0 —Å–µ–∫)                      ‚îÇ
‚îÇ  ‚îÇ                                                                          ‚îÇ
‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ ball_history_dict –ü–£–°–¢–û (–Ω–∞—á–∞–ª–æ –∏–ª–∏ –ø–æ—Ç–µ—Ä—è):                    ‚îÇ
‚îÇ     ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç –¢–û–õ–¨–ö–û player COM (ÊØè0.5Áßí)                              ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –≠–¢–ê–ü 2: –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï –†–ê–ó–†–´–í–û–í –ò –ó–ê–ü–û–õ–ù–ï–ù–ò–ï PLAYER COM                    ‚îÇ
‚îÇ  ‚îú‚îÄ –ï—Å–ª–∏ gap >= 3.0s –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏ –º—è—á–∞:                          ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–∑—Ä—ã–≤ player COM (–∫–∞–∂–¥—ã–µ 15 –∫–∞–¥—Ä–æ–≤ = 0.5s)            ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç BLEND —Ç–æ—á–∫—É (85% –≤ —Ä–∞–∑—Ä—ã–≤, 50/50 mix)                  ‚îÇ
‚îÇ  ‚îÇ                                                                          ‚îÇ
‚îÇ  ‚îî‚îÄ –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ point                                        ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –≠–¢–ê–ü 3: –í–ù–£–¢–†–ï–ù–ù–Ø–Ø –ò–ù–¢–ï–†–ü–û–õ–Ø–¶–ò–Ø (_interpolate_gaps_internal)            ‚îÇ
‚îÇ  ‚îú‚îÄ –ú–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π —Å–æ—Å–µ–¥–Ω–∏—Ö —Ç–æ—á–µ–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏    ‚îÇ
‚îÇ  ‚îú‚îÄ –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –¥–ª—è smooth 30fps –¥–≤–∏–∂–µ–Ω–∏—è                       ‚îÇ
‚îÇ  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–ª–∞–≤–Ω–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è 30fps –±–µ–∑ —Ä—ã–≤–∫–æ–≤                       ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –≠–¢–ê–ü 4: –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï –°–ö–û–†–û–°–¢–ò (_apply_speed_scaling)                ‚îÇ
‚îÇ  ‚îî‚îÄ –í—ã—á–∏—Å–ª—è–µ—Ç ball_scale (1.0x-2.5x) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏ ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         camera_trajectory.fill_gaps_in_trajectory()                         ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  ‚ú® –í–¢–û–†–ê–Ø –§–£–ù–ö–¶–ò–Ø - –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –í –°–£–©–ï–°–¢–í–£–Æ–©–ï–ô —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏       ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –°–õ–£–ß–ê–ô 1: –ü–£–°–¢–ê–Ø –¢–†–ê–ï–ö–¢–û–†–ò–Ø (–Ω–∞—á–∞–ª–æ –∏–ª–∏ –ø–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è –Ω–∞ 7+ —Å–µ–∫)       ‚îÇ
‚îÇ  ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–µ–∫ —Ç–æ–ª—å–∫–æ player COM                          ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –°–õ–£–ß–ê–ô 2: –ü–†–û–ü–£–°–ö–ò –ú–ï–ñ–î–£ –°–û–°–ï–î–ù–ò–ú–ò –¢–û–ß–ö–ê–ú–ò                             ‚îÇ
‚îÇ  ‚îú‚îÄ –ï—Å–ª–∏ gap > 3.0s –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏:                                ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç player COM —Ç–æ—á–∫–∏ (–∫–∞–∂–¥—ã–µ 0.5s)                         ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç BLEND —Ç–æ—á–∫—É –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º                       ‚îÇ
‚îÇ  ‚îÇ                                                                          ‚îÇ
‚îÇ  ‚îî‚îÄ –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã                                                    ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ  camera_trajectory   ‚îÇ
                        ‚îÇ (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∞,‚îÇ
                        ‚îÇ  –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –∏   ‚îÇ
                        ‚îÇ  –≥–æ—Ç–æ–≤–∞ –∫ –æ—Ç—Ä–∏—Å–æ–≤–∫–µ) ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ display_probe_handler:                        ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  display_probe –≤—ã–∑—ã–≤–∞–µ—Ç:                                                   ‚îÇ
‚îÇ  ‚îú‚îÄ history_manager.get_detection_for_timestamp(ts)                       ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –º—è—á–∞ + –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–∞                ‚îÇ
‚îÇ  ‚îÇ                                                                          ‚îÇ
‚îÇ  ‚îî‚îÄ camera_trajectory.get_point_for_timestamp(ts)                        ‚îÇ
‚îÇ     ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—á–∫—É –∫–∞–º–µ—Ä—ã (–º—è—á –∏–ª–∏ player COM)                      ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ  –ó–∞—Ç–µ–º –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç:                                                       ‚îÇ
‚îÇ  ‚îú‚îÄ –ü–∞–Ω–æ—Ä–∞–º—É —Å –Ω–∞–ª–æ–∂–µ–Ω–∏–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç m—è—á–∞                                  ‚îÇ
‚îÇ  ‚îî‚îÄ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–º–µ—Ä—ã (—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ pan, tilt, zoom)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ –î–≤–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –°–∏—Å—Ç–µ–º–∞ 1Ô∏è‚É£: –ù–∞ –æ—Å–Ω–æ–≤–µ –û–ë–ù–ê–†–£–ñ–ï–ù–ò–Ø –ú–Ø–ß–ê (when ball detected)

```
–ö–û–ì–î–ê: add_detection() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—è—á –Ω–∞–π–¥–µ–Ω)
–ì–î–ï: history_manager._process_future_history()

–®–∞–≥ 1: Transfer to confirmed history
       ‚îî‚îÄ –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç "—Å—Ç–∞—Ä—ã–µ" –¥–µ—Ç–µ–∫—Ü–∏–∏ –≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫

–®–∞–≥ 2: Filter outliers
       ‚îî‚îÄ –£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–æ—Å—ã —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏

–®–∞–≥ 3: Interpolate past history
       ‚îî‚îÄ –ò–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç –º–µ–∂–¥—É point –≤ confirmed history

–®–∞–≥ 4: Populate camera trajectory
       ‚îî‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç populate_camera_trajectory_from_ball_history()
          —Å –ê–ö–¢–ò–í–ù–û–ô ball history (–µ—Å—Ç—å —Ç–æ—á–∫–∏!)
       ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–∑—Ä—ã–≤—ã >= 3.0s player COM

–®–∞–≥ 5: Fill remaining gaps
       ‚îî‚îÄ fill_gaps_in_trajectory() –∏—â–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –∫–∞–º–µ—Ä—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ–≥–¥–∞ –º—è—á –Ω–∞—Ö–æ–¥–∏—Ç—Å—è

---

### –°–∏—Å—Ç–µ–º–∞ 2Ô∏è‚É£: –ù–∞ –æ—Å–Ω–æ–≤–µ –¢–ê–ô–ú–ï–†–ê YOLO (every ~0.5 sec, INDEPENDENT)

```
–ö–û–ì–î–ê: update_camera_trajectory_on_timer() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ handle_analysis_probe()
       (–ö–ê–ñ–î–´–ï ~0.5 —Å–µ–∫, –ù–ï–ó–ê–í–ò–°–ò–ú–û –æ—Ç —Ç–æ–≥–æ, –Ω–∞–π–¥–µ–Ω –ª–∏ –º—è—á!)

–ì–î–ï: history_manager.update_camera_trajectory_on_timer()

–®–∞–≥ 1: –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å raw_future_history
       ‚îî‚îÄ future_only = raw_future_history.copy()
       ‚îî‚îÄ –ú–û–ñ–ï–¢ –ë–´–¢–¨ –ü–£–°–¢–û –µ—Å–ª–∏ –Ω–µ—Ç –º—è—á–∞!

–®–∞–≥ 2: Populate camera trajectory
       ‚îî‚îÄ populate_camera_trajectory_from_ball_history(
            future_only,    {–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ!}
            players_history
          )
       ‚îî‚îÄ –ï—Å–ª–∏ future_only –ø—É—Å—Ç–æ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç –¢–û–õ–¨–ö–û player COM
       ‚îî‚îÄ –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ—á–∫–∏ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç –º—è—á + —Ä–∞–∑—Ä—ã–≤—ã player COM

–®–∞–≥ 3: Fill gaps
       ‚îî‚îÄ fill_gaps_in_trajectory()
       ‚îî‚îÄ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –°–£–©–ï–°–¢–í–£–Æ–©–ï–ô —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –∫–∞–º–µ—Ä—ã –í–°–ï–ì–î–ê –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫, –¥–∞–∂–µ –±–µ–∑ –º—è—á–∞!

---

## üéØ –ö–ª—é—á–µ–≤–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —Å–∏—Å—Ç–µ–º–∞–º–∏

| –ê—Å–ø–µ–∫—Ç | –°–∏—Å—Ç–µ–º–∞ 1 (on detection) | –°–∏—Å—Ç–µ–º–∞ 2 (on timer) |
|--------|-------------------------|----------------------|
| **–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** | –¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –º—è—á –Ω–∞–π–¥–µ–Ω | –ö–∞–∂–¥—ã–µ ~0.5 —Å–µ–∫, –í–°–ï–ì–î–ê |
| **–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** | –ê–∫—Ç–∏–≤–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –º—è—á–∞ —Å —Ç–æ—á–∫–∞–º–∏ | –ú–æ–∂–µ—Ç –±—ã—Ç—å –ü–£–°–¢–û |
| **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏** | –ò–∑ –º—è—á–∞ + —Ä–∞–∑—Ä—ã–≤—ã player COM | –ò–∑ –º—è—á–∞ –ò–õ–ò –¢–û–õ–¨–ö–û player COM |
| **–°–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** | –ö–æ–≥–¥–∞ –º—è—á –∞–∫—Ç–∏–≤–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è | –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ 7+ —Å–µ–∫ |
| **–í–∞–∂–Ω–æ—Å—Ç—å** | –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ | **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –¥–ª—è fallback** |

---

## üìç –¢—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–∞—á–∞–ª–æ –≤–∏–¥–µ–æ (–Ω–µ—Ç –º—è—á–∞ —Å—Ä–∞–∑—É)

```
t=0-9 —Å–µ–∫: –ú—è—á –ù–ï –Ω–∞–π–¥–µ–Ω, add_detection() –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

–°–∏—Å—Ç–µ–º–∞ 1 (on detection):  ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–∫ –∫–∞–∫ add_detection() –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
–°–∏—Å—Ç–µ–º–∞ 2 (on timer):      ‚úÖ –°–†–ê–ë–û–¢–ê–ï–¢! –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.5s
                              ‚îî‚îÄ future_only –ø—É—Å—Ç–æ
                              ‚îî‚îÄ populate_camera_trajectory_from_ball_history({}, players_hist)
                              ‚îî‚îÄ –í–∏–¥–∏—Ç –ø—É—Å—Ç–æ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç –¢–û–õ–¨–ö–û player COM
                              ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–∞–º–µ—Ä–∞ –¥–≤–∏–≥–∞–µ—Ç—Å—è –ø–æ —Ü–µ–Ω—Ç—Ä—É –º–∞—Å—Å –∏–≥—Ä–æ–∫–æ–≤!
```

**–õ–æ–≥:**
```
üö® CAMERA_TRAJ: Empty ball history - using PLAYER CENTER-OF-MASS fallback
‚úÖ Filled trajectory with 8 player COM points (no ball detected)
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–∞–∑—Ä—ã–≤ 3-7 —Å–µ–∫ –≤ÁêÉ—Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏

```
t=10: –ú—è—á –Ω–∞–π–¥–µ–Ω ‚Üí add_detection() ‚Üí —Å–∏—Å—Ç–µ–º–∞ 1 —Ä–∞–±–æ—Ç–∞–µ—Ç
t=11-16: –ú—è—á –ø–æ—Ç–µ—Ä—è–Ω –Ω–∞ 5 —Å–µ–∫ (–≤ –∏—Å—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å —Ç–æ—á–∫–∏ –∏–∑ t=10 –∏ –±—É–¥—É—â–µ–π)
t=17: –ú—è—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Üí add_detection() ‚Üí —Å–∏—Å—Ç–µ–º–∞ 1 —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

–°–∏—Å—Ç–µ–º–∞ 1 (on detection –ø—Ä–∏ t=17):  ‚úÖ –í–∏–¥–∏—Ç gap 5 —Å–µ–∫ > 3 —Å–µ–∫
                                       ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç player COM points
                                       ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç blend point

–°–∏—Å—Ç–µ–º–∞ 2 (on timer –∫–∞–∂–¥—ã–µ 0.5s):  ‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏
                                       ‚îî‚îÄ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–∑–æ—Ä—ã
```

**–õ–æ–≥:**
```
üî¥ –ë–û–õ–¨–®–û–ô –†–ê–ó–†–´–í: 5.00s > 3.0s at ts=10.00‚Üí15.00
‚ûï Player COM[1] at ts=10.50: (2100, 700)
‚ûï Player COM[2] at ts=11.00: (2105, 705)
...
‚ûï Blend[transition] at ts=14.25: (2050, 650)
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –î–æ–ª–≥–∞—è –ø–æ—Ç–µ—Ä—è –º—è—á–∞ (7+ —Å–µ–∫)

```
t=0-30: –ú—è—á –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è ‚Üí –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
t=30-37: –ú—è—á –ø–æ—Ç–µ—Ä—è–Ω –Ω–∞ 7 —Å–µ–∫ ‚Üí –∏—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞ (–æ–∫–Ω–æ 10 —Å–µ–∫!)
t=37+: –°–∏—Å—Ç–µ–º–∞ 1 –Ω–µ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å, raw_future_history –ü–£–°–¢–û

–°–∏—Å—Ç–µ–º–∞ 1 (on detection): ‚ùå future_only –ø—É—Å—Ç–æ, populate() –≤–µ—Ä–Ω–µ—Ç –ø—É—Å—Ç–æ
–°–∏—Å—Ç–µ–º–∞ 2 (on timer):     ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø!
                             ‚îî‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –º—è—á–∞
                             ‚îî‚îÄ –í–∏–¥–∏—Ç –ø—É—Å—Ç–æ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç player COM
                             ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–∞–º–µ—Ä–∞ –Ω–µ "–∑–∞–≤–∏—Å–∞–µ—Ç"
```

**–õ–æ–≥:**
```
üö® CAMERA_TRAJ: Empty ball history - using PLAYER CENTER-OF-MASS fallback
‚úÖ Filled trajectory with 6 player COM points (no ball detected)
```

---

## üîç –ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### `populate_camera_trajectory_from_ball_history()` (–≤ CameraTrajectoryHistory)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `ball_history_dict`: –ò—Å—Ç–æ—Ä–∏—è –º—è—á–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ!)
- `players_history`: –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä–æ–∫–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

```python
# –≠–¢–ê–ü 1: –ï—Å–ª–∏ ball_history –ü–£–°–¢–û ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ player COM
if not ball_history_dict:
    ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç 0.5s –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã player COM
    ‚îî‚îÄ source_type = 'player_only'
    ‚îî‚îÄ –ì–æ—Ç–æ–≤–æ!

# –≠–¢–ê–ü 2: –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ—á–∫–∏ –º—è—á–∞ ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ
else:
    ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—É—é —Ç–æ—á–∫—É –º—è—á–∞
    ‚îÇ
    ‚îú‚îÄ –û–ë–ù–ê–†–£–ñ–ò–í–ê–ï–¢ –†–ê–ó–†–´–í–´ >= max_gap (3.0 —Å–µ–∫)
    ‚îÇ  ‚îî‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑—Ä—ã–≤–∞:
    ‚îÇ     ‚îú‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç player COM points (–∫–∞–∂–¥—ã–µ 15 –∫–∞–¥—Ä–æ–≤ = 0.5s)
    ‚îÇ     ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç BLEND point –Ω–∞ 85% –ø—É—Ç–∏
    ‚îÇ
    ‚îú‚îÄ –≠–¢–ê–ü 3: –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
    ‚îÇ  ‚îî‚îÄ –ú–µ–∂–¥—É –∫–∞–∂–¥–æ–π —Å–æ—Å–µ–¥–Ω–µ–π –ø–∞—Ä–æ–π –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏
    ‚îÇ  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: smooth 30fps –¥–≤–∏–∂–µ–Ω–∏–µ
    ‚îÇ
    ‚îî‚îÄ –≠–¢–ê–ü 4: Speed scaling
       ‚îî‚îÄ –í—ã—á–∏—Å–ª—è–µ—Ç ball_scale –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏
```

**–í—ã—Ö–æ–¥:** `self.camera_trajectory` –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–∞

---

### `fill_gaps_in_trajectory()` (–≤ CameraTrajectoryHistory)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `players_history`: –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä–æ–∫–æ–≤
- `current_display_ts`: –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

```python
# –°–õ–£–ß–ê–ô 1: –ü—É—Å—Ç–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è (–Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∏–ª–∏ –ø–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è)
if not times and current_display_ts:
    ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–µ–∫ –¢–û–õ–¨–ö–û player COM
    ‚îî‚îÄ source_type = 'player_init'

# –°–õ–£–ß–ê–ô 2: –ü—Ä–æ–ø—É—Å–∫–∏ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Ç–æ—á–∫–∞–º–∏
else:
    ‚îú‚îÄ –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Å–æ—Å–µ–¥–Ω–∏—Ö —Ç–æ—á–µ–∫ (ts, ts_next):
    ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ gap > max_gap (3.0 —Å–µ–∫):
    ‚îÇ     ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç player COM points –º–µ–∂–¥—É –Ω–∏–º–∏
    ‚îÇ     ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç BLEND point
    ‚îÇ
    ‚îî‚îÄ –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

**–í—ã—Ö–æ–¥:** –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∞, –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üìä –í—ã–∑–æ–≤ —Å—Ç–µ–∫–∞

```
version_masr_multiclass_REFACTORED.py
‚îÇ
‚îú‚îÄ GStreamer pipeline (30 FPS)
‚îÇ
‚îú‚îÄ analysis_probe_handler.handle_analysis_probe() [–∫–∞–∂–¥—ã–µ ~0.5 —Å–µ–∫]
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ –ï—Å–ª–∏ –º—è—á –Ω–∞–π–¥–µ–Ω:
‚îÇ  ‚îÇ  ‚îî‚îÄ history.add_detection()
‚îÇ  ‚îÇ     ‚îî‚îÄ history._process_future_history()
‚îÇ  ‚îÇ        ‚îî‚îÄ camera_trajectory.populate_camera_trajectory_from_ball_history()
‚îÇ  ‚îÇ           ‚îú‚îÄ [–≠–¢–ê–ü 1] –ó–∞–ø–æ–ª–Ω—è–µ—Ç –∏–∑ –º—è—á–∞
‚îÇ  ‚îÇ           ‚îú‚îÄ [–≠–¢–ê–ü 2] –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä—ã–≤—ã, –∑–∞–ø–æ–ª–Ω—è–µ—Ç player COM
‚îÇ  ‚îÇ           ‚îú‚îÄ [–≠–¢–ê–ü 3] –ò–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç
‚îÇ  ‚îÇ           ‚îî‚îÄ [–≠–¢–ê–ü 4] Speed scaling
‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ –í–°–ï–ì–î–ê (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ):
‚îÇ     ‚îî‚îÄ history.update_camera_trajectory_on_timer() ‚ú® –ù–û–í–û–ï!
‚îÇ        ‚îú‚îÄ –ö–æ–ø–∏—Ä—É–µ—Ç raw_future_history (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ!)
‚îÇ        ‚îú‚îÄ camera_trajectory.populate_camera_trajectory_from_ball_history()
‚îÇ        ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç –¢–û–õ–¨–ö–û player COM!
‚îÇ        ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç –º—è—á + —Ä–∞–∑—Ä—ã–≤—ã
‚îÇ        ‚îÇ
‚îÇ        ‚îî‚îÄ camera_trajectory.fill_gaps_in_trajectory()
‚îÇ           ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–ø—É—Å–∫–∏
‚îÇ
‚îî‚îÄ display_probe_handler.display_probe() [–∫–∞–∂–¥—ã–µ –∫–∞–¥—Ä, 7 —Å–µ–∫ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ]
   ‚îÇ
   ‚îú‚îÄ history.get_detection_for_timestamp()
   ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –º—è—á–∞ (–∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)
   ‚îÇ
   ‚îî‚îÄ camera_trajectory.get_point_for_timestamp()
      ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—á–∫—É –∫–∞–º–µ—Ä—ã (–º—è—á –∏–ª–∏ player COM)
```

---

## ‚ú® –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å?

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| **–ù–µ—Ç –º—è—á–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ** | –°–∏—Å—Ç–µ–º–∞ 2 (timer) –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –í–°–ï–ì–î–ê, –∑–∞–ø–æ–ª–Ω—è–µ—Ç player COM |
| **–î–æ–ª–≥–∏–µ —Ä–∞–∑—Ä—ã–≤—ã (7+ —Å–µ–∫)** | –ò—Å—Ç–æ—Ä–∏—è –º—è—á–∞ –ø—É—Å—Ç–∞, –Ω–æ timer –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è, filling with player COM |
| **–ü—Ä–æ–ø—É—Å–∫–∏ 3-7 —Å–µ–∫** | –°–∏—Å—Ç–µ–º–∞ 1 (on detection) –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ |
| **–ù–µ–ø–æ–ª–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏** | fill_gaps_in_trajectory() –∏—â–µ—Ç –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –°–£–©–ï–°–¢–í–£–Æ–©–ï–ô —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ |

---

## üìà –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ 1 –º–∏–Ω—É—Ç—ã –≤–∏–¥–µ–æ)

```
t=0-9s:    –ú—è—á –ù–ï –Ω–∞–π–¥–µ–Ω
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 1: ‚ùå
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 2: ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.5s ‚Üí cam_traj –ø–æ–ª–Ω–∞ player COM

t=9.5s:    –ú—è—á –Ω–∞–π–¥–µ–Ω!
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 1: ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ—á–∫—É –º—è—á–∞
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 2: ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è ‚Üí –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é

t=9.5-14s: –ú—è—á –∞–∫—Ç–∏–≤–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è (–∫–∞–∂–¥—ã–µ 0.5s –Ω–æ–≤–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è)
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 1: ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—á–∫–∏
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 2: ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏ –¥–æ–ø–æ–ª–Ω—è–µ—Ç

t=14-19s:  –ú—è—á –ø–æ—Ç–µ—Ä—è–Ω –Ω–∞ 5 —Å–µ–∫
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 1: ‚ùå –ù–µ—á–µ–≥–æ –¥–æ–±–∞–≤–ª—è—Ç—å (–Ω–µ—Ç –¥–µ—Ç–µ–∫—Ü–∏–π)
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 2: ‚úÖ –ó–∞–ø–æ–ª–Ω—è–µ—Ç player COM –∫–∞–∂–¥—ã–µ 0.5s!

t=19.2s:   –ú—è—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 1: ‚úÖ –í–∏–¥–∏—Ç —Ä–∞–∑—Ä—ã–≤ 5 —Å–µ–∫ ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç retroactively
           ‚îî‚îÄ —Å–∏—Å—Ç–µ–º–∞ 2: ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

t=19.2-60s: –ú—è—á –∞–∫—Ç–∏–≤–Ω—ã–π ‚Üí –æ–±–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ç–∞–Ω–¥–µ–º–µ
```

---

## üé¨ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –≤ –ª–æ–≥–∞—Ö

```
üìç CAMERA_TRAJ: Loaded 1 points (ball + player fills)
   ‚îî‚îÄ –ó–∞–ø–æ–ª–Ω–µ–Ω–∞ –∏–∑ –º—è—á–∞ –ò–õ–ò player COM

üìç CAMERA_TRAJ: Interpolated 30 points across gaps
   ‚îî‚îÄ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –¥–ª—è smooth 30fps

üìä TRAJECTORY BEFORE INTERPOLATION: 6 points
   ‚îú‚îÄ üî¥ BALL: —Ç–æ—á–∫–∏ –∏–∑ –¥–µ—Ç–µ–∫—Ü–∏–∏ –º—è—á–∞
   ‚îú‚îÄ üîµ PLAYER_COM: —Ç–æ—á–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è player COM
   ‚îú‚îÄ üü° BLEND: –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ —Ç–æ—á–∫–∏ (50/50 mix)
   ‚îî‚îÄ ‚ö™ INTERP: –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ (–ø–æ—Å–ª–µ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏)

üìπ CAMERA_TRAJ: 245 points, sources={'ball': 12, 'player': 45, 'blend': 8, 'interpolated': 180}
   ‚îî‚îÄ –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
```

---

## üîë –ö–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é

**–†–∞–Ω—å—à–µ:**
- populate_camera_trajectory_from_ball_history() –≤—ã–∑—ã–≤–∞–ª–∞—Å—å –¢–û–õ–¨–ö–û –≤ add_detection()
- –ï—Å–ª–∏ –º—è—á–∞ –Ω–µ—Ç ‚Üí add_detection() –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚Üí —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è

**–¢–µ–ø–µ—Ä—å:**
- update_camera_trajectory_on_timer() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ù–ï–ó–ê–í–ò–°–ò–ú–û –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫
- –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ü–£–°–¢–û–ô ball_history (–∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ player COM)
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–º–µ—Ä–∞ –í–°–ï–ì–î–ê –∏–º–µ–µ—Ç —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞–ª–∏—á–∏—è –º—è—á–∞! ‚ú®
