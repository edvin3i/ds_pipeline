

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript"
  data-document-language="true" charset="UTF-8" data-domain-script="3e2b62ff-7ae7-4ac5-87c8-d5949ecafff5">
</script>
<script type="text/javascript">
  function OptanonWrapper() {
    var event = new Event('bannerLoaded');
    window.dispatchEvent(event);
  }
</script>
<script src="https://images.nvidia.com/aem-dam/Solutions/ot-js/ot-custom.js" type="text/javascript">
</script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DeepStream-3D Custom Apps and Libs Tutorials &#8212; DeepStream documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css%3Fdigest=dfe6caa3a7d634c4db9b.css" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css%3Fdigest=dfe6caa3a7d634c4db9b.css" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css%3Fdigest=dfe6caa3a7d634c4db9b.css" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css%3Fdigest=dfe6caa3a7d634c4db9b.css" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=a746c00c.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css%3Fv=eb367b29.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css%3Fv=7abaf8bc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css%3Fv=95c83b7e.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js%3Fdigest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js%3Fdigest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js%3Fdigest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js%3Fv=22d9b4cb"></script>
    <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
    <script src="../_static/design-tabs.js%3Fv=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'text/DS_3D_Custom_Manual';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '../versions1.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '7.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <script src="../_static/version-patch.js%3Fv=c24f8c5d"></script>
    <link rel="icon" href="../_static/Nvidia.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Performance" href="DS_Performance.html" />
    <link rel="prev" title="TAO Toolkit Integration with DeepStream" href="DS_TAO_integration.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Sep 15, 2025"/>

    <script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js" ></script>
    


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="DS_3D_Custom_Manual.html#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="DeepStream documentation - Home"/>
    <script>document.write(`<img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark" alt="DeepStream documentation - Home"/>`);</script>
  
  
    <p class="title logo__title">DeepStream documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="DeepStream documentation - Home"/>
    <script>document.write(`<img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark" alt="DeepStream documentation - Home"/>`);</script>
  
  
    <p class="title logo__title">DeepStream documentation</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">


<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Overview.html">Welcome to the DeepStream Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_docker_containers.html">Docker Containers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Samples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_C_Sample_Apps.html">C/C++ Sample Apps Source Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Python_Sample_Apps.html">Python Sample Apps and Bindings Source Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_ref_app_deepstream.html">DeepStream Reference Application - deepstream-app</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_ref_app_test5.html">DeepStream Reference Application - deepstream-test5 app</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_ref_app_nmos.html">DeepStream Reference Application - deepstream-nmos app</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_ref_app_github.html">DeepStream Reference Application on GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_sample_configs_streams.html">Sample Configurations and Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_sample_custom_gstream.html">Implementing a Custom GStreamer Plugin with OpenCV Integration Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TAO toolkit Integration with DeepStream</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_TAO_integration.html">TAO Toolkit Integration with DeepStream</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and How-to's</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="DS_3D_Custom_Manual.html#">DeepStream-3D Custom Apps and Libs Tutorials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Performance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Performance.html">Performance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Accuracy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Accuracy.html">Accuracy Tuning Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Custom Model</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_using_custom_model.html">Using a Custom Model with DeepStream</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Key Features</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_3D_MultiModal_Lidar_Sensor_Fusion.html">DeepStream-3D Sensor Fusion Multi-Modal Application and Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_3D_MultiModal_Lidar_Camera_BEVFusion.html">DeepStream-3D Multi-Modal BEVFusion Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_3D_MultiModal_Lidar_Camera_V2XFusion.html">DeepStream-3D Multi-Modal V2XFusion Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Smart_video.html">Smart Video Record</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_IoT.html">IoT</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_on_the_fly_model.html">On the Fly Model Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_NTP_Timestamp.html">NTP Timestamp in DeepStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_AVSync.html">AV Sync in DeepStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_RestServer.html">DeepStream With REST API Sever</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_3D_Action.html">DeepStream 3D Action Recognition App</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_3D_Depth_Camera.html">DeepStream 3D Depth Camera App</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_3D_Lidar_Inference.html">DeepStream 3D Lidar Inference App</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_library_nvdsnmos.html">Networked Media Open Specifications (NMOS) in DeepStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_postprocessing_plugin.html">Gst-nvdspostprocess in DeepStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_Can_Orientation.html">DeepStream Can Orientation App</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Application Migration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Application_migration.html">Application Migration to DeepStream 7.1 from DeepStream 7.0</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Plugin Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="DS_plugin_Intro.html">GStreamer Plugin Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_metadata.html">MetaData in the DeepStream SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdspreprocess.html">Gst-nvdspreprocess (Alpha)</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvinfer.html">Gst-nvinfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvinferserver.html">Gst-nvinferserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvtracker.html">Gst-nvtracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvstreammux.html">Gst-nvstreammux</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvstreammux2.html">Gst-nvstreammux New</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvstreamdemux.html">Gst-nvstreamdemux</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvmultistreamtiler.html">Gst-nvmultistreamtiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsosd.html">Gst-nvdsosd</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsmetautils.html">Gst-nvdsmetautils</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsvideotemplate.html">Gst-nvdsvideotemplate</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsaudiotemplate.html">Gst-nvdsaudiotemplate</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvvideoconvert.html">Gst-nvvideoconvert</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdewarper.html">Gst-nvdewarper</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvof.html">Gst-nvof</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvofvisual.html">Gst-nvofvisual</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvsegvisual.html">Gst-nvsegvisual</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvvideo4linux2.html">Gst-nvvideo4linux2</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvjpegdec.html">Gst-nvjpegdec</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvimagedec.html">Gst-nvimagedec</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvjpegenc.html">Gst-nvjpegenc</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvimageenc.html">Gst-nvimageenc</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvmsgconv.html">Gst-nvmsgconv</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvmsgbroker.html">Gst-nvmsgbroker</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsanalytics.html">Gst-nvdsanalytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsudpsrc.html">Gst-nvdsudpsrc</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsudpsink.html">Gst-nvdsudpsink</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdspostprocess.html">Gst-nvdspostprocess (Alpha)</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvds3dfilter.html">Gst-nvds3dfilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvds3dbridge.html">Gst-nvds3dbridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvds3dmixer.html">Gst-nvds3dmixer</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsucx.html">Gst-NvDsUcx</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvdsxfer.html">Gst-nvdsxfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvvideotestsrc.html">Gst-nvvideotestsrc</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvmultiurisrcbin.html">Gst-nvmultiurisrcbin</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_plugin_gst-nvurisrcbin.html">Gst-nvurisrcbin</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Troubleshooting and FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_FAQ.html">Frequently Asked Questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream On WSL2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_on_WSL2.html">DeepStream On WSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_WSL2_FAQ.html">FAQ for Deepstream On WSL</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream API Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_API_Guide.html">DeepStream API Guides</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Service Maker</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_service_maker_intro.html">What is Deepstream Service Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="DS_service_maker_cpp.html">Service Maker for C/C++ Developers</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="DS_service_maker_python.html">Service Maker for Python Developers(alpha)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="DS_service_maker_python_quick_start.html">Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_service_maker_python_into_to_flow_api.html">Introduction to Flow APIs</a></li>

<li class="toctree-l2"><a class="reference internal" href="DS_service_maker_python_into_to_pipeline_api.html">Introduction to Pipeline APIs</a></li>

<li class="toctree-l2"><a class="reference internal" href="DS_service_maker_python_advanced_features.html">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="DS_service_maker_traditional_app_migration.html">Migrating Traditional Deepstream Apps to Service Maker Apps in Python</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="DS_service_maker_plugin.html">What is a Deepstream Service Maker Plugin</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deepstream Libraries</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Libraries.html">DeepStream Libraries (Developer Preview)</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Graph Composer</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_intro.html">Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Platforms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Platforms.html">Supported platforms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Getting_Started.html">Application Development Workflow</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_GraphComposer_Create_Graph.html">Creating an AI Application</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Zero_Coding_Sample_Graphs.html">Reference graphs</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Dev_Workflow.html">Extension Development Workflow</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Zero_Coding_Developing_Extension.html">Developing Extensions for DeepStream</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Zero_Coding_DS_Components.html">DeepStream Components</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GXF Internals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_Internals.html">GXF Internals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Graph eXecution Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Graph_Runtime.html">Graph Execution Engine</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Graph Composer Containers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Containers.html">Graph Composer and GXF Containers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GXF Component Interfaces</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_Component_Interfaces.html">GXF Component Interfaces</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GXF Application API's</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_App_C++_APIs.html">GXF App C++ APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_App_Python_APIs.html">GXF App Python APIs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GXF Runtime API's</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_Core_C++_APIs.html">GXF Core C++ APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_Core_C_APIs.html">GXF Core C APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GXF_Core_Python_APIs.html">GXF Core Python APIs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extension Manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="Extensionmanual_toc.html">Extensions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/CudaExtension.html">CudaExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/StreamSync.html">GXF Stream Sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/StandardExtension.html">StandardExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/Python_Codelet.html">Python Codelets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/NetworkExtension.html">NetworkExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/NvTritonExt.html">NvTritonExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/SerializationExtension.html">SerializationExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/MultimediaExtension.html">MultimediaExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/VideoEncoderExtension.html">VideoEncoderExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/VideoDecoderExtension.html">VideoDecoderExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/Behavior_Tree.html">Behavior Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/UcxExtension.html">UCX Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/HttpExtension.html">HttpExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/GrpcExtension.html">GrpcExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graphtools-docs/docs/text/ExtensionsManual/TensorrtExtension.html">TensorRTExtension</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDs3dProcessingExt.html">NvDs3dProcessingExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsActionRecognitionExt.html">NvDsActionRecognitionExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsAnalyticsExt.html">NvDsAnalyticsExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsBaseExt.html">NvDsBaseExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsCloudMsgExt.html">NvDsCloudMsgExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsConverterExt.html">NvDsConverterExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsDewarperExt.html">NvDsDewarperExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsInferenceExt.html">NvDsInferenceExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsInferenceUtilsExt.html">NvDsInferenceUtilsExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsInterfaceExt.html">NvDsInterfaceExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsMuxDemuxExt.html">NvDsMuxDemuxExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsOpticalFlowExt.html">NvDsOpticalFlowExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsOutputSinkExt.html">NvDsOutputSinkExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsSampleExt.html">NvDsSampleExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsSampleModelsExt.html">NvDsSampleModelsExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsSourceExt.html">NvDsSourceExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsTemplateExt.html">NvDsTemplateExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsTrackerExt.html">NvDsTrackerExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsTranscodeExt.html">NvDsTranscodeExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsTritonExt.html">NvDsTritonExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsUcxExt.html">NvDsUcxExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsUdpExt.html">NvDsUdpExt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExtensionsManual/NvDsVisualizationExt.html">NvDsVisualizationExt</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Registry.html">Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Registry_CLI.html">Registry Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Composer.html">Composer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_Container_Builder.html">Container Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_gxf_CLI.html">GXF Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pipetuner-guide.html">Pipetuner Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../graphtools-docs/docs/text/GraphComposer_FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Legal Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DS_Legal.html">DeepStream End User License Agreement</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DeepStream Feedback</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DeepStream_Main_Feedback_Form.html">Feedback form</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">


<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
  </div>
  
  <div id="rtd-footer-container"></div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DeepStream-3...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="deepstream-3d-custom-apps-and-libs-tutorials">
<h1>DeepStream-3D Custom Apps and Libs Tutorials<a class="headerlink" href="DS_3D_Custom_Manual.html#deepstream-3d-custom-apps-and-libs-tutorials" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">ds3d</span></code> framework, interfaces and custom-libs are designed for DeepStream-3D processing. <code class="docutils literal notranslate"><span class="pre">ds3d</span></code> is agnostic from Gstreamer/Glib frameworks. These interfaces are capble of different types of data fusion. Developers can implement different types of custom libraries for <code class="docutils literal notranslate"><span class="pre">dataloader</span></code>, <code class="docutils literal notranslate"><span class="pre">datafilter</span></code> and <code class="docutils literal notranslate"><span class="pre">datarender</span></code>. The interface has ABI compatible layers and modern C++ interface. Developers only need to focus on the modern C++ interface for application or custom lib development.</p>
<p>DS3D <code class="docutils literal notranslate"><span class="pre">dataloader</span></code> is loaded by <code class="docutils literal notranslate"><span class="pre">GstAppSrc</span></code>, enabling its utilization for depth cameras like stereo cameras and Time-of-Flight cameras to capture image/depth data or load data from the file system. Additionally, it can be employed for capturing lidar data from sensors or lidar data files.
<code class="docutils literal notranslate"><span class="pre">datafilter</span></code> is loaded by the <code class="docutils literal notranslate"><span class="pre">nvds3dfilter</span></code> <cite>Gst-plugin</cite>. It could be used for 2D depth data processing , 3D point-cloud data extraction from depth,  other 2D-depth or 3D-points data filters and lidar or 3D data inference.
<code class="docutils literal notranslate"><span class="pre">datarender</span></code> is loaded by <code class="docutils literal notranslate"><span class="pre">GstAppSink</span></code>. It could be used for 2D depth rendering and 3D point-cloud and lidar data rendering. It also could be used for file dump.</p>
<section id="ds3d-application-examples">
<h2>DS3D Application Examples<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-application-examples" title="Link to this heading">#</a></h2>
<ul>
<li><p><a class="reference internal" href="DS_3D_MultiModal_Lidar_Sensor_Fusion.html"><span class="doc">DeepStream-3D Multi-Modal Lidar and Camera Sensor Fusion App</span></a> sample application showcases a multi-modal sensor fusion pipeline for LiDAR and camera data using the DS3D framework. There are 2 examples of multi-modal sensor fusion pipelines inside the samples. The sample app is located at <code class="docutils literal notranslate"><span class="pre">/opt/nvidia/deepstream/deepstream/sources/apps/sample_apps/deepstream-3d-lidar-sensor-fusion</span></code>.</p>
<blockquote>
<div><ul>
<li><p>Refer to <a class="reference internal" href="DS_3D_MultiModal_Lidar_Sensor_Fusion.html"><span class="doc">DeepStream 3D Multi-Modal Lidar and Camera Sensor Fusion App</span></a> to see more details of <code class="docutils literal notranslate"><span class="pre">deepstream-3d-lidar-sensor-fusion</span></code></p></li>
<li><p>DS3D BEVFusion pipeline shows the overview of 6-camera plus 1-LiDAR data fusion inference and rendering pipeline through <code class="docutils literal notranslate"><span class="pre">deepstream-3d-lidar-sensor-fusion</span></code>.</p>
<img alt="DeepStream 3D Lidar BEVFusion pipeline overview" class="align-center" src="../_images/DS3D_lidar_sensor_fusion_bevfusion_pipeline.png" />
</li>
<li><p>DS3D V2XFusion pipeline shows the overview of 1-camera plus 1-LiDAR with batch 4 data input fusion inference and rendering pipeline through <code class="docutils literal notranslate"><span class="pre">deepstream-3d-lidar-sensor-fusion</span></code>.</p>
<img alt="DeepStream 3D Lidar V2XFusion pipeline overview" class="align-center" src="../_images/DS3D_lidar_sensor_fusion_v2xfusion_pipeline.png" />
</li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="DS_3D_Lidar_Inference.html"><span class="doc">deepstream-lidar-inference</span></a> has the sample code to load these custom libs and to connect these components together in simple ways. Besides that, DS3D has a simple C++ safe pointer for <cite>Gstreamer</cite> components. The interfaces are found in header files located at <code class="docutils literal notranslate"><span class="pre">/opt/nvidia/deepstream/deepstream/sources/libs/ds3d/gst/</span></code>.</p></li>
</ul>
<blockquote>
<div><p>The image below shows the overview of lidar 3D data inference and rendering pipeline in <code class="docutils literal notranslate"><span class="pre">deepstream-lidar-inference</span></code>.</p>
<blockquote>
<div><img alt="DeepStream Lidar point cloud inference and rendering overview" class="align-center" src="../_images/DS_3D_lidar_inference_pointcloud_render.png" />
</div></blockquote>
<p>See more details in the <a class="reference internal" href="DS_3D_Lidar_Inference.html"><span class="doc">DeepStream 3D Lidar Inference App</span></a>.</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="DS_3D_Depth_Camera.html"><span class="doc">deepstream-3d-depth-camera</span></a> is another example for ds3d pipeline.</p></li>
</ul>
<blockquote>
<div><p>The image below shows the overview of depth to 3D point processing pipeline in <code class="docutils literal notranslate"><span class="pre">deepstream-3d-depth-camera</span></code>.</p>
<blockquote>
<div><img alt="DeepStream Depth Camera for 3D point cloud processing overview" class="align-center" src="../_images/DS_3D_depth_camera_3d_points_process.png" />
</div></blockquote>
<p>See more details in the <a class="reference internal" href="DS_3D_Depth_Camera.html"><span class="doc">DeepStream 3D Depth Camera App</span></a>.</p>
</div></blockquote>
<p>All the components are configured in YAML format. They are loaded by <cite>Gst-plugins</cite>.There are 3 major components, they may all be loaded into the deepstream pipeline.</p>
</section>
<section id="ds3d-data-format-ds3d-datamap">
<span id="ds-3d-custom-manual-datamap"></span><h2>DS3D data format <code class="docutils literal notranslate"><span class="pre">ds3d/datamap</span></code><a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-data-format-ds3d-datamap" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ds3d/datamap</span></code> recognizes the data format used in DS3D framework. Data buffers flowing between GStreamer plugins will be of this data-type.
<code class="docutils literal notranslate"><span class="pre">ds3d/datamap</span></code> are key-value pairs where key is a string and value, a pointer, structure or tensor frame to data.
All of the operations on the buffer is managed by <code class="docutils literal notranslate"><span class="pre">GuardDataMap</span></code>.</p>
<p>Examples:</p>
<ul>
<li><p>Create GuardDataMap <code class="docutils literal notranslate"><span class="pre">datamap</span></code> and set scaler key-values.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/datamap.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ds3d</span><span class="p">;</span>

<span class="n">GuardDataMap</span><span class="w"> </span><span class="nf">datamap</span><span class="p">(</span><span class="n">NvDs3d_CreateDataHashMap</span><span class="p">(),</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// creat a empty datamap</span>
<span class="n">TimeStamp</span><span class="w"> </span><span class="n">ts</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;DS3D::Timestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ts</span><span class="p">);</span><span class="w"> </span><span class="c1">// set timestamp</span>

<span class="kt">float</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;DS3D::Score&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">);</span><span class="w"> </span><span class="c1">// copy score into datamap</span>
</pre></div>
</div>
</li>
<li><p>User-defined structure added into ds3d <code class="docutils literal notranslate"><span class="pre">datamap</span></code>.</p>
<blockquote>
<div><p>ds3d datamap requires each data type having a <code class="docutils literal notranslate"><span class="pre">typeid:</span> <span class="pre">uint64_t</span></code> before adding the data into datamap. This could prevent any wrong datatype casting in runtime. To achieve that, there are 2 ways to enable a typeid for a structure.</p>
<p>Example 1, use <code class="docutils literal notranslate"><span class="pre">REGISTER_TYPE_ID</span></code> directly in custom data structure definition. this is mostly used when users define a new structure.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#define DS3D_TYPEID_TIMESTAMP 0x20002</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">TimeStamp</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">t0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">REGISTER_TYPE_ID</span><span class="p">(</span><span class="n">DS3D_TYPEID_TIMESTAMP</span><span class="p">)</span>
<span class="p">};</span>

<span class="c1">// Add the shared_ptr into datamap</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">TimeStamp</span><span class="o">&gt;</span><span class="w"> </span><span class="n">timePtr</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TimeStamp</span><span class="p">);</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setPtrData</span><span class="p">(</span><span class="s">&quot;DS3D::Timestamp0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">timePtr</span><span class="p">);</span>

<span class="c1">// Add a copy of the TimeStamp into datamap</span>
<span class="n">TimeStamp</span><span class="w"> </span><span class="n">time1</span><span class="p">;</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;DS3D::Timestamp1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="p">);</span>
</pre></div>
</div>
<p>Example 2, Instantiate template <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">TpId&lt;&gt;</span> <span class="pre">{</span> <span class="pre">static</span> <span class="pre">constexpr</span> <span class="pre">TIdType</span> <span class="pre">__typeid();</span> <span class="pre">}</span></code>, this is helpful when adding a 3rdparty data structure into datamap and not able to modify the 3rd-party existing DataStructure.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// this is the 3rd-party structure</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Existing3rdpartData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">v0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// derive ds3d::__TypeID for any 3rdparty data structure.</span>
<span class="cp">#incude &quot;ds3d/common/type_trait.h&quot;</span>
<span class="cp">#define DS3D_TYPEID_EXISTING_3RDPART_DATA 0x80001</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">ds3d</span><span class="w"> </span><span class="p">{</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;&gt;</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">TpId</span><span class="o">&lt;</span><span class="n">Existing3rdpartData</span><span class="o">&gt;:</span><span class="w"> </span><span class="n">__TypeID</span><span class="o">&lt;</span><span class="n">DS3D_TYPEID_EXISTING_3RDPART_DATA</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{};</span>
<span class="p">}</span>

<span class="c1">// Add the shared_ptr into datamap</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Existing3rdpartData</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dataPtr</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Existing3rdpartData</span><span class="p">);</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setPtrData</span><span class="p">(</span><span class="s">&quot;3rdpartyData0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dataPtr</span><span class="p">);</span>

<span class="c1">// Add a copy of the Existing3rdpartData into datamap</span>
<span class="n">Existing3rdpartData</span><span class="w"> </span><span class="n">data3rdparty</span><span class="p">{</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;3rdpartyData1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data3rdparty</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create LiDAR tensor frame and add into GuardDataMap <code class="docutils literal notranslate"><span class="pre">datamap</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vec4f</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lidardata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">{{</span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6f</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85f</span><span class="p">}},</span>
<span class="w">    </span><span class="p">{{</span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82f</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-5.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8f</span><span class="p">}},</span>
<span class="p">};</span>
<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pointPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">lidardata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">pointsN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lidardata</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="n">FrameGuard</span><span class="w"> </span><span class="n">lidarFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrapLidarXYZIFrame</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="n">pointPtr</span><span class="p">,</span><span class="w"> </span><span class="n">pointsN</span><span class="p">,</span><span class="w"> </span><span class="n">MemType</span><span class="o">::</span><span class="n">kCpu</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="p">[</span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">lidardata</span><span class="p">)](</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span><span class="w"> </span><span class="c1">// lambda deleter</span>

<span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">keyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::LidarXYZI&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// user define a key name.</span>
<span class="c1">// setGuardData holds a reference_count on the lidarFrame without deep-copy</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setGuardData</span><span class="p">(</span><span class="n">keyName</span><span class="p">,</span><span class="w"> </span><span class="n">lidarFrame</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Create 2D-Image tensor frame and add into GuardDataMap <code class="docutils literal notranslate"><span class="pre">datamap</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vec4b</span><span class="o">&gt;</span><span class="w"> </span><span class="n">imagedata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">{{</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span>
<span class="w">    </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">}},</span>
<span class="p">};</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="n">Frame2DPlane</span><span class="w"> </span><span class="n">colorPlane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vec4b</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">vec4b</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">colorPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">imagedata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colorPlane</span><span class="p">.</span><span class="n">pitchInBytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">colorPlane</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>

<span class="n">Frame2DGuard</span><span class="w"> </span><span class="n">imageFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">impl</span><span class="o">::</span><span class="n">Wrap2DFrame</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">,</span><span class="w"> </span><span class="n">FrameType</span><span class="o">::</span><span class="n">kColorRGBA</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="n">colorPtr</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">colorPlane</span><span class="p">},</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">MemType</span><span class="o">::</span><span class="n">kCpu</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="p">[</span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">imagedata</span><span class="p">)](</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span><span class="w"> </span><span class="c1">// lambda deleter</span>

<span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">keyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::ColorFrame&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// user define a key name.</span>
<span class="c1">// setGuardData holds a reference_count on the imageFrame without deep-copy</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setGuardData</span><span class="p">(</span><span class="n">keyName</span><span class="p">,</span><span class="w"> </span><span class="n">imageFrame</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Create custom shaped tensor frame and add into GuardDataMap <code class="docutils literal notranslate"><span class="pre">datamap</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tensordata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mf">11.0f</span>
<span class="p">};</span>
<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">tensorPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">tensordata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">Shape</span><span class="w"> </span><span class="n">tensorShape</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">}};</span><span class="w"> </span><span class="c1">// tensor shape (1, 3, 4)</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensordata</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">tensordata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">FrameGuard</span><span class="w"> </span><span class="n">tensorFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">impl</span><span class="o">::</span><span class="n">WrapFrame</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="n">FrameType</span><span class="o">::</span><span class="n">kCustom</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="n">tensorPtr</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">tensorShape</span><span class="p">,</span><span class="w"> </span><span class="n">MemType</span><span class="o">::</span><span class="n">kCpu</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">imagedata</span><span class="p">)](</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span><span class="w"> </span><span class="c1">// lambda deleter</span>

<span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">keyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::dataarray&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// user define a key name.</span>
<span class="c1">// setGuardData holds a reference_count on the tensorFrame without deep-copy</span>
<span class="n">datamap</span><span class="p">.</span><span class="n">setGuardData</span><span class="p">(</span><span class="n">keyName</span><span class="p">,</span><span class="w"> </span><span class="n">tensorFrame</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Query data values from GuardDataMap <code class="docutils literal notranslate"><span class="pre">datamap</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">GuardDataMap::getGuardData</span></code>, return a safe reference counted guard data GuardDataT&lt;DataStructure&gt; e.g. Frame2DGuard, FrameGuard, GuardDataT&lt;TimeStamp&gt;
<code class="docutils literal notranslate"><span class="pre">GuardDataMap::getPtrData</span></code>, return a reference counted std::shared_ptr&lt;DataStructure&gt; e.g. std::shared_ptr&lt;TimeStamp&gt;
<code class="docutils literal notranslate"><span class="pre">GuardDataMap::getData</span></code>, return a copy of the DataStructure. e.g. TimeStamp</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// example to use different ways to get timestamp.</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">timeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::Timestamp&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">hasData</span><span class="p">(</span><span class="n">timeKey</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// get a COPY of Timestamp</span>
<span class="w">    </span><span class="n">TimeStamp</span><span class="w"> </span><span class="n">t0</span><span class="p">;</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">getData</span><span class="p">(</span><span class="n">timeKey</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// get a std::shared_ptr of Timestamp</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">TimeStamp</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tPtr</span><span class="p">;</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">getPtrData</span><span class="p">(</span><span class="n">timeKey</span><span class="p">,</span><span class="w"> </span><span class="n">tPtr</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// get a reference-counted GuardDataT&lt;Timestamp&gt;</span>
<span class="w">    </span><span class="n">GuardDataT</span><span class="o">&lt;</span><span class="n">TimeStamp</span><span class="o">&gt;</span><span class="w"> </span><span class="n">timeGuard</span><span class="p">;</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">getPtrData</span><span class="p">(</span><span class="n">timeKey</span><span class="p">,</span><span class="w"> </span><span class="n">timeGuard</span><span class="p">));</span>

<span class="c1">// example to get a lidar tensor frame</span>
<span class="n">FrameGuard</span><span class="w"> </span><span class="n">pointFrame</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">lidarKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::LidarXYZI&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">hasData</span><span class="p">(</span><span class="n">lidarKey</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// get lidar tensor frame</span>
<span class="w">    </span><span class="c1">// pointFrame holds a reference count</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="n">lidarKey</span><span class="p">,</span><span class="w"> </span><span class="n">pointFrame</span><span class="p">)));</span>
<span class="w">    </span><span class="n">DataType</span><span class="w"> </span><span class="n">dType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">();</span>
<span class="w">    </span><span class="n">FrameType</span><span class="w"> </span><span class="n">frameType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">frameType</span><span class="p">();</span>
<span class="w">    </span><span class="n">MemType</span><span class="w"> </span><span class="n">memType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">memType</span><span class="p">();</span>
<span class="w">    </span><span class="n">Shape</span><span class="w"> </span><span class="n">pShape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">shape</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dataPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">();</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dataBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointFrame</span><span class="o">-&gt;</span><span class="n">bytes</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// example to get a RGBA image tensor frame</span>
<span class="n">Frame2DGuard</span><span class="w"> </span><span class="n">rgbaImage</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">imageKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::ColorFrame&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">hasData</span><span class="p">(</span><span class="n">imageKey</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// get 2D image tensor frame</span>
<span class="w">    </span><span class="c1">// rgbaImage holds a reference count</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="n">imageKey</span><span class="p">,</span><span class="w"> </span><span class="n">rgbaImage</span><span class="p">)));</span>
<span class="w">    </span><span class="n">DataType</span><span class="w"> </span><span class="n">dType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">();</span>
<span class="w">    </span><span class="n">FrameType</span><span class="w"> </span><span class="n">frameType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">frameType</span><span class="p">();</span>
<span class="w">    </span><span class="n">MemType</span><span class="w"> </span><span class="n">memType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">memType</span><span class="p">();</span>
<span class="w">    </span><span class="n">Shape</span><span class="w"> </span><span class="n">pShape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">shape</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dataPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">();</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dataBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">bytes</span><span class="p">();</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">planes</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// RGBA image has 1 plane.</span>
<span class="w">    </span><span class="n">Frame2DPlane</span><span class="w"> </span><span class="n">plane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgbaImage</span><span class="o">-&gt;</span><span class="n">getPlane</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// example to get a custom shaped tensor frame, e.g. data_array</span>
<span class="n">FrameGuard</span><span class="w"> </span><span class="n">tensorFrame</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">tensorKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DS3D::dataarray&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">datamap</span><span class="p">.</span><span class="n">hasData</span><span class="p">(</span><span class="n">tensorKey</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// get any tensor frame</span>
<span class="w">    </span><span class="c1">// tensorFrame holds a reference count</span>
<span class="w">    </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">isGood</span><span class="p">(</span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="n">tensorKey</span><span class="p">,</span><span class="w"> </span><span class="n">tensorFrame</span><span class="p">)));</span>
<span class="w">    </span><span class="n">DataType</span><span class="w"> </span><span class="n">dType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">();</span>
<span class="w">    </span><span class="n">FrameType</span><span class="w"> </span><span class="n">frameType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">frameType</span><span class="p">();</span>
<span class="w">    </span><span class="n">MemType</span><span class="w"> </span><span class="n">memType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">memType</span><span class="p">();</span>
<span class="w">    </span><span class="n">Shape</span><span class="w"> </span><span class="n">pShape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">shape</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dataPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">();</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dataBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensorFrame</span><span class="o">-&gt;</span><span class="n">bytes</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<section id="ds3d-datamap-interoperate-with-gstbuffer">
<h3>DS3D DataMap interoperate with GstBuffer<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-datamap-interoperate-with-gstbuffer" title="Link to this heading">#</a></h3>
<p>DS3D DataMap has ABI-compatible class <code class="docutils literal notranslate"><span class="pre">ds3d::abiRefDataMap</span></code>. With that, <code class="docutils literal notranslate"><span class="pre">NvDs3DBuffer</span></code> is defined for storing DS3D datamap along with <cite>GstBuffer</cite>. Header file is <code class="docutils literal notranslate"><span class="pre">ds3d/gst/nvds3d_meta.h</span></code>.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>struct NvDs3DBuffer {
    uint32_t magicID;  // must be &#39;DS3D&#39;
    ds3d::abiRefDataMap* datamap;
};
</pre></div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use the <cite>datamap</cite> directly. The easy and safe way to access that is through <code class="docutils literal notranslate"><span class="pre">GuardDataMap</span></code>. see examples below</p>
</div>
<ul class="simple">
<li><p>Example to get datamap from <code class="docutils literal notranslate"><span class="pre">GstBuffer</span></code></p></li>
</ul>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/datamap.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/frame.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ds3d</span><span class="p">;</span>

<span class="n">GstBuffer</span><span class="w"> </span><span class="o">*</span><span class="n">gstBuf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// get the gstBuf from probe function or Gstreamer plugins</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NvDs3D_IsDs3DBuf</span><span class="p">(</span><span class="n">gstBuf</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">abiRefDataMap</span><span class="o">*</span><span class="w"> </span><span class="n">refDataMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">  </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NvDs3D_Find1stDataMap</span><span class="p">(</span><span class="n">gstBuf</span><span class="p">,</span><span class="w"> </span><span class="n">refDataMap</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refDataMap</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GuardDataMap</span><span class="w"> </span><span class="nf">dataMap</span><span class="p">(</span><span class="o">*</span><span class="n">refDataMap</span><span class="p">);</span>
<span class="w">    </span><span class="n">FrameGuard</span><span class="w"> </span><span class="n">lidarFrame</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="s">&quot;DS3D::LidarXYZI&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pointFrame</span><span class="p">);</span><span class="w"> </span><span class="c1">// get lidar points reference.</span>

<span class="w">    </span><span class="n">FrameGuard</span><span class="w"> </span><span class="n">uvCoord</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="s">&quot;DS3D::TextureCoordKey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">uvCoord</span><span class="p">);</span><span class="w"> </span><span class="c1">// get 3D points UV coordinates reference.</span>

<span class="w">    </span><span class="n">Frame2DGuard</span><span class="w"> </span><span class="n">depthFrame</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataMap</span><span class="p">.</span><span class="n">getGuardData</span><span class="p">(</span><span class="s">&quot;DS3D::DepthFrame&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">depthFrame</span><span class="p">);</span><span class="w"> </span><span class="c1">// get depth frame reference.</span>

<span class="w">    </span><span class="n">DepthScale</span><span class="w"> </span><span class="n">scale</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataMap</span><span class="p">.</span><span class="n">getData</span><span class="p">(</span><span class="s">&quot;DS3D::DepthScaleUnit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">);</span><span class="w"> </span><span class="c1">// copy depth scale</span>
<span class="w">  </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p>Example to createa a <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> into a new <code class="docutils literal notranslate"><span class="pre">GstBuffer</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/datamap.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/frame.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/impl/impl_frames.h&gt;</span>
<span class="n">GuardDataMap</span><span class="w"> </span><span class="nf">datamap</span><span class="p">(</span><span class="n">NvDs3d_CreateDataHashMap</span><span class="p">(),</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// set true to take the reference ownership.</span>

<span class="cm">/* Create color image frame and store them into ds3d datamap. */</span>
<span class="c1">// Assume format is RGBA</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">Frame2DPlane</span><span class="w"> </span><span class="n">colorPlane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1920</span><span class="p">,</span><span class="w"> </span><span class="mi">1080</span><span class="p">,</span><span class="w"> </span><span class="mi">1920</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">colorBytesPerFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colorPlane</span><span class="p">.</span><span class="n">pitchInBytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">colorPlane</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">colorBytesPerFrame</span><span class="p">);</span><span class="w"> </span><span class="c1">// Image data</span>
<span class="w">  </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">dataPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="c1">// create color 2D frame</span>
<span class="w">  </span><span class="n">Frame2DGuard</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wrap2DFrame</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">,</span><span class="w"> </span><span class="n">FrameType</span><span class="o">::</span><span class="n">kColorRGBA</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="n">dataPtr</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">_config</span><span class="p">.</span><span class="n">colorPlane</span><span class="p">},</span><span class="w"> </span><span class="n">bytesPerFrame</span><span class="p">,</span><span class="w"> </span><span class="n">MemType</span><span class="o">::</span><span class="n">kCpu</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">data</span><span class="p">)](</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span>
<span class="w">  </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datamap</span><span class="p">.</span><span class="n">setGuardData</span><span class="p">(</span><span class="n">kColorFrame</span><span class="p">,</span><span class="w"> </span><span class="n">colorFrame</span><span class="p">);</span><span class="w"> </span><span class="c1">// store colorFrame reference into datamap.</span>
<span class="w">  </span><span class="p">...</span><span class="w"> </span><span class="c1">// check error code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once <code class="docutils literal notranslate"><span class="pre">datamap</span></code> is ready, you can create a new GstBuffer with DS3D datamap.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ``GuardDataMap datamap`` is ready</span>
<span class="n">GstBuffer</span><span class="o">*</span><span class="w"> </span><span class="n">gstBuf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NvDs3D_CreateGstBuf</span><span class="p">(</span><span class="n">gstBuf</span><span class="p">,</span><span class="w"> </span><span class="n">datamap</span><span class="p">.</span><span class="n">abiRef</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w"> </span><span class="c1">// set false to increase reference count.</span>
<span class="p">...</span><span class="w"> </span><span class="c1">// check error code</span>
</pre></div>
</div>
</li>
<li><p>Example to update an existing <code class="docutils literal notranslate"><span class="pre">DS3D</span></code> <cite>GstBuffer</cite> with a new <code class="docutils literal notranslate"><span class="pre">ds3d</span></code> <cite>datamap</cite>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assume ``GuardDataMap datamap`` is ready</span>
<span class="c1">// Assume ``GstBuffer* gstBuf`` is created by another compoment</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NvDs3D_UpdateDataMap</span><span class="p">(</span><span class="n">gstBuf</span><span class="p">,</span><span class="w"> </span><span class="n">datamap</span><span class="p">.</span><span class="n">abiRef</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w"> </span><span class="c1">// set false to increase reference count.</span>
<span class="w">  </span><span class="p">...</span><span class="w"> </span><span class="c1">// check error code</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="ds3d-dataloader-load-custom-lib-for-data-capture">
<span id="ds-3d-custom-manual-dataloader"></span><h2><code class="docutils literal notranslate"><span class="pre">ds3d::dataloader</span></code> - Load Custom Lib for Data Capture<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-dataloader-load-custom-lib-for-data-capture" title="Link to this heading">#</a></h2>
<section id="load-and-manage-ds3d-dataloader">
<h3>Load and Manage DS3D Dataloader<a class="headerlink" href="DS_3D_Custom_Manual.html#load-and-manage-ds3d-dataloader" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: realsense_dataloader
type: ds3d::dataloader
out_caps: ds3d/datamap
custom_lib_path: libnvds_3d_dataloader_realsense.so
custom_create_function: createRealsenseDataloader
config_body:
  streams: [color, depth]
</pre></div>
</div>
<p>A custom <cite>dataloader</cite> must have <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">ds3d::dataloader</span></code>. It is created by explicit call of <code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateDataLoaderSrc(srcConfig,</span> <span class="pre">loaderSrc,</span> <span class="pre">start)</span></code> with the full compoment YAML content. During this call, the <code class="docutils literal notranslate"><span class="pre">custom_lib_path</span></code> is loaded and a specific data loader is created via <code class="docutils literal notranslate"><span class="pre">custom_create_function</span></code>. A <cite>GstAppsrc</cite> object is also created into <code class="docutils literal notranslate"><span class="pre">loaderSrc.gstElement</span></code>.</p>
<p><cite>GstAppsrc</cite> manages the <cite>ds3d::dataloader</cite> dataflows. This <code class="docutils literal notranslate"><span class="pre">ds3d::dataloader</span></code> component could be started automatically by <cite>gst-pipeline</cite> or manually by the application call.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GuardDataLoader</span><span class="w"> </span><span class="n">dataloader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loaderSrc</span><span class="p">.</span><span class="n">customProcessor</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataloader</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
</pre></div>
</div>
<p>To stop the <cite>dataloader</cite>, user can set <cite>GstAppsrc</cite> states to <code class="docutils literal notranslate"><span class="pre">GST_STATE_READY</span></code> or stop it manually.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GuardDataLoader</span><span class="w"> </span><span class="n">dataloader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loaderSrc</span><span class="p">.</span><span class="n">customProcessor</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataloader</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="ds3d-dataloader-in-deepstream-user-application">
<h3>DS3D Dataloader in DeepStream User Application<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-dataloader-in-deepstream-user-application" title="Link to this heading">#</a></h3>
<p>DS3D Custom Dataloaders are agnostic from Gstreamer/Glib Framework. But it could be working with Gstramer as well. The <code class="docutils literal notranslate"><span class="pre">ds3d::dataloader</span></code> could interactively work with GstAppSrc together. They could be created by <code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateDataLoaderSrc</span></code>.</p>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/config.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/gst/nvds3d_gst_plugin.h&gt;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">yamlStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">R</span><span class="s">&quot;</span><span class="dl">(</span>
<span class="s">  name: ds3d_lidar_file_source</span>
<span class="s">  type: ds3d::dataloader</span>
<span class="s">  out_caps: ds3d/datamap</span>
<span class="s">  custom_lib_path: libnvds_lidarfileread.so</span>
<span class="s">  custom_create_function: createLidarFileLoader</span>
<span class="s">  config_body:</span>
<span class="s">    data_config_file: lidar_data_list.yaml</span>
<span class="s">    points_num: 242180</span>
<span class="s">    mem_type: gpu # choose [cpu gpu]</span>
<span class="s">    gpu_id: 0</span>
<span class="s">    mem_pool_size: 6</span>
<span class="s">    element_size: 4</span>
<span class="s">    output_datamap_key: DS3D::LidarXYZI</span>
<span class="dl">)</span><span class="s">&quot;</span><span class="p">;</span>

<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="n">ComponentConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseComponentConfig</span><span class="p">(</span><span class="n">yamlStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;./config_lidar_loader.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ComponentType</span><span class="o">::</span><span class="n">kDataLoader</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">customLibPath</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;libnvds_lidarfileread.so&quot;</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">customCreateFunction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;createLidarFileLoader&quot;</span><span class="p">);</span>

<span class="n">gst</span><span class="o">::</span><span class="n">DataLoaderSrc</span><span class="w"> </span><span class="n">appLoader</span><span class="p">;</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NvDs3D_CreateDataLoaderSrc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">appLoader</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="c1">// get DS3D custom dataloader.</span>
<span class="n">GuardDataLoader</span><span class="w"> </span><span class="n">dataLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">appLoader</span><span class="p">.</span><span class="n">customProcessor</span><span class="p">;</span>
<span class="c1">// get GstAppSrc from this appLoader;</span>
<span class="n">GstElement</span><span class="o">*</span><span class="w"> </span><span class="n">appsrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">appLoader</span><span class="p">.</span><span class="n">gstElement</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>

<span class="c1">// gstreamer pipeline setup and running.</span>
<span class="c1">// during each read_data from GstAppSrc callback. it would simultaneously reading data from dataloader</span>
<span class="c1">// GuardDataMap datamap;</span>
<span class="c1">// dataloader.read_data(datamap);</span>

<span class="c1">// DS3D dataloader would stop qutomatically when Gstpipeline is stopped.</span>
<span class="c1">// But in the case if user want to stop it early or manually.</span>
<span class="c1">// Obtain DS3D custom dataloader and stop manually.</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataloader</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataloader</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">GuardDataLoader</span></code> provides safe access to <code class="docutils literal notranslate"><span class="pre">abiDataLoader</span></code>. Once its created, it will maintain the reference pointer to the <cite>dataloader</cite>.</p>
</section>
<section id="implement-a-ds3d-custom-dataloader">
<h3>Implement a DS3D Custom Dataloader<a class="headerlink" href="DS_3D_Custom_Manual.html#implement-a-ds3d-custom-dataloader" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/impl/impl_dataloader.h&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestTimeDataLoader</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ds3d</span><span class="o">::</span><span class="n">impl</span><span class="o">::</span><span class="n">SyncImplDataLoader</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TestTimeDataLoader</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">setOutputCaps</span><span class="p">(</span><span class="s">&quot;ds3d/datamap&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">readDataImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="o">&amp;</span><span class="w"> </span><span class="n">datamap</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">datamap</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="n">NvDs3d_CreateDataHashMap</span><span class="p">());</span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">iTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">TimeStamp</span><span class="w"> </span><span class="n">t</span><span class="p">{</span><span class="n">iTime</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">        </span><span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="n">emitError</span><span class="p">(</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;timstamp added&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">DS3D_EXTERN_C_BEGIN</span>
<span class="n">DS3D_EXPORT_API</span><span class="w"> </span><span class="n">abiRefDataLoader</span><span class="o">*</span>
<span class="n">createTestTimeDataloader</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">NewAbiRef</span><span class="o">&lt;</span><span class="n">abiDataLoader</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TestTimeDataLoader</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">DS3D_EXTERN_C_END</span>
</pre></div>
</div>
<p>A shown in the example above, Youll need to derive <cite>dataloader</cite> from the <code class="docutils literal notranslate"><span class="pre">ds3d::impl::SyncImplDataLoader</span></code> class, and implement interfaces for the following:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ErrCode</span><span class="w"> </span><span class="nf">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">readDataImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="o">&amp;</span><span class="w"> </span><span class="n">datamap</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="ds3d-databridge-loads-custom-lib-for-data-conversion-to-and-from-ds3d">
<h2><code class="docutils literal notranslate"><span class="pre">ds3d::databridge</span></code> - Loads Custom Lib for data conversion to and from DS3D.<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-databridge-loads-custom-lib-for-data-conversion-to-and-from-ds3d" title="Link to this heading">#</a></h2>
<p>This plugin and custom lib helps convert data type to and from <code class="docutils literal notranslate"><span class="pre">ds3d/datamap</span></code></p>
<p>More details: <a class="reference internal" href="DS_plugin_gst-nvds3dbridge.html#ds-plugin-3d-bridge"><span class="std std-ref">Gst-nvds3dbridge</span></a>.</p>
</section>
<section id="ds3d-datafilter-ds3d-custom-datafilter">
<span id="ds-3d-custom-manual-datafilter"></span><h2><code class="docutils literal notranslate"><span class="pre">ds3d::datafilter</span></code>-  DS3D Custom DataFilter<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-datafilter-ds3d-custom-datafilter" title="Link to this heading">#</a></h2>
<p>DS3D DataFilter is processing inputs from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> and producing outputs input new <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>. Users can implement custom datafilter lib for their own use case.</p>
<section id="create-and-manage-ds3d-datafilter-in-deepstream-app">
<h3>Create And Manage DS3D Datafilter in DeepStream App<a class="headerlink" href="DS_3D_Custom_Manual.html#create-and-manage-ds3d-datafilter-in-deepstream-app" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/config.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/gst/nvds3d_gst_ptr.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/gst/nvds3d_gst_plugin.h&gt;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">yamlStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">R</span><span class="s">&quot;</span><span class="dl">(</span>
<span class="s">  name: fusion_inference</span>
<span class="s">  type: ds3d::datafilter</span>
<span class="s">  in_caps: ds3d/datamap</span>
<span class="s">  out_caps: ds3d/datamap</span>
<span class="s">  custom_lib_path: libnvds_tritoninferfilter.so</span>
<span class="s">  custom_create_function: createLidarInferenceFilter</span>
<span class="s">  config_body:</span>
<span class="s">    mem_pool_size: 2</span>
<span class="s">    model_inputs:</span>
<span class="s">    config_file: model_config_files/config_triton_bev_fusion_infer_grpc.pbtxt</span>
<span class="s">    - name: input_image_0</span>
<span class="s">      datatype: UINT8</span>
<span class="s">      shape: [1, 900, 1600, 4]</span>
<span class="s">      from: DS3D::ColorFrame_0+1</span>
<span class="s">      is_2d_frame: true</span>
<span class="s">    - name: input_lidar</span>
<span class="s">      datatype: FP32</span>
<span class="s">      shape: [242180, 4]</span>
<span class="s">      from: DS3D::LidarXYZI+0</span>
<span class="dl">)</span><span class="s">&quot;</span><span class="p">;</span>

<span class="n">gst</span><span class="o">::</span><span class="n">ElePtr</span><span class="w"> </span><span class="n">gstPlugin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst</span><span class="o">::</span><span class="n">elementMake</span><span class="p">(</span><span class="s">&quot;nvds3dfilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ds3d-custom-filter&quot;</span><span class="p">);</span>
<span class="n">g_object_set</span><span class="p">(</span><span class="n">G_OBJECT</span><span class="p">(</span><span class="n">gstPlugin</span><span class="p">.</span><span class="n">get</span><span class="p">()),</span><span class="w"> </span><span class="s">&quot;config-content&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yamlStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<span class="n">GstElement</span><span class="o">*</span><span class="w"> </span><span class="n">ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gstPlugin</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</pre></div>
</div>
<p>A custom <cite>datafilter</cite> must have <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">ds3d::datafilter</span></code>. It is loaded through the <code class="docutils literal notranslate"><span class="pre">nvds3dfilter</span></code> <cite>Gst-plugin</cite>. It is started by <code class="docutils literal notranslate"><span class="pre">gst_element_set_state(GST_STATE_READY)</span></code>. During this call, the <code class="docutils literal notranslate"><span class="pre">custom_lib_path</span></code> is loaded and a specific data filter is created by <code class="docutils literal notranslate"><span class="pre">custom_create_function</span></code>. <code class="docutils literal notranslate"><span class="pre">nvds3dfilter</span></code> <cite>Gst-plugin</cite> has <code class="docutils literal notranslate"><span class="pre">config-content</span></code> and <code class="docutils literal notranslate"><span class="pre">config-file</span></code> properties. One of them must be set to create a <cite>datafilter</cite> object.</p>
</section>
<section id="implement-a-custom-ds3d-datafilter">
<h3>Implement a Custom DS3D Datafilter<a class="headerlink" href="DS_3D_Custom_Manual.html#implement-a-custom-ds3d-datafilter" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/impl/impl_datafilter.h&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestFakeDataFilter</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">impl</span><span class="o">::</span><span class="n">BaseImplDataFilter</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TestFakeDataFilter</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">setInputCaps</span><span class="p">(</span><span class="n">kFakeCapsMetaName</span><span class="p">);</span>
<span class="w">        </span><span class="n">setOutputCaps</span><span class="p">(</span><span class="n">kFakeCapsMetaName</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">processImpl</span><span class="p">(</span>
<span class="w">        </span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">,</span><span class="w"> </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">outputDataCb</span><span class="p">,</span>
<span class="w">        </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">inputConsumedCb</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">datamap</span><span class="p">);</span>
<span class="w">        </span><span class="n">TimeStamp</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">        </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datamap</span><span class="p">.</span><span class="n">getData</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isGood</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">t</span><span class="p">.</span><span class="n">t0</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">inputConsumedCb</span><span class="p">(</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">,</span><span class="w"> </span><span class="n">datamap</span><span class="p">);</span>
<span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datamap</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isGood</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">outputDataCb</span><span class="p">(</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">,</span><span class="w"> </span><span class="n">datamap</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">DS3D_EXTERN_C_BEGIN</span>
<span class="n">DS3D_EXPORT_API</span><span class="w"> </span><span class="n">abiRefdatafilter</span><span class="o">*</span>
<span class="n">createTestFakeDatafilter</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">NewAbiRef</span><span class="o">&lt;</span><span class="n">abidatafilter</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TestFakeDataFilter</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">DS3D_EXTERN_C_END</span>
</pre></div>
</div>
<p>As shown in the example above, youll need to derive the <cite>datafilter</cite> from the <code class="docutils literal notranslate"><span class="pre">ds3d::impl::BaseImplDataFilter</span></code> class, and implement interfaces for the following:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ErrCode</span><span class="w"> </span><span class="nf">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">processImpl</span><span class="p">(</span>
<span class="w">        </span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">,</span><span class="w"> </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">outputDataCb</span><span class="p">,</span>
<span class="w">        </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">inputConsumedCb</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</pre></div>
</div>
<p>To load this custom lib through <code class="docutils literal notranslate"><span class="pre">nvds3dfilter</span></code> <cite>Gst-plugin</cite>, youll also need to export a specific symbol <code class="docutils literal notranslate"><span class="pre">createTestFakeDatafilter</span></code>.</p>
</section>
</section>
<section id="ds3d-datarender-loads-ds3d-custom-datarender">
<span id="ds-3d-custom-manual-datarender"></span><h2><code class="docutils literal notranslate"><span class="pre">ds3d::datarender</span></code> - Loads DS3D Custom DataRender<a class="headerlink" href="DS_3D_Custom_Manual.html#ds3d-datarender-loads-ds3d-custom-datarender" title="Link to this heading">#</a></h2>
<p>DS3D Custom DataRenders are agnostic from Gstreamer/Glib Framework. But it could be working with Gstramer as well. The <code class="docutils literal notranslate"><span class="pre">ds3d::datarender</span></code> could interactively work with GstAppSink together. They could be created by <code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateDataRenderSink</span></code>.</p>
<p>Examples:</p>
<section id="load-and-manage-ds3d-datarender">
<h3>Load And Manage DS3D Datarender<a class="headerlink" href="DS_3D_Custom_Manual.html#load-and-manage-ds3d-datarender" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/config.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/gst/nvds3d_gst_plugin.h&gt;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">yamlStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">R</span><span class="s">&quot;</span><span class="dl">(</span>
<span class="s">            name: lidar_render</span>
<span class="s">            type: ds3d::datarender</span>
<span class="s">            in_caps: ds3d/datamap</span>
<span class="s">            custom_lib_path: libnvds_3d_gl_datarender.so</span>
<span class="s">            custom_create_function: createLidarDataRender</span>
<span class="s">            gst_properties:</span>
<span class="s">              sync: True</span>
<span class="s">              async: False</span>
<span class="s">              drop: False</span>
<span class="s">            config_body:</span>
<span class="s">              title: ds3d-lidar-render</span>
<span class="s">              streams: [lidardata]</span>
<span class="s">              width: 1280</span>
<span class="s">              height: 720</span>
<span class="s">              block: True</span>
<span class="s">              view_position: [0, 0, 60]</span>
<span class="s">              view_target: [0, 0, 0]</span>
<span class="s">              view_up: [0, 1, 0]</span>
<span class="s">              near: 0.3</span>
<span class="s">              far: 100</span>
<span class="s">              fov: 50</span>
<span class="s">              lidar_color: [0, 255, 0]</span>
<span class="s">              lidar_data_key: DS3D::LidarXYZI</span>
<span class="s">              element_size: 4</span>
<span class="s">              lidar_bbox_key: DS3D::Lidar3DBboxRawData</span>
<span class="s">              enable_label: True</span>
<span class="dl">)</span><span class="s">&quot;</span><span class="p">;</span>

<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="n">ComponentConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseComponentConfig</span><span class="p">(</span><span class="n">yamlStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;./config_lidar_loader.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ComponentType</span><span class="o">::</span><span class="n">kDataRender</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">customLibPath</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;libnvds_3d_gl_datarender.so&quot;</span><span class="p">);</span>
<span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">customCreateFunction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;createLidarDataRender&quot;</span><span class="p">);</span>

<span class="n">gst</span><span class="o">::</span><span class="n">DataRenderSink</span><span class="w"> </span><span class="n">appRender</span><span class="p">;</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NvDs3D_CreateDataRenderSink</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">appRender</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="c1">// get DS3D custom datarender.</span>
<span class="n">GuardDataRender</span><span class="w"> </span><span class="n">datarender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">appRender</span><span class="p">.</span><span class="n">customProcessor</span><span class="p">;</span>
<span class="c1">// get GstAppSink from this appRender;</span>
<span class="n">GstElement</span><span class="o">*</span><span class="w"> </span><span class="n">appsink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">appRender</span><span class="p">.</span><span class="n">gstElement</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>

<span class="c1">// gstreamer pipeline setup and running.</span>
<span class="c1">// during each render_data from GstAppSink callback. it would simultaneously reading data from datarender</span>
<span class="c1">// datarender.render(datamap, consumed_callback);</span>

<span class="c1">// DS3D datarender would stop qutomatically when Gstpipeline is stopped.</span>
<span class="c1">// But in the case if user want to stop it early or manually.</span>
<span class="c1">// Obtain DS3D custom datarender and stop manually.</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datarender</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
</pre></div>
</div>
<p>A custom <cite>datarender</cite> must have <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">ds3d::datarender</span></code>. It is created by explicit call of <code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateDataRenderSink(sinkConfig,</span> <span class="pre">renderSink,</span> <span class="pre">start)</span></code> with the full compoment YAML content. During this call, the <code class="docutils literal notranslate"><span class="pre">custom_lib_path</span></code> is loaded and a specific data loader is created via <code class="docutils literal notranslate"><span class="pre">custom_create_function</span></code>. A <cite>GstAppsink</cite> object is also created into <code class="docutils literal notranslate"><span class="pre">renderSink.gstElement</span></code>.</p>
<p><cite>GstAppsink</cite> manages the <cite>ds3d::datarender</cite> dataflows. This <cite>ds3d::datarender</cite> component could be  automatically started by the <cite>gst-pipeline</cite>, or manually by the application call.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GuardDataRender</span><span class="w"> </span><span class="n">datarender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">renderSink</span><span class="p">.</span><span class="n">customProcessor</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datarender</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
<p>To stop the <cite>datarender</cite>, you can set <cite>GstAppsink</cite> states to <code class="docutils literal notranslate"><span class="pre">GST_STATE_READY</span></code>, or stop manually.
.. code-block:: text</p>
<blockquote>
<div><p>GuardDataRender datarender = renderSink.customProcessor;
ErrCode c = datarender.stop();</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">GuardDataRender</span></code> provides safe access to <code class="docutils literal notranslate"><span class="pre">abidatarender</span></code>. Once its created, it will maintain the reference pointer to datarender. <code class="docutils literal notranslate"><span class="pre">preroll</span></code> is called only once to initialize some resources.</p>
</section>
<section id="implement-a-ds3d-custom-datarender">
<h3>Implement a DS3D Custom Datarender<a class="headerlink" href="DS_3D_Custom_Manual.html#implement-a-ds3d-custom-datarender" title="Link to this heading">#</a></h3>
<p>Examples:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/impl/impl_datarender.h&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestFakeDataRender</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">impl</span><span class="o">::</span><span class="n">BaseImplDataRender</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TestFakeDataRender</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">setInputCaps</span><span class="p">(</span><span class="s">&quot;ds3d/datamap&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">prerollImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">renderImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">,</span><span class="w"> </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">dataDoneCb</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">DS_ASSERT</span><span class="p">(</span><span class="n">datamap</span><span class="p">);</span>
<span class="w">        </span><span class="n">emitError</span><span class="p">(</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data rendered&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">dataDoneCb</span><span class="p">(</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">,</span><span class="w"> </span><span class="n">datamap</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ErrCode</span><span class="o">::</span><span class="n">kGood</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">DS3D_EXTERN_C_BEGIN</span>
<span class="n">DS3D_EXPORT_API</span><span class="w"> </span><span class="n">abiRefdatarender</span><span class="o">*</span>
<span class="n">createTestFakedatarender</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">NewAbiRef</span><span class="o">&lt;</span><span class="n">abiDataRender</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TestFakeDataRender</span><span class="p">());</span>
<span class="p">}</span>
<span class="n">DS3D_EXTERN_C_END</span>
</pre></div>
</div>
</div></blockquote>
<p>As shown in the example above, youll need to derive <cite>datarender</cite> from the <code class="docutils literal notranslate"><span class="pre">ds3d::impl::BaseImplDataRender</span></code> class, and implement interfaces for the following:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ErrCode</span><span class="w"> </span><span class="nf">startImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">prerollImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">renderImpl</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">datamap</span><span class="p">,</span><span class="w"> </span><span class="n">OnGuardDataCBImpl</span><span class="w"> </span><span class="n">dataDoneCb</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">stopImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="n">ErrCode</span><span class="w"> </span><span class="nf">flushImpl</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>To load this custom lib through <code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateDataRenderSink</span></code>, youll also need to export a specific symbol <code class="docutils literal notranslate"><span class="pre">createTestFakedatarender</span></code>.</p>
</section>
</section>
<section id="custom-libs-configuration-specifications">
<h2>Custom Libs Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-libs-configuration-specifications" title="Link to this heading">#</a></h2>
<section id="components-common-configuration-specifications">
<h3>Components Common Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#components-common-configuration-specifications" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table" id="id1">
<caption><span class="caption-text">ds3d common configuration specifications</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p>Custom processor type</p></td>
<td><p>String, [ds3d::dataloader, ds3d::datafilter, ds3d::datarender]</p></td>
<td><p>type: ds3d::dataloader</p></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>Indicate user-defined component name</p></td>
<td><p>String</p></td>
<td><p>name: depthloader</p></td>
</tr>
<tr class="row-even"><td><p>in_caps</p></td>
<td><p>Indicate Gst sink caps for the component</p></td>
<td><p>String</p></td>
<td><p>in_caps: ds3d/datamap</p></td>
</tr>
<tr class="row-odd"><td><p>out_caps</p></td>
<td><p>Indicate Gst sink caps for the component</p></td>
<td><p>String</p></td>
<td><p>out_caps: ds3d/datamap</p></td>
</tr>
<tr class="row-even"><td><p>custom_lib_path</p></td>
<td><p>Indicate custom lib path</p></td>
<td><p>String</p></td>
<td><p>custom_lib_path: libnvds_3d_gl_datarender.so</p></td>
</tr>
<tr class="row-odd"><td><p>custom_create_function</p></td>
<td><p>Indicate custom function to create the specific ds3d processing component</p></td>
<td><p>String</p></td>
<td><p>custom_create_function: createPointCloudDataRender</p></td>
</tr>
<tr class="row-even"><td><p>config_body</p></td>
<td><p>Indicate YAML specific content for the custom comonent</p></td>
<td><p>String</p></td>
<td><dl class="simple">
<dt>config_body:</dt><dd><p>in_streams: [color, depth]
max_points: 407040</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<p>These custom libs are part of DeepStream release package.</p>
</section>
<section id="supported-ds3d-custom-process-libraries">
<h3>Supported DS3D Custom Process libraries<a class="headerlink" href="DS_3D_Custom_Manual.html#supported-ds3d-custom-process-libraries" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table" id="id2">
<caption><span class="caption-text">DS3D custom libs</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 9.1%" />
<col style="width: 18.2%" />
<col style="width: 18.2%" />
<col style="width: 18.2%" />
<col style="width: 36.4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>DS3D Process Type</p></th>
<th class="head"><p>Functionality</p></th>
<th class="head"><p>DS3D custom library</p></th>
<th class="head"><p>DS3D Creating Instance Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>dataloader</cite></p></td>
<td><p>lidar-file-reader</p></td>
<td><p><cite>libnvds_lidarfileread.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createLidarFileLoader</span></code></p></td>
<td><p>Lidar file data reader library, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-dataloader-lidar-file-spec"><span class="std std-ref">Custom Dataloader libnvds_lidarfileread Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>dataloader</cite></p></td>
<td><p>realsense camera depth/image capture</p></td>
<td><p><cite>libnvds_3d_dataloader_realsense.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createRealsenseDataloader</span></code></p></td>
<td><p>RealSense Camera capture dataloader library, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-dataloader-realsense-spec"><span class="std std-ref">Custom Dataloader libnvds_3d_dataloader_realsense Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-even"><td><p><cite>datafilter</cite></p></td>
<td><p>multi sensor triton inference lib</p></td>
<td><p><cite>libnvds_tritoninferfilter.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createLidarInferenceFilter</span></code></p></td>
<td><p>Multi-modal sensor triton inference library, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-tritoninferfilter-spec"><span class="std std-ref">libnvds_tritoninferfilter Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>datafilter</cite></p></td>
<td><p>data_alignment</p></td>
<td><p><cite>libnvds_3d_alignment_datafilter.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createLidarAlignmentFilter</span></code></p></td>
<td><p>lidar/camera Sensor Intrinsic and Extrinsic parameters and alignment, see details in <a class="reference internal" href="DS_plugin_gst-nvds3dfilter.html#ds-plugin-3d-filter-alignment-datafilter"><span class="std std-ref">Custom ds3d::datafilter library: libnvds_3d_alignment_datafilter.so</span></a></p></td>
</tr>
<tr class="row-even"><td><p><cite>datafilter</cite></p></td>
<td><p>lidar_data_preprocess</p></td>
<td><p><cite>libnvds_3d_lidar_preprocess_datafilter.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createLidarPreprocessFilter</span></code></p></td>
<td><p>lidar data voxel processing, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-plugin-3d-filter-lidar-preprocess-datafilter"><span class="std std-ref">Custom Datafilter libnvds_3d_lidar_preprocess_datafilter Specifications</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>datafilter</cite></p></td>
<td><p>depth-to-point-cound</p></td>
<td><p><cite>libnvds_3d_depth2point_datafilter.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createDepth2PointFilter</span></code></p></td>
<td><p>Convert Image Depth data into 3D Point Cloud data, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-spec-depth2point-datafilter"><span class="std std-ref">Custom datafilter libnvds_3d_depth2point_datafilter Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-even"><td><p><cite>databridge</cite></p></td>
<td><p>bridge 2D into DS3D</p></td>
<td><p><cite>libnvds_3d_video_databridge.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createVideoBridge2d3d</span></code></p></td>
<td><p>Convert DeepStream 2D batchmeta and surface into <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_plugin_gst-nvds3dbridge.html#ds-plugin-gst-nvds3dbridge-video-spec"><span class="std std-ref">Configuration file</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>datamixer</cite></p></td>
<td><p>mixer for video and lidar/radar</p></td>
<td><p><cite>libnvds_3d_multisensor_mixer.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createMultiSensorMixer</span></code></p></td>
<td><p>Combines video data (2D) and LiDAR data (3D) into a single <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_plugin_gst-nvds3dmixer.html#ds-plugin-gst-nvds3dmixer-multisensor-spec"><span class="std std-ref">Configuration file</span></a></p></td>
</tr>
<tr class="row-even"><td><p><cite>datarender</cite></p></td>
<td><p>3D multiview scene render</p></td>
<td><p><cite>libnvds_3d_gles_ensemble_render.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NvDs3D_CreateGlesEnsembleRender</span></code></p></td>
<td><p>Renders a 3D multi-view scene using GLES with with various elements (textures, LiDAR points, bounding boxes) inside <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-lib-gles-ensemble-spec"><span class="std std-ref">Custom datarender libnvds_3d_gles_ensemble_render Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>datarender</cite></p></td>
<td><p>3D point-cloud data render with texture</p></td>
<td><p><cite>libnvds_3d_gl_datarender.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createPointCloudDataRender</span></code></p></td>
<td><p>Renders 3D(Scene construction) PointCould(XYZ) data with RGBA color textures inside <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-spec-gl-datarender"><span class="std std-ref">Custom datarender libnvds_3d_gl_datarender Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-even"><td><p><cite>datarender</cite></p></td>
<td><p>3D lidar(XYZI/XYZ) data render</p></td>
<td><p><cite>libnvds_3d_gl_datarender.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createLidarDataRender</span></code></p></td>
<td><p>Renders 3D Lidar(XYZI/XYZ) data inside <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-spec-gl-datarender"><span class="std std-ref">Custom datarender libnvds_3d_gl_datarender Configuration Specifications</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><cite>datarender</cite></p></td>
<td><p>depth image 2D render</p></td>
<td><p><cite>libnvds_3d_gl_datarender.so</cite></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">createDepthStreamDataRender</span></code></p></td>
<td><p>Renders 2D depth and Camera RGBA data inside <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, see details in <a class="reference internal" href="DS_3D_Custom_Manual.html#ds-3d-custom-manual-spec-gl-datarender"><span class="std std-ref">Custom datarender libnvds_3d_gl_datarender Configuration Specifications</span></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="libnvds-tritoninferfilter-configuration-specifications">
<span id="ds-3d-custom-manual-tritoninferfilter-spec"></span><h3>libnvds_tritoninferfilter Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#libnvds-tritoninferfilter-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Multi-modal tensors Triton inference with key-value pairs in <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, Supports user defined custom preprocess and postprocess.</p>
<ul>
<li><p>Configuration for multi-modal triton inference Header:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: multimodal_triton_infer
type: ds3d::datafilter
in_caps: ds3d/datamap
out_caps: ds3d/datamap
custom_lib_path: libnvds_tritoninferfilter.so
custom_create_function: createLidarInferenceFilter
</pre></div>
</div>
</li>
<li><p>Config body specifications</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id3">
<caption><span class="caption-text">libnvds_tritoninferfilter <code class="docutils literal notranslate"><span class="pre">config_body</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>in_streams</p></td>
<td><p>which data type will be processed</p></td>
<td><p>List of String, Optional</p></td>
<td><p>in_streams: [lidar]</p></td>
</tr>
<tr class="row-odd"><td><p>gpu_id</p></td>
<td><p>GPU device ID</p></td>
<td><p>Integer, default value:</p></td>
<td><p>gpu_id: 0</p></td>
</tr>
<tr class="row-even"><td><p>config_file</p></td>
<td><p>nvinferserver(triton) low level lib config file, supports gRPC and CAPI,
see more details <a class="reference internal" href="DS_plugin_gst-nvinferserver.html#ds-plugin-gst-nvinferserver-low-level-spec"><span class="std std-ref">Low Level libnvds_infer_server.so Configuration File Specifications</span></a></p></td>
<td><p>String of Path</p></td>
<td><p>config_file: model_config_files/config_triton_bev_fusion_infer_grpc.pbtxt</p></td>
</tr>
<tr class="row-odd"><td><p>mem_pool_size</p></td>
<td><p>Size of the input tensor pool</p></td>
<td><p>Integer</p></td>
<td><p>mem_pool_size: 8</p></td>
</tr>
<tr class="row-even"><td><p>model_inputs</p></td>
<td><p>model s input layers information, If there is no custom_preprocess defined, inferencefilter would forward the key-value frames from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> to tritons input tensor</p></td>
<td><p>List of Dict</p></td>
<td><ul class="simple">
<li><dl class="simple">
<dt>name: input_image_0</dt><dd><p>datatype: UINT8
shape: [1, 900, 1600, 4]
from: DS3D::ColorFrame_0+1
is_2d_frame: true</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>input_tensor_mem_type</p></td>
<td><p>input tensor memory type after preprocess</p></td>
<td><p>String:[GpuCuda CpuCuda]</p></td>
<td><p>input_tensor_mem_type: GpuCuda</p></td>
</tr>
<tr class="row-even"><td><p>custom_preprocess_lib_path</p></td>
<td><p>custom preprocessing library path</p></td>
<td><p>String</p></td>
<td><p>custom_preprocess_lib_path: /opt/nvidia/deepstream/deepstream/lib/libnvds_lidar_custom_preprocess_impl.so</p></td>
</tr>
<tr class="row-odd"><td><p>custom_preprocess_func_name</p></td>
<td><p>customized preprocessing function name</p></td>
<td><p>String</p></td>
<td><p>custom_preprocess_func_name: CreateInferServerCustomPreprocess</p></td>
</tr>
<tr class="row-even"><td><p>postprocess</p></td>
<td><p>User defined postprocessing information</p></td>
<td><p>Dict</p></td>
<td><dl class="simple">
<dt>postprocess:</dt><dd><p>score_threshold: 0.5</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>labels</p></td>
<td><p>User defined labels for custom postprocess</p></td>
<td><p>List of Dict</p></td>
<td><dl class="simple">
<dt>labels:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>car:</dt><dd><p>color: [255, 158, 0]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>truck:</dt><dd><p>color: [255, 99, 71]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<p><code class="docutils literal notranslate"><span class="pre">model_inputs</span></code> has all input layers information. If there is custom preprocess function/lib specfied inside config body. The lib would search <code class="docutils literal notranslate"><span class="pre">from</span></code> keyname of the input <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, and forward the frame/tensor data into Triton servers input tensors. The <code class="docutils literal notranslate"><span class="pre">from</span></code> keyname must be a frame, 2D-frame or tensor inside the <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p>
<ul class="simple">
<li><p>Configuration Specifications of the <code class="docutils literal notranslate"><span class="pre">model_inputs</span></code></p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id4">
<caption><span class="caption-text">items of list <code class="docutils literal notranslate"><span class="pre">model_inputs</span></code></span><a class="headerlink" href="DS_3D_Custom_Manual.html#id4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>Models input tensor name</p></td>
<td><p>String</p></td>
<td><p>name: input_image_0</p></td>
</tr>
<tr class="row-odd"><td><p>datatype</p></td>
<td><p>Models input data type</p></td>
<td><p>String values in [FP32, FP16, INT8, INT32, INT16, UINT8, UINT16, UINT32, FP64, INT64, UINT64, BYTES, BOOL]</p></td>
<td><p>datatype: FP32</p></td>
</tr>
<tr class="row-even"><td><p>shape</p></td>
<td><p>Models input tensor shape</p></td>
<td><p>List of Integer</p></td>
<td><p>shape: [1, 900, 1600, 4]</p></td>
</tr>
<tr class="row-odd"><td><p>from</p></td>
<td><p>The keyname of the input <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, the value must be a frame/2D-frame/tensor. If custom_preprocess is not existing, the frame would be forwarded into Tritons input tensors directly.</p></td>
<td><p>String</p></td>
<td><p>from: DS3D::ColorFrame_5</p></td>
</tr>
<tr class="row-even"><td><p>is_2d_frame</p></td>
<td><p>Indicate the <code class="docutils literal notranslate"><span class="pre">from</span></code> inside of <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> is a 2D frame.</p></td>
<td><p>Bool</p></td>
<td><p>is_2d_frame: true</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Custom preprocess before triton inference</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">custom_preprocess_lib_path</span></code> and <code class="docutils literal notranslate"><span class="pre">custom_preprocess_func_name</span></code> are specified, Custom processing will be loaded and parse the config body and get all common and user defined information. then process each input <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> and generate <code class="docutils literal notranslate"><span class="pre">batchArray</span></code> for triton inference inputs.</p>
<p>Users can derive interface <code class="docutils literal notranslate"><span class="pre">IInferCustomPreprocessor</span></code> from <code class="docutils literal notranslate"><span class="pre">sources/includes/ds3d/common/hpp/lidar_custom_process.hpp</span></code>
See examples in <code class="docutils literal notranslate"><span class="pre">sources/libs/ds3d/inference_custom_lib/ds3d_v2x_infer_custom_preprocess/nvinferserver_custom_preprocess.cpp</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/datamap.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/frame.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/lidar_custom_process.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ds3d</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">nvdsinferserver</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NvInferServerCustomPreProcess</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IInferCustomPreprocessor</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// process key-values from datamap and generate into model inputs batchArray.</span>
<span class="w">  </span><span class="n">NvDsInferStatus</span><span class="w"> </span><span class="n">preproc</span><span class="p">(</span><span class="n">GuardDataMap</span><span class="w"> </span><span class="o">&amp;</span><span class="n">datamap</span><span class="p">,</span><span class="w"> </span><span class="n">SharedIBatchArray</span><span class="w"> </span><span class="n">batchArray</span><span class="p">,</span><span class="w"> </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="n">stream</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{...}</span>
<span class="p">};</span>
<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="n">IInferCustomPreprocessor</span><span class="w"> </span><span class="o">*</span><span class="nf">CreateInferServerCustomPreprocess</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NvInferServerCustomPreProcess</span><span class="p">();</span>
<span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Custom postprocess after triton inference</p></li>
</ul>
<p>Postprocessing is quite specific for each model. Youll need to implement your own postprocessing functions based on inference output tensors results.
Custom postprocess libs and functions are specfied from nvdsinferservers config. for example in <code class="docutils literal notranslate"><span class="pre">apps/sample_apps/deepstream-3d-lidar-sensor-fusion/model_config_files/config_triton_bev_fusion_infer_grpc.pbtxt</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>infer_config {
  backend {
    triton {
      model_name: &quot;bevfusion&quot;
      grpc {...}
  } }
  extra {
    output_buffer_pool_size: 4
    # specify custom postprocess function
    custom_process_funcion: &quot;Nvds3d_CreateLidarDetectionPostprocess&quot;
  }
  custom_lib {
    # specify custom postprocess library
    path: &quot;libnvds_3d_infer_postprocess_lidar_detection.so&quot;
  }
}
</pre></div>
</div>
<p>An example of custom postprocess implementation is provided here:  <code class="docutils literal notranslate"><span class="pre">sources/libs/ds3d/inference_custom_lib/ds3d_lidar_detection_postprocess/ds3d_infer_postprocess_lidar_detection.cpp</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;infer_custom_process.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/frame.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ds3d/common/hpp/datamap.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ds3d</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">nvdsinferserver</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DS3DTritonLidarInferCustomPostProcess</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IInferCustomProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// process key-values from datamap and generate into model inputs batchArray.</span>
<span class="w">  </span><span class="n">NvDsInferStatus</span><span class="w"> </span><span class="n">inferenceDone</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">IBatchArray</span><span class="o">*</span><span class="w"> </span><span class="n">batchArray</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">IOptions</span><span class="o">*</span><span class="w"> </span><span class="n">inOptions</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="p">...</span>

<span class="w">    </span><span class="c1">// get ``ds3d::datamap`` from ``inOptions``</span>
<span class="w">    </span><span class="n">abiRefDataMap</span><span class="o">*</span><span class="w"> </span><span class="n">refDataMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inOptions</span><span class="o">-&gt;</span><span class="n">hasValue</span><span class="p">(</span><span class="n">kLidarRefDataMap</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">INFER_ASSERT</span><span class="p">(</span><span class="n">inOptions</span><span class="o">-&gt;</span><span class="n">getObj</span><span class="p">(</span><span class="n">kLidarRefDataMap</span><span class="p">,</span><span class="w"> </span><span class="n">refDataMap</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NVDSINFER_SUCCESS</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">GuardDataMap</span><span class="w"> </span><span class="n">dataMap</span><span class="p">(</span><span class="o">*</span><span class="n">refDataMap</span><span class="p">);</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="c1">// parsing output tensors from batchArray</span>
<span class="w">    </span><span class="n">TensorMap</span><span class="w"> </span><span class="n">outTensors</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">batchArray</span><span class="o">-&gt;</span><span class="n">getSize</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batchArray</span><span class="o">-&gt;</span><span class="n">getSafeBuf</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="n">outTensors</span><span class="p">[</span><span class="n">buf</span><span class="o">-&gt;</span><span class="n">getBufDesc</span><span class="p">().</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buf</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Lidar3DBbox</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bboxes</span><span class="p">;</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseLidar3Dbbox</span><span class="p">(</span><span class="n">outTensors</span><span class="p">,</span><span class="w"> </span><span class="n">bboxes</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warp data into ds3d frame ``bboxFrame``</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">bufBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Lidar3DBbox</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bboxes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">bufBase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="n">bboxes</span><span class="p">.</span><span class="n">data</span><span class="p">();</span>
<span class="w">    </span><span class="n">Shape</span><span class="w"> </span><span class="n">shape</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">bboxes</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Lidar3DBbox</span><span class="p">)}};</span>
<span class="w">    </span><span class="n">FrameGuard</span><span class="w"> </span><span class="n">bboxFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">impl</span><span class="o">::</span><span class="n">WrapFrame</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">,</span><span class="w"> </span><span class="n">FrameType</span><span class="o">::</span><span class="n">kCustom</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="n">bufBase</span><span class="p">,</span><span class="w"> </span><span class="n">bufBytes</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">MemType</span><span class="o">::</span><span class="n">kCpu</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">outdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)](</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span>
<span class="w">    </span><span class="c1">// add key-value fram into ds3d::datamap</span>
<span class="w">    </span><span class="n">ErrCode</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataMap</span><span class="p">.</span><span class="n">setGuardData</span><span class="p">(</span><span class="n">_3dBboxKey</span><span class="p">,</span><span class="w"> </span><span class="n">bboxFrame</span><span class="p">);</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="n">IInferCustomProcessor</span><span class="w"> </span><span class="o">*</span><span class="nf">Nvds3d_CreateLidarDetectionPostprocess</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DS3DTritonLidarInferCustomPostProcess</span><span class="p">();</span>
<span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="custom-datafilter-libnvds-3d-alignment-datafilter-specifications">
<span id="ds-3d-custom-manual-alignment-datafilter-spec"></span><h3>Custom Datafilter libnvds_3d_alignment_datafilter Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-alignment-datafilter-specifications" title="Link to this heading">#</a></h3>
<p>Data alignment for lidar and video data can be done using a custom library provided with DeepStreamSDK.</p>
<p>More details on this is here: <a class="reference internal" href="DS_plugin_gst-nvds3dfilter.html#ds-plugin-3d-filter-alignment-datafilter"><span class="std std-ref">Custom ds3d::datafilter library: libnvds_3d_alignment_datafilter.so</span></a>.</p>
</section>
<section id="custom-datafilter-libnvds-3d-lidar-preprocess-datafilter-specifications">
<span id="ds-plugin-3d-filter-lidar-preprocess-datafilter"></span><h3>Custom Datafilter libnvds_3d_lidar_preprocess_datafilter Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-lidar-preprocess-datafilter-specifications" title="Link to this heading">#</a></h3>
<p>LiDAR data preprocess into voxel data format before V2X model sensor fusion inference.
Source files located at <code class="docutils literal notranslate"><span class="pre">/opt/nvidia/deepstream/deepstream/sources/libs/ds3d/datafilter/lidar_preprocess</span></code></p>
<ul>
<li><p>Configuration for Lidar data preprocess <code class="docutils literal notranslate"><span class="pre">ds3d::datafilter</span></code> Header:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: lidarpreprocess
type: ds3d::datafilter
out_caps: ds3d/datamap
custom_lib_path: libnvds_3d_lidar_preprocess_datafilter.so
custom_create_function: createLidarPreprocessFilter
</pre></div>
</div>
</li>
<li><p>Config Body Specifications</p></li>
</ul>
<p>For example:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>config_body:
mem_pool_size: 4
filter_input_datamap_key: DS3D::LidarXYZI_0
model_inputs:
- name: feats
  datatype: FP16
  shape: [4, 8000, 10, 9]
- name: coords
  datatype: INT32
  shape: [4, 8000, 4]
- name: N
  datatype: INT32
  shape: [4, 1]
gpu_id: 0
input_tensor_mem_type: GpuCuda
lidar_data_from: [DS3D::LidarXYZI_0, DS3D::LidarXYZI_1, DS3D::LidarXYZI_2, DS3D::LidarXYZI_3]
output_features_tensor_key: DS3D::LidarFeatureTensor
output_coords_tensor_key: DS3D::LidarCoordTensor
output_num_tensor_key: DS3D::LidarPointNumTensor
</pre></div>
</div>
</div></blockquote>
<div class="pst-scrollable-table-container"><table class="table" id="id5">
<caption><span class="caption-text">DS3D libnvds_3d_lidar_preprocess_datafilter custom libs</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id5" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mem_pool_size</p></td>
<td><p>memory buffer pool size</p></td>
<td><p>Integer</p></td>
<td><p>mem_pool_size: 4</p></td>
</tr>
<tr class="row-odd"><td><p>filter_input_datamap_key</p></td>
<td><p>Specify input lidar data key name</p></td>
<td><p>String</p></td>
<td><p>filter_input_datamap_key: DS3D::LidarXYZI_0</p></td>
</tr>
<tr class="row-even"><td><p>model_inputs</p></td>
<td><p>Specify model input layers info</p></td>
<td><p>Dict</p></td>
<td><p>see exmaple in deepstrem-3d-lidar-sensor-fusion/ds3d_lidar_video_sensor_v2xfusion.yml</p></td>
</tr>
<tr class="row-odd"><td><p>gpu_id</p></td>
<td><p>Specify GPU ID</p></td>
<td><p>Integer</p></td>
<td><p>gpu_id: 0</p></td>
</tr>
<tr class="row-even"><td><p>input_tensor_mem_type</p></td>
<td><p>Specify model input tensors memory type</p></td>
<td><p>String, select value from [GpuCuda, CpuCuda]</p></td>
<td><p>input_tensor_mem_type: GpuCuda</p></td>
</tr>
<tr class="row-odd"><td><p>lidar_data_from</p></td>
<td><p>Specify lidar data key name</p></td>
<td><p>List of String</p></td>
<td><p>lidar_data_from: [DS3D::LidarXYZI_0]</p></td>
</tr>
<tr class="row-even"><td><p>output_features_tensor_key</p></td>
<td><p>Specify output lidar feature tensor key name</p></td>
<td><p>String</p></td>
<td><p>DS3D::LidarFeatureTensor</p></td>
</tr>
<tr class="row-odd"><td><p>output_coords_tensor_key</p></td>
<td><p>Specify output lidar coordinate tensor key name</p></td>
<td><p>String</p></td>
<td><p>output_coords_tensor_key: DS3D::LidarCoordTensor</p></td>
</tr>
<tr class="row-even"><td><p>output_num_tensor_key</p></td>
<td><p>Specify keyname of numbers of ldiar data into tensor</p></td>
<td><p>String</p></td>
<td><p>output_num_tensor_key: DS3D::LidarPointNumTensor</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-dataloader-libnvds-lidarfileread-configuration-specifications">
<span id="ds-3d-custom-manual-dataloader-lidar-file-spec"></span><h3>Custom Dataloader libnvds_lidarfileread Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-dataloader-libnvds-lidarfileread-configuration-specifications" title="Link to this heading">#</a></h3>
<p>The lib reads lidar data file frame by frame, it creates a new <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> per frame and deliver to next compoment.
Source files located at <code class="docutils literal notranslate"><span class="pre">/opt/nvidia/deepstream/deepstream/sources/libs/ds3d/dataloader/lidarsource</span></code></p>
<ul>
<li><p>Configuration for Lidar file reader <code class="docutils literal notranslate"><span class="pre">ds3d::dataloader</span></code> Header:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: ds3d_lidar_file_source
type: ds3d::dataloader
out_caps: ds3d/datamap
custom_lib_path: libnvds_lidarfileread.so
custom_create_function: createLidarFileLoader
</pre></div>
</div>
</li>
<li><p>Config Body Specifications</p></li>
</ul>
<p>For example:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>config_body:
  data_config_file: lidar_nuscene_data_list.yaml
  points_num: 242180
  fixed_points_num: True
  lidar_datatype: FP32
  mem_type: gpu
  gpu_id: 0
  mem_pool_size: 6
  element_size: 4
  output_datamap_key: DS3D::LidarXYZI
  file_loop: True
</pre></div>
</div>
</div></blockquote>
<div class="pst-scrollable-table-container"><table class="table" id="id6">
<caption><span class="caption-text">DS3D libnvds_lidarfileread custom libs</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id6" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
<col style="width: 28.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>data_config_file</p></td>
<td><p>lidar data list file path</p></td>
<td><p>Path String, or List of Path String</p></td>
<td><p>data_config_file: lidar_data_list.yaml</p></td>
</tr>
<tr class="row-odd"><td><p>source_id</p></td>
<td><p>Specify the unique source id of the loader instance</p></td>
<td><p>Integer</p></td>
<td><p>source_id: 0</p></td>
</tr>
<tr class="row-even"><td><p>points_num</p></td>
<td><p>Specify point number of each frame</p></td>
<td><p>Integer</p></td>
<td><p>points_num: 70000</p></td>
</tr>
<tr class="row-odd"><td><p>fixed_points_num</p></td>
<td><p>Indicate the point number is always same as <code class="docutils literal notranslate"><span class="pre">points_num</span></code></p></td>
<td><p>Bool</p></td>
<td><p>fixed_points_num: False</p></td>
</tr>
<tr class="row-even"><td><p>lidar_datatype</p></td>
<td><p>Specify Lidar data type</p></td>
<td><p>String, Only FP32 supported for now.</p></td>
<td><p>lidar_datatype: FP32</p></td>
</tr>
<tr class="row-odd"><td><p>mem_type</p></td>
<td><p>Specify memory type of process data, supports [cpu, gpu]</p></td>
<td><p>String, [cpu, gpu]</p></td>
<td><p>mem_type: gpu</p></td>
</tr>
<tr class="row-even"><td><p>mem_pool_size</p></td>
<td><p>Specify buffer pool size allocated for frames</p></td>
<td><p>Integer</p></td>
<td><p>mem_pool_size: 16</p></td>
</tr>
<tr class="row-odd"><td><p>gpu_id</p></td>
<td><p>Specify GPU ID in the case of <code class="docutils literal notranslate"><span class="pre">mem_type:</span> <span class="pre">gpu</span></code></p></td>
<td><p>Integer</p></td>
<td><p>gpu_id: 0</p></td>
</tr>
<tr class="row-even"><td><p>element_size</p></td>
<td><p>Specify how manay elements will be read per each point. 3, means XYZ, 4, means XYZI.</p></td>
<td><p>Integer</p></td>
<td><p>element_size: 4</p></td>
</tr>
<tr class="row-odd"><td><p>element_stride</p></td>
<td><p>Specify element stride between 2 continous points. e.g. XYZI, stride:4, XYZIT,5</p></td>
<td><p>Integer</p></td>
<td><p>element_stride: 4</p></td>
</tr>
<tr class="row-even"><td><p>file_loop</p></td>
<td><p>Indicate whether loop the file list without EOS</p></td>
<td><p>Bool</p></td>
<td><p>file_loop: True</p></td>
</tr>
<tr class="row-odd"><td><p>output_datamap_key</p></td>
<td><p>Specify output frame keyname into the <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p></td>
<td><p>String or List of String</p></td>
<td><p>output_datamap_key: DS3D::LidarXYZI_0</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>lidar data config file</p></li>
</ul>
<p>The lib reads frames from <code class="docutils literal notranslate"><span class="pre">data_config_file</span></code> which is a seperate file containers multiple lidar files. each lidar file is a single lidar frame file which are listed inside of <code class="docutils literal notranslate"><span class="pre">source-list</span></code>. Each items keyname is the timestamp(millisecond) of the lidar frame.</p>
<p>An example of <code class="docutils literal notranslate"><span class="pre">data_config_file</span></code>.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>source-list:
  - 0: /opt/nvidia/deepstream/deepstream/sources/apps/sample_apps/deepstream-3d-lidar-sensor-fusion/data/nuscene/LIDAR_TOP/000000-LIDAR_TOP.bin
  - 50: /opt/nvidia/deepstream/deepstream/sources/apps/sample_apps/deepstream-3d-lidar-sensor-fusion/data/nuscene/LIDAR_TOP/000001-LIDAR_TOP.bin
  - 100: /opt/nvidia/deepstream/deepstream/sources/apps/sample_apps/deepstream-3d-lidar-sensor-fusion/data/nuscene/LIDAR_TOP/000002-LIDAR_TOP.bin
</pre></div>
</div>
</div></blockquote>
</section>
<section id="custom-dataloader-libnvds-3d-dataloader-realsense-configuration-specifications">
<span id="ds-3d-custom-manual-dataloader-realsense-spec"></span><h3>Custom Dataloader libnvds_3d_dataloader_realsense Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-dataloader-libnvds-3d-dataloader-realsense-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Configuration for <cite>Realsense</cite> <cite>Dataloader</cite> Header:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: realsense_dataloader
type: ds3d::dataloader
out_caps: ds3d/datamap
custom_lib_path: libnvds_3d_dataloader_realsense.so
custom_create_function: createRealsenseDataloader
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">libnvds_3d_dataloader_realsense.so</span></code> requires you to install <cite>librealsense2</cite> SDK. For x86, follow the instructions from <a class="github reference external" href="https://github.com/IntelRealSense/librealsense/blob/master/doc/distribution_linux.md">IntelRealSense/librealsense</a>.
For Jetson platform, follow the instructions from <a class="github reference external" href="https://github.com/IntelRealSense/librealsense/blob/master/doc/installation_jetson.md">IntelRealSense/librealsense</a>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id7">
<caption><span class="caption-text">libnvds_3d_dataloader_realsense <code class="docutils literal notranslate"><span class="pre">config_body</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id7" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>streams</p></td>
<td><p>Specify which streams to enable</p></td>
<td><p>List[String],  select from [color, depth]</p></td>
<td><p>streams: [color, depth]</p></td>
</tr>
<tr class="row-odd"><td><p>aligned_image_to_depth</p></td>
<td><p>Indicate whether color image is aligned to depth</p></td>
<td><p>Boolean</p></td>
<td><p>aligned_image_to_depth: False</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-datafilter-libnvds-3d-depth2point-datafilter-configuration-specifications">
<span id="ds-3d-custom-manual-spec-depth2point-datafilter"></span><h3>Custom datafilter libnvds_3d_depth2point_datafilter Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-depth2point-datafilter-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Convert 2D depth data into 3D point-cloud(XYZ) data into <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p>
<ul class="simple">
<li><p>Configuration for Depth to Points Header:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: depth2points
type: ds3d::datafilter
in_caps: ds3d/datamap
out_caps: ds3d/datamap
custom_lib_path: libnvds_3d_depth2point_datafilter.so
custom_create_function: createDepth2PointFilter
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table" id="id8">
<caption><span class="caption-text">libnvds_3d_depth2point_datafilter <code class="docutils literal notranslate"><span class="pre">config_body</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id8" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>streams</p></td>
<td><p>Specify which streams to enable</p></td>
<td><p>List[String],  select from [color, depth]</p></td>
<td><p>streams: [color, depth]</p></td>
</tr>
<tr class="row-odd"><td><p>max_points</p></td>
<td><p>Indicate maximum 3d points to allocate</p></td>
<td><p>Uint32</p></td>
<td><p>max_points: 407040</p></td>
</tr>
<tr class="row-even"><td><p>mem_pool_size</p></td>
<td><p>Indicate max buffer pool size</p></td>
<td><p>Uint32</p></td>
<td><p>mem_pool_size: 8</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-datarender-libnvds-3d-gles-ensemble-render-configuration-specifications">
<span id="ds-3d-custom-manual-lib-gles-ensemble-spec"></span><h3>Custom datarender libnvds_3d_gles_ensemble_render Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-datarender-libnvds-3d-gles-ensemble-render-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Renders 3D scene using OpenGL ES (GLES) with various elements (textures, LiDAR points, bounding boxes) within a single window, allowing for flexible layout customization. Users can split the windows into multiple views, and project each tensor data or frame from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> into a seperate view or into multiple views at the same time.
It could also support overlay if multi frames rendered into a single view positon overlap, it depends on the render graph order.</p>
<ul class="simple">
<li><p>Configuration Header</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: ds3d_sensor_fusion_render
type: ds3d::datarender
in_caps: ds3d/datamap
custom_lib_path: libnvds_3d_gles_ensemble_render.so
custom_create_function: NvDs3D_CreateGlesEnsembleRender
</pre></div>
</div>
<ul class="simple">
<li><p>Configuration Body</p></li>
</ul>
<p>An example of a multi-view config with <code class="docutils literal notranslate"><span class="pre">render_graph</span></code>. There are 2 views rendered with different frames inside the same <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>. The 2D color image is rendered by <code class="docutils literal notranslate"><span class="pre">texture3d_render</span></code> into view area <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">640,</span> <span class="pre">360]</span></code>; The Lidar data is rendered by <code class="docutils literal notranslate"><span class="pre">lidar3d_render</span></code> into view area <code class="docutils literal notranslate"><span class="pre">[640,</span> <span class="pre">0,</span> <span class="pre">1280,</span> <span class="pre">360]</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>config_body:
  window_width: 1280 # window size
  window_height: 360 # window size
  color_clear: true
  window_title: DS3D-Lidar-6-Cameras-BEVFusion
  render_graph:
    - texture3d_render: # 2D texture view
        layout: [0, 0, 640, 360] # layout [x0, y0, x1, y1]
        max_vertex_num: 6
        color_clear: false
        texture_frame_key: DS3D::ColorFrame_2 # image data key
    - lidar3d_render: # lidar top view
        layout: [640, 0, 1280, 360] # layout [x0, y0, x1, y1]
        color_clear: false
        view_position: [0, 0, 30]
        view_target: [0, 0, 0]
        view_up: [0, 1, 0]
        lidar_color: [0, 0, 255]
        lidar_data_key: DS3D::LidarXYZI
        lidar_bbox_key: DS3D::Lidar3DBboxRawData
        element_size: 4
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table" id="id9">
<caption><span class="caption-text">libnvds_3d_gles_ensemble_render <code class="docutils literal notranslate"><span class="pre">config_body</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id9" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>window_title</p></td>
<td><p>Specify window title</p></td>
<td><p>string</p></td>
<td><p>window_title: DS3D-Lidar-6-Cameras-BEVFusion</p></td>
</tr>
<tr class="row-odd"><td><p>window_width</p></td>
<td><p>Specify window width</p></td>
<td><p>uint32</p></td>
<td><p>window_width: 1920</p></td>
</tr>
<tr class="row-even"><td><p>window_height</p></td>
<td><p>Specify window height</p></td>
<td><p>uint32</p></td>
<td><p>window_height: 1080</p></td>
</tr>
<tr class="row-odd"><td><p>color_clear</p></td>
<td><p>Specify whether to clear up the whole window when new frame arrive</p></td>
<td><p>bool</p></td>
<td><p>color_clear: true</p></td>
</tr>
<tr class="row-even"><td><p>render_graph</p></td>
<td><p>Specify a list of multiple renders in different views</p></td>
<td><p>List[Dict]</p></td>
<td><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>render_graph:
 - texture3d_render:
    layout: [0, 0, 640, 360]
    color_clear: false
    texture_frame_key: DS3D::ColorFrame
 - lidar3d_render:
    layout:  [640, 0, 1280, 360]
    color_clear: false
    lidar_data_key: DS3D::LidarXYZI
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Render graph <code class="docutils literal notranslate"><span class="pre">render_graph</span></code></p></li>
</ul>
<p>It supports 2 different modes of views</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">texture3d_render</span></code>, it renders 2D image data into a specified view area.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lidar3d_render</span></code>, it renders lidar data and 3D bbox data into a specified view area.</p></li>
</ul>
</div></blockquote>
<p>Each mode could be configured multiple times in the same <code class="docutils literal notranslate"><span class="pre">render_graph</span></code>. Multiple camera data inside a single <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> could be configured into different view area. Similarly, multiple lidar data insdie the same <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code> could also be configured at different viewpoint(topview, front-view, side-view) into different view area.</p>
<ul class="simple">
<li><p>Configuration Specifications of <code class="docutils literal notranslate"><span class="pre">texture3d_render</span></code></p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id10">
<caption><span class="caption-text">libnvds_3d_gles_ensemble_render <code class="docutils literal notranslate"><span class="pre">texture3d_render</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id10" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>layout</p></td>
<td><p>Specify the view location for [x0, y0, x1, y1]</p></td>
<td><p>List[Float]</p></td>
<td><p>layout: [0, 0, 640, 360]
x0 = 0;
y0 = 0;
x1 = 640;
y1 = 360;</p></td>
</tr>
<tr class="row-odd"><td><p>color_clear</p></td>
<td><p>Indicate whether to clear up this view before new frame came.</p></td>
<td><p>bool</p></td>
<td><p>color_clear: false</p></td>
</tr>
<tr class="row-even"><td><p>texture_frame_key</p></td>
<td><p>Specify texture image keyname from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p></td>
<td><p>string</p></td>
<td><p>texture_frame_key: DS3D::ColorFrame_1+1</p></td>
</tr>
<tr class="row-odd"><td><p>max_vertex_num</p></td>
<td><p>Specify vertex_num used for the texture drawing, default value 6</p></td>
<td><p>uint32</p></td>
<td><p>max_vertex_num: 6</p></td>
</tr>
<tr class="row-even"><td><p>texture_vetex_key</p></td>
<td><p>Specify 3D vertex key name from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, its used for the texture drawing, there are 6 values by default.</p></td>
<td><p>string</p></td>
<td><p>texture_vetex_key: DS3D::TextureVertexKey</p></td>
</tr>
<tr class="row-odd"><td><p>texture_coord_key</p></td>
<td><p>Specify texture coordinate key name from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>, its used for the texture drawing, there are 6 values by default.</p></td>
<td><p>string</p></td>
<td><p>texture_coord_key: DS3D::TextureCoordKey</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Configuration Specifications of <code class="docutils literal notranslate"><span class="pre">lidar3d_render</span></code></p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id11">
<caption><span class="caption-text">libnvds_3d_gles_ensemble_render <code class="docutils literal notranslate"><span class="pre">lidar3d_render</span></code> fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id11" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>layout</p></td>
<td><p>Specify the view location for [x0, y0, x1, y1]</p></td>
<td><p>List[Float]</p></td>
<td><p>layout: [0, 0, 640, 360]
x0 = 0;
y0 = 0;
x1 = 640;
y1 = 360;</p></td>
</tr>
<tr class="row-odd"><td><p>color_clear</p></td>
<td><p>Indicate whether to clear up this view before new frame came.</p></td>
<td><p>bool</p></td>
<td><p>color_clear: false</p></td>
</tr>
<tr class="row-even"><td><p>lidar_color</p></td>
<td><p>Specify lidar data color RGB</p></td>
<td><p>list[uint8]</p></td>
<td><p>lidar_color: [0, 0, 255]</p></td>
</tr>
<tr class="row-odd"><td><p>lidar_data_key</p></td>
<td><p>Specify lidar data keyname from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p></td>
<td><p>string</p></td>
<td><p>lidar_data_key: DS3D::LidarXYZI+0</p></td>
</tr>
<tr class="row-even"><td><p>element_size</p></td>
<td><p>Specify lidar data element size. choose from [3, 4], default value 4 is for xyzi. value 3 is for xyz.</p></td>
<td><p>uint32</p></td>
<td><p>element_size: 4</p></td>
</tr>
<tr class="row-odd"><td><p>lidar_bbox_key</p></td>
<td><p>Specify 3D detection bounding-box key name from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p></td>
<td><p>string</p></td>
<td><p>lidar_bbox_key: DS3D::Lidar3DBboxRawData</p></td>
</tr>
<tr class="row-even"><td><p>project_lidar_to_image</p></td>
<td><p>Indicate whether need project lidar data and bounding-box into camera image, default value: false</p></td>
<td><p>bool</p></td>
<td><p>project_lidar_to_image: false</p></td>
</tr>
<tr class="row-odd"><td><p>intrinsics_mat_key</p></td>
<td><p>Specify camera intrinsics matrix key name from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code>,  Its needed when project_lidar_to_image: true</p></td>
<td></td>
<td><p>intrinsics_mat_key: DS3D::Cam2_IntrinsicMatrix</p></td>
</tr>
<tr class="row-even"><td><p>extrinsics_mat_key</p></td>
<td><p>Specify lidar extrinsics matrix key name from <code class="docutils literal notranslate"><span class="pre">ds3d::datamap</span></code></p></td>
<td></td>
<td><p>extrinsics_mat_key: DS3D::LidarToCam2_ExtrinsicMatrix</p></td>
</tr>
<tr class="row-odd"><td><p>image_width</p></td>
<td><p>Specify original camera intrinsic image width, this is needed when project_lidar_to_image: true</p></td>
<td></td>
<td><p>image_width: 1600</p></td>
</tr>
<tr class="row-even"><td><p>image_height</p></td>
<td><p>Specify original camera intrinsic image height, this is needed when project_lidar_to_image: true</p></td>
<td></td>
<td><p>image_height: 900</p></td>
</tr>
<tr class="row-odd"><td><p>view_position</p></td>
<td><p>Specify view position [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_position: [0, 0, -1]</p></td>
</tr>
<tr class="row-even"><td><p>view_target</p></td>
<td><p>Specify view target [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_target: [0, 0, 1]</p></td>
</tr>
<tr class="row-odd"><td><p>view_up</p></td>
<td><p>Specify view up direction [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_up: [0, -1.0, 0]</p></td>
</tr>
<tr class="row-even"><td><p>perspective_near</p></td>
<td><p>Specify perspective projection near plane</p></td>
<td><p>Float</p></td>
<td><p>perspective_near: 0.1</p></td>
</tr>
<tr class="row-odd"><td><p>perspective_far</p></td>
<td><p>Specify perspective projection far plane</p></td>
<td><p>Float</p></td>
<td><p>perspective_far: 10.0</p></td>
</tr>
<tr class="row-even"><td><p>perspective_fov</p></td>
<td><p>Specify perspective projection field of view,  degree angle</p></td>
<td><p>Float</p></td>
<td><p>perspective_fov: 40.0</p></td>
</tr>
<tr class="row-odd"><td><p>perspective_ratio</p></td>
<td><p>Specify perspective ratio for width/height. default 0.0f means view-width/view-height</p></td>
<td><p>Float</p></td>
<td><p>perspective_ratio: 0.0</p></td>
</tr>
<tr class="row-even"><td><p>enable_label</p></td>
<td><p>Indicate whether label text render enabled. default value: false</p></td>
<td><p>bool</p></td>
<td><p>enable_label: true</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-datarender-libnvds-3d-gl-datarender-configuration-specifications">
<span id="ds-3d-custom-manual-spec-gl-datarender"></span><h3>Custom datarender libnvds_3d_gl_datarender Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#custom-datarender-libnvds-3d-gl-datarender-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Configuration Common header for <cite>libnvds_3d_gl_datarender</cite>:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: depth-point-render
type: ds3d::datarender
in_caps: ds3d/datamap
custom_lib_path: libnvds_3d_gl_datarender.so
</pre></div>
</div>
</div></blockquote>
<p>Configuration Body for Common Part:</p>
<div class="pst-scrollable-table-container"><table class="table" id="id12">
<caption><span class="caption-text">libnvds_3d_gl_datarender <code class="docutils literal notranslate"><span class="pre">config_body</span></code> common fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id12" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Specify window title</p></td>
<td><p>String</p></td>
<td><p>title: ds3d-point-cloud-test</p></td>
</tr>
<tr class="row-odd"><td><p>streams</p></td>
<td><p>Indicate which streams to render. depth render must have [depth], 3D points render must have [points]</p></td>
<td><p>List[String],  select from [color, depth, points]</p></td>
<td><p>streams: [color, depth]</p></td>
</tr>
<tr class="row-even"><td><p>width</p></td>
<td><p>Specify window width</p></td>
<td><p>UINT32</p></td>
<td><p>width: 1280</p></td>
</tr>
<tr class="row-odd"><td><p>height</p></td>
<td><p>Specify window height</p></td>
<td><p>UINT32</p></td>
<td><p>height: 720</p></td>
</tr>
<tr class="row-even"><td><p>block</p></td>
<td><p>Indicate rendering thread as block mode</p></td>
<td><p>Boolean</p></td>
<td><p>block: True</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Configuration Header for Point Cloud Render:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: point-3D-render
type: ds3d::datarender
in_caps: ds3d/datamap
custom_lib_path: libnvds_3d_gl_datarender.so
custom_create_function: createPointCloudDataRender # specific function for 3D point rendering
</pre></div>
</div>
<ul class="simple">
<li><p>Configuration Header for Lidar data Render:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: lidar-data-render
type: ds3d::datarender
in_caps: ds3d/datamap
custom_lib_path: libnvds_3d_gl_datarender.so
custom_create_function: createLidarDataRender # specific function for Lidar point cloud rendering
</pre></div>
</div>
<ul class="simple">
<li><p>Configuration Body for 3D Point Cloud and Lidar Render Part:</p></li>
</ul>
<p>For more details on 3D coordinate system, refer to <a class="reference external" href="https://learnopengl.com/Getting-started/Coordinate-Systems">https://learnopengl.com/Getting-started/Coordinate-Systems</a>.
To know the value meanings for <code class="docutils literal notranslate"><span class="pre">view_position</span></code>, <code class="docutils literal notranslate"><span class="pre">view_target</span></code> and <code class="docutils literal notranslate"><span class="pre">view_up</span></code>,refer to  the <code class="docutils literal notranslate"><span class="pre">gluLookAt</span></code> here: <a class="reference external" href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/gluLookAt.xml">https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/gluLookAt.xml</a>.
To know the value meanings for <code class="docutils literal notranslate"><span class="pre">near</span></code>, <code class="docutils literal notranslate"><span class="pre">far</span></code> and <code class="docutils literal notranslate"><span class="pre">fov</span></code>, refer to the <code class="docutils literal notranslate"><span class="pre">gluPerspective</span></code> here: <a class="reference external" href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/gluPerspective.xml">https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/gluPerspective.xml</a>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id13">
<caption><span class="caption-text">libnvds_3d_gl_datarender Point Cloud Render <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id13" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>view_position</p></td>
<td><p>Specify view position [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_position: [0, 0, -1]</p></td>
</tr>
<tr class="row-odd"><td><p>view_target</p></td>
<td><p>Specify view target [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_target: [0, 0, 1]</p></td>
</tr>
<tr class="row-even"><td><p>view_up</p></td>
<td><p>Specify view up direction [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_up: [0, -1.0, 0]</p></td>
</tr>
<tr class="row-odd"><td><p>near</p></td>
<td><p>Specify perspective projection near plane</p></td>
<td><p>Float</p></td>
<td><p>near: 0.01</p></td>
</tr>
<tr class="row-even"><td><p>far</p></td>
<td><p>Specify perspective projection far plane</p></td>
<td><p>Float</p></td>
<td><p>far: 10.0</p></td>
</tr>
<tr class="row-odd"><td><p>fov</p></td>
<td><p>Specify perspective projection field of view,  degree angle</p></td>
<td><p>Float</p></td>
<td><p>fov: 40.0</p></td>
</tr>
<tr class="row-even"><td><p>coord_y_opposite</p></td>
<td><p>Specify texture map V direction, Realsense coordinates is different from GLES default coordinates</p></td>
<td><p>Boolean</p></td>
<td><p>coord_y_opposite: False</p></td>
</tr>
<tr class="row-odd"><td><p>positive_z_only</p></td>
<td><p>Specify whether display negtive depth values</p></td>
<td><p>Boolean</p></td>
<td><p>positive_z_only: False</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Configuration Body for Lidar Render Specific Part:</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id14">
<caption><span class="caption-text">libnvds_3d_gl_datarender Lidar Render extra <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id14" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>view_position</p></td>
<td><p>Specify view position [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_position: [0, 0, -1]</p></td>
</tr>
<tr class="row-odd"><td><p>view_target</p></td>
<td><p>Specify view target [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_target: [0, 0, 1]</p></td>
</tr>
<tr class="row-even"><td><p>view_up</p></td>
<td><p>Specify view up direction [x, y, z]coordinates</p></td>
<td><p>List[Float]</p></td>
<td><p>view_up: [0, -1.0, 0]</p></td>
</tr>
<tr class="row-odd"><td><p>near</p></td>
<td><p>Specify perspective projection near plane</p></td>
<td><p>Float</p></td>
<td><p>near: 0.01</p></td>
</tr>
<tr class="row-even"><td><p>far</p></td>
<td><p>Specify perspective projection far plane</p></td>
<td><p>Float</p></td>
<td><p>far: 10.0</p></td>
</tr>
<tr class="row-odd"><td><p>fov</p></td>
<td><p>Specify perspective projection field of view,  degree angle</p></td>
<td><p>Float</p></td>
<td><p>fov: 40.0</p></td>
</tr>
<tr class="row-even"><td><p>lidar_color</p></td>
<td><p>Specify lidar data color for display</p></td>
<td><p>List[Uint32]</p></td>
<td><p>lidar_color: [0, 255, 0]</p></td>
</tr>
<tr class="row-odd"><td><p>element_size</p></td>
<td><p>Specify lidar data element size. e.g. 4 for XYZI or 3 for XYZ</p></td>
<td><p>Uint32</p></td>
<td><p>element_size: 4</p></td>
</tr>
<tr class="row-even"><td><p>lidar_data_key</p></td>
<td><p>Specify lidar data frame in datamap, default value is DS3D::LidarXYZI</p></td>
<td><p>String</p></td>
<td><p>lidar_data_key: DS3D::LidarXYZI</p></td>
</tr>
<tr class="row-odd"><td><p>lidar_bbox_key</p></td>
<td><p>Specify lidar 3D bounding box data in datamap, default value is DS3D::Lidar3DBboxRawData</p></td>
<td><p>String</p></td>
<td><p>lidar_bbox_key: DS3D::Lidar3DBboxRawData</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Configuration Header for Depth and Color 2D Render:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: depth-2D-render
type: ds3d::datarender
in_caps: ds3d/datamap
custom_lib_path: libnvds_3d_gl_datarender.so
custom_create_function: createDepthStreamDataRender # specific function for 2D depth rendering
</pre></div>
</div>
<ul class="simple">
<li><p>Configuration Body for Depth and Color 2D Specific Part:</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table" id="id15">
<caption><span class="caption-text">libnvds_3d_gl_datarender 2D Depth Render <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id15" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>min_depth</p></td>
<td><p>Specify minimum depth value. other values less that it will be removed in rendering</p></td>
<td><p>Float</p></td>
<td><p>min_depth: 0.3</p></td>
</tr>
<tr class="row-odd"><td><p>max_depth</p></td>
<td><p>Specify maximum depth value. other values less that it will be removed in rendering</p></td>
<td><p>Float</p></td>
<td><p>max_depth: 2.0</p></td>
</tr>
<tr class="row-even"><td><p>min_depth_color</p></td>
<td><p>Specify minimum depth rendering color in [R, G, B]</p></td>
<td><p>List[Uint32]</p></td>
<td><p>min_depth_color: [255, 128, 0]</p></td>
</tr>
<tr class="row-odd"><td><p>max_depth_color</p></td>
<td><p>Specify maximum depth rendering color in [R, G, B]</p></td>
<td><p>Float</p></td>
<td><p>max_depth_color: [0, 128, 255]</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="libnvds-3d-depth-datasource-depth-file-source-specific-configuration-specifications">
<h3>libnvds_3d_depth_datasource Depth file source Specific Configuration Specifications<a class="headerlink" href="DS_3D_Custom_Manual.html#libnvds-3d-depth-datasource-depth-file-source-specific-configuration-specifications" title="Link to this heading">#</a></h3>
<p>Configuration header:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: depthfilesource
type: ds3d::dataloader
out_caps: ds3d/datamap, framerate=30/1
custom_lib_path: libnvds_3d_depth_datasource.so
custom_create_function: createDepthColorLoader
</pre></div>
</div>
<p>Configuration body:</p>
<div class="pst-scrollable-table-container"><table class="table" id="id16">
<caption><span class="caption-text">libnvds_3d_depth_datasource Depth file source <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id16" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>depth_source</p></td>
<td><p>Specify file path for depth source</p></td>
<td><p>String</p></td>
<td><p>depth_source: depth_uint16_640x480.bin</p></td>
</tr>
<tr class="row-odd"><td><p>color_source</p></td>
<td><p>Specify file path for color image source</p></td>
<td><p>String</p></td>
<td><p>color_source: color_rgba_1920x1080.bin</p></td>
</tr>
<tr class="row-even"><td><p>depth_scale</p></td>
<td><p>Indicate depth unit in meters per each depth value</p></td>
<td><p>Float</p></td>
<td><p>depth_scale: 0.0010</p></td>
</tr>
<tr class="row-odd"><td><p>depth_datatype</p></td>
<td><p>Indicate depth datatype, only [uint16] is supported for this version</p></td>
<td><p>String, Values must be uint16</p></td>
<td><p>depth_datatype: uint16</p></td>
</tr>
<tr class="row-even"><td><p>depth_size</p></td>
<td><p>Indicate depth resolutions in [width, height]</p></td>
<td><p>List[Uint32], must be [width, height]</p></td>
<td><p>depth_size: [640, 480]</p></td>
</tr>
<tr class="row-odd"><td><p>color</p></td>
<td><p>Indicate color format. only <cite>rgba</cite> is supported</p></td>
<td><p>String. Value must be rgba</p></td>
<td><p>color: rgba</p></td>
</tr>
<tr class="row-even"><td><p>color_size</p></td>
<td><p>Indicate color resolutions in [width, height]</p></td>
<td><p>List[Uint32], must be [width, height]</p></td>
<td><p>color_size: [1920, 1080]</p></td>
</tr>
<tr class="row-odd"><td><p>depth_intrinsic</p></td>
<td><p>Indicate depth sensor intrinsic parameter groups</p></td>
<td><p>Intrinsic Configuration Group</p></td>
<td><dl class="simple">
<dt>depth_intrinsic:</dt><dd><p>width: 848
height: 480
centerX: 424.06073
centerY: 237.75032
fx: 422.513062
fy: 422.513062</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p>color_intrinsic</p></td>
<td><p>Indicate color sensor intrinsic parameter groups</p></td>
<td><p>Intrinsic Configuration Group</p></td>
<td><dl class="simple">
<dt>color_intrinsic:</dt><dd><p>width: 1920
height: 1080
centerX: 964.288086
centerY: 533.287354
fx: 1358.21423
fy: 1358.2533</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>depth_to_color_extrinsic</p></td>
<td><p>Indicate extrinsic parameters from depth sensor to color sensor</p></td>
<td><p>Extrinsic Configuration Group</p></td>
<td><dl class="simple">
<dt>depth_to_color_extrinsic:</dt><dd><p>rotation: [1, -0.0068, 0.0010, 0.0068, 1, 0, -0.0010, 0, 1]
translation: [0.01481, -0.0001, 0.0002]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<p>Configuration Body for Intrinsic Parameters :</p>
<div class="pst-scrollable-table-container"><table class="table" id="id17">
<caption><span class="caption-text">libnvds_3d_depth_datasource Intrinsic Parameters in Depth file source <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id17" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>width</p></td>
<td><p>Specify sensor width in pixels</p></td>
<td><p>Uint32</p></td>
<td><p>width: 848</p></td>
</tr>
<tr class="row-odd"><td><p>height</p></td>
<td><p>Specify sensor height in pixels</p></td>
<td><p>Uint32</p></td>
<td><p>height: 480</p></td>
</tr>
<tr class="row-even"><td><p>centerX</p></td>
<td><p>Specify coordinate axis position in pixels in horizontal direction</p></td>
<td><p>Float</p></td>
<td><p>centerX: 424.06</p></td>
</tr>
<tr class="row-odd"><td><p>centerY</p></td>
<td><p>Specify coordinate axis position in pixels in vertical direction</p></td>
<td><p>Float</p></td>
<td><p>centerY: 533.28</p></td>
</tr>
<tr class="row-even"><td><p>fx</p></td>
<td><p>Specify focal length in pixels in X direction</p></td>
<td><p>Float</p></td>
<td><p>fx: 1358.21</p></td>
</tr>
<tr class="row-odd"><td><p>fy</p></td>
<td><p>Specify focal length in pixels in Y direction</p></td>
<td><p>Float</p></td>
<td><p>fy: 1358.25</p></td>
</tr>
</tbody>
</table>
</div>
<p>Configuration Body for Extrinsic Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table" id="id18">
<caption><span class="caption-text">libnvds_3d_depth_datasource Extrinsic Parameters in Depth file source <code class="docutils literal notranslate"><span class="pre">config_body</span></code> Fields</span><a class="headerlink" href="DS_3D_Custom_Manual.html#id18" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Type and Range</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rotation</p></td>
<td><p>Specify an extrinsic 3x3 matrix for rotation. Values in Column-major order</p></td>
<td><p>List[Float], Values in Column-major order</p></td>
<td><p>rotation: [1, -0.0068, 0.0010, 0.0068, 1, 0, -0.0010, 0, 1]</p></td>
</tr>
<tr class="row-odd"><td><p>translation</p></td>
<td><p>Specify an extrinsic 3x1 matrix for translation. Values in Column-major order</p></td>
<td><p>List[Float], Values in Column-major order</p></td>
<td><p>translation: [0.01481, -0.0001, 0.0002]</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="DS_TAO_integration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">TAO Toolkit Integration with DeepStream</p>
      </div>
    </a>
    <a class="right-next"
       href="DS_Performance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Performance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-application-examples">DS3D Application Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-data-format-ds3d-datamap">DS3D data format <code class="docutils literal notranslate"><span class="pre">ds3d/datamap</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-datamap-interoperate-with-gstbuffer">DS3D DataMap interoperate with GstBuffer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-dataloader-load-custom-lib-for-data-capture"><code class="docutils literal notranslate"><span class="pre">ds3d::dataloader</span></code> - Load Custom Lib for Data Capture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#load-and-manage-ds3d-dataloader">Load and Manage DS3D Dataloader</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-dataloader-in-deepstream-user-application">DS3D Dataloader in DeepStream User Application</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#implement-a-ds3d-custom-dataloader">Implement a DS3D Custom Dataloader</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-databridge-loads-custom-lib-for-data-conversion-to-and-from-ds3d"><code class="docutils literal notranslate"><span class="pre">ds3d::databridge</span></code> - Loads Custom Lib for data conversion to and from DS3D.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-datafilter-ds3d-custom-datafilter"><code class="docutils literal notranslate"><span class="pre">ds3d::datafilter</span></code>-  DS3D Custom DataFilter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#create-and-manage-ds3d-datafilter-in-deepstream-app">Create And Manage DS3D Datafilter in DeepStream App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#implement-a-custom-ds3d-datafilter">Implement a Custom DS3D Datafilter</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#ds3d-datarender-loads-ds3d-custom-datarender"><code class="docutils literal notranslate"><span class="pre">ds3d::datarender</span></code> - Loads DS3D Custom DataRender</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#load-and-manage-ds3d-datarender">Load And Manage DS3D Datarender</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#implement-a-ds3d-custom-datarender">Implement a DS3D Custom Datarender</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-libs-configuration-specifications">Custom Libs Configuration Specifications</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#components-common-configuration-specifications">Components Common Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#supported-ds3d-custom-process-libraries">Supported DS3D Custom Process libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#libnvds-tritoninferfilter-configuration-specifications">libnvds_tritoninferfilter Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-alignment-datafilter-specifications">Custom Datafilter libnvds_3d_alignment_datafilter Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-lidar-preprocess-datafilter-specifications">Custom Datafilter libnvds_3d_lidar_preprocess_datafilter Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-dataloader-libnvds-lidarfileread-configuration-specifications">Custom Dataloader libnvds_lidarfileread Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-dataloader-libnvds-3d-dataloader-realsense-configuration-specifications">Custom Dataloader libnvds_3d_dataloader_realsense Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-datafilter-libnvds-3d-depth2point-datafilter-configuration-specifications">Custom datafilter libnvds_3d_depth2point_datafilter Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-datarender-libnvds-3d-gles-ensemble-render-configuration-specifications">Custom datarender libnvds_3d_gles_ensemble_render Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#custom-datarender-libnvds-3d-gl-datarender-configuration-specifications">Custom datarender libnvds_3d_gl_datarender Configuration Specifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="DS_3D_Custom_Manual.html#libnvds-3d-depth-datasource-depth-file-source-specific-configuration-specifications">libnvds_3d_depth_datasource Depth file source Specific Configuration Specifications</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js%3Fdigest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js%3Fdigest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">



  <p class="copyright">
    
      Copyright  2024-2025, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item"><p class="last-updated">
  Last updated on Sep 15, 2025.
  <br/>
</p></div>
      
        <div class="footer-item">
<div class="extra_footer">
  
      <script type="text/javascript">if (typeof _satellite !== "undefined") {_satellite.pageBottom();}</script>
    
  
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>